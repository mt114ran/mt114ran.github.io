<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/19bdf9af4d1ae4d4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-aa7deb192a774533.js"/><script src="/_next/static/chunks/4bd1b696-bc089769d60af88b.js" async=""></script><script src="/_next/static/chunks/1684-b369840b16e4c44b.js" async=""></script><script src="/_next/static/chunks/main-app-2ed07751e45c2a2f.js" async=""></script><script src="/_next/static/chunks/6874-6c1ddde525f3893c.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js" async=""></script><meta name="next-size-adjust" content=""/><link rel="icon" href="/favicon.png" type="image/png"/><title>Maita Tomoya Dev IO</title><meta name="description" content="米田智哉の技術ブログ。キャッチアップしたことをメモします。"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_5cfdac __variable_9a8899 antialiased"><div class="max-w-2xl mx-auto py-10 px-4"><h1 class="text-3xl font-bold mb-2"><span class="text-green-600">#<!-- -->45</span> <!-- -->Rails初心者が見落としがちな『|| false』の冗長性とテンプレートでの真偽値評価</h1><ul class="list-none border-b border-gray-600 pb-4 mb-6"><li class="text-gray-500 text-sm">作成日時: <!-- -->2025-09-05 11:59</li><li class="text-gray-500 text-sm">更新日時: <!-- -->2025-09-05 11:59</li><li class="flex flex-wrap gap-2 mt-2"><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Rails</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Ruby</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">HAML</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">ERB</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Template</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Best Practices</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Code Quality</span></li></ul><nav class="mb-6 pb-4 border-b border-gray-700 flex justify-between"><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/">← ホームへ</a><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/blog/">記事一覧へ →</a></nav><article class="prose dark:prose-invert"><h1 id="rails初心者が見落としがちな-falseの冗長性とテンプレートでの真偽値評価">Rails初心者が見落としがちな『|| false』の冗長性とテンプレートでの真偽値評価</h1>
<p>Railsアプリケーションを開発していると、テンプレート内で条件分岐を書く機会が多くあります。その際、以下のようなコードを書いたことはありませんか？</p>
<pre><code class="language-haml">- if @is_display_banner || false
  .banner
    お知らせ: システムメンテナンスを実施します
</code></pre>
<p>実は、この<code>|| false</code>の部分は<strong>不要</strong>です。この記事では、なぜ不要なのか、Railsのテンプレートエンジンでの真偽値評価の仕組みから、より簡潔で読みやすいコードの書き方まで詳しく解説します。</p>
<h2 id="この記事で学べること">この記事で学べること</h2>
<ul>
<li>✅ <strong>Railsテンプレートでの<code>nil</code>と<code>false</code>の評価ルール</strong></li>
<li>✅ <strong><code>|| false</code>が冗長になる理由と仕組み</strong></li>
<li>✅ <strong>より簡潔で保守性の高いコードの書き方</strong></li>
<li>✅ <strong>実際の開発現場でよくある間違いパターンと修正方法</strong></li>
</ul>
<h2 id="前提知識rubyの真偽値評価">前提知識：Rubyの真偽値評価</h2>
<p>まず、Rubyの基本的な真偽値評価ルールを確認しましょう。</p>
<h3 id="rubyで偽とみなされる値">Rubyで「偽」とみなされる値</h3>
<p>Rubyでは、以下の2つの値だけが「偽（falsy）」として扱われます：</p>
<pre><code class="language-ruby">nil   # 偽
false # 偽
</code></pre>
<h3 id="rubyで真とみなされる値">Rubyで「真」とみなされる値</h3>
<p>それ以外のすべての値は「真（truthy）」として扱われます：</p>
<pre><code class="language-ruby">true        # 真
0           # 真（多くの言語とは異なり、Rubyでは0も真）
""          # 真（空文字列も真）
[]          # 真（空配列も真）
{}          # 真（空ハッシュも真）
"false"     # 真（文字列の"false"も真）
</code></pre>
<p>💡 <strong>他の言語との違い</strong>: JavaScript、Python、PHPなどでは<code>0</code>、<code>""</code>、<code>[]</code>が偽として扱われることがありますが、Rubyでは<code>nil</code>と<code>false</code>以外はすべて真です。</p>
<h2 id="railsテンプレートでのインスタンス変数評価">Railsテンプレートでのインスタンス変数評価</h2>
<p>Railsのテンプレート（HamlやERB）では、インスタンス変数が特別な方法で評価されます。</p>
<h3 id="インスタンス変数が存在しない場合">インスタンス変数が存在しない場合</h3>
<pre><code class="language-ruby"># コントローラーで @banner_enabled を設定していない場合
class HomeController &#x3C; ApplicationController
  def index
    # @banner_enabled を設定せず
  end
end
</code></pre>
<pre><code class="language-haml">&#x3C;!-- テンプレートで参照すると -->
- if @banner_enabled
  .banner お知らせ
  
&#x3C;!-- これは以下と同等 -->
- if nil  # @banner_enabled が nil として評価される
  .banner お知らせ
</code></pre>
<p><strong>結果</strong>: <code>nil</code>は偽なので、バナーは表示されません。</p>
<h3 id="インスタンス変数が明示的に設定されている場合">インスタンス変数が明示的に設定されている場合</h3>
<pre><code class="language-ruby">class HomeController &#x3C; ApplicationController
  def index
    @banner_enabled = true   # 明示的に true を設定
    # または
    @banner_enabled = false  # 明示的に false を設定
    # または  
    @banner_enabled = nil    # 明示的に nil を設定
  end
end
</code></pre>
<h2 id="なぜ--false-が冗長なのか">なぜ <code>|| false</code> が冗長なのか</h2>
<p>それでは、具体的に<code>|| false</code>がなぜ不要なのかを見てみましょう。</p>
<h3 id="パターン1-インスタンス変数が存在しない場合">パターン1: インスタンス変数が存在しない場合</h3>
<pre><code class="language-haml">&#x3C;!-- 冗長な書き方 -->
- if @banner_enabled || false
  .banner お知らせ

&#x3C;!-- 簡潔な書き方 -->  
- if @banner_enabled
  .banner お知らせ
</code></pre>
<p><strong>どちらも同じ動作</strong>:</p>
<ul>
<li><code>@banner_enabled</code>が存在しない → <code>nil</code>として評価</li>
<li><code>nil || false</code> → <code>false</code></li>
<li><code>nil</code>そのものも偽なので、結果は同じ</li>
</ul>
<h3 id="パターン2-インスタンス変数が-true-の場合">パターン2: インスタンス変数が <code>true</code> の場合</h3>
<pre><code class="language-ruby"># コントローラー
@banner_enabled = true
</code></pre>
<pre><code class="language-haml">&#x3C;!-- 冗長な書き方 -->
- if @banner_enabled || false  # true || false → true
  .banner お知らせ

&#x3C;!-- 簡潔な書き方 -->
- if @banner_enabled           # true
  .banner お知らせ
</code></pre>
<p><strong>どちらも同じ動作</strong>: バナーが表示される</p>
<h3 id="パターン3-インスタンス変数が-false-の場合">パターン3: インスタンス変数が <code>false</code> の場合</h3>
<pre><code class="language-ruby"># コントローラー  
@banner_enabled = false
</code></pre>
<pre><code class="language-haml">&#x3C;!-- 冗長な書き方 -->
- if @banner_enabled || false  # false || false → false
  .banner お知らせ

&#x3C;!-- 簡潔な書き方 -->
- if @banner_enabled           # false  
  .banner お知らせ
</code></pre>
<p><strong>どちらも同じ動作</strong>: バナーが表示されない</p>
<h2 id="論理演算子--の動作原理">論理演算子 <code>||</code> の動作原理</h2>
<p><code>||</code>演算子の動作を詳しく理解しましょう。</p>
<h3 id="基本的な動作">基本的な動作</h3>
<pre><code class="language-ruby"># 左辺が真の場合、右辺は評価されず左辺を返す
true || false   # → true
true || nil     # → true  
"hello" || nil  # → "hello"

# 左辺が偽の場合、右辺を評価して返す
false || true   # → true
false || false  # → false
nil || "hello"  # → "hello"
nil || false    # → false
</code></pre>
<h3 id="-false-の場合の詳細"><code>|| false</code> の場合の詳細</h3>
<pre><code class="language-ruby"># Case 1: 左辺が真
@banner_enabled = true
result = @banner_enabled || false  # → true（右辺のfalseは評価されない）

# Case 2: 左辺が false
@banner_enabled = false  
result = @banner_enabled || false  # → false（右辺のfalseが返される）

# Case 3: 左辺が nil（変数が存在しない場合）
# @banner_enabled は定義されていない
result = @banner_enabled || false  # → false（右辺のfalseが返される）
</code></pre>
<p>つまり、どのケースでも<code>|| false</code>があってもなくても、<code>if</code>文での評価結果は変わりません。</p>
<h2 id="実際のコード例での比較">実際のコード例での比較</h2>
<h3 id="-冗長な書き方の例">❌ 冗長な書き方の例</h3>
<pre><code class="language-haml">&#x3C;!-- app/views/shared/_header.html.haml -->
- if @show_maintenance_notice || false
  .maintenance-notice
    = @maintenance_notice_text || "システムメンテナンス中"

- if @show_user_menu || false
  .user-menu
    = render 'user_menu'
    
- if @display_flash_messages || false
  .flash-messages
    - flash.each do |type, message|
      .flash{class: type}= message
</code></pre>
<h3 id="-簡潔で読みやすい書き方">✅ 簡潔で読みやすい書き方</h3>
<pre><code class="language-haml">&#x3C;!-- app/views/shared/_header.html.haml -->
- if @show_maintenance_notice
  .maintenance-notice
    = @maintenance_notice_text || "システムメンテナンス中"

- if @show_user_menu
  .user-menu
    = render 'user_menu'
    
- if @display_flash_messages
  .flash-messages
    - flash.each do |type, message|
      .flash{class: type}= message
</code></pre>
<h2 id="erbでの例">ERBでの例</h2>
<p>HamlだけでなくERBでも同様です：</p>
<h3 id="-冗長な書き方">❌ 冗長な書き方</h3>
<pre><code class="language-erb">&#x3C;!-- app/views/layouts/application.html.erb -->
&#x3C;% if @show_sidebar || false %>
  &#x3C;aside class="sidebar">
    &#x3C;%= render 'shared/sidebar' %>
  &#x3C;/aside>
&#x3C;% end %>

&#x3C;% if @enable_analytics || false %>
  &#x3C;%= render 'shared/analytics' %>
&#x3C;% end %>
</code></pre>
<h3 id="-簡潔な書き方">✅ 簡潔な書き方</h3>
<pre><code class="language-erb">&#x3C;!-- app/views/layouts/application.html.erb -->
&#x3C;% if @show_sidebar %>
  &#x3C;aside class="sidebar">
    &#x3C;%= render 'shared/sidebar' %>
  &#x3C;/aside>
&#x3C;% end %>

&#x3C;% if @enable_analytics %>
  &#x3C;%= render 'shared/analytics' %>
&#x3C;% end %>
</code></pre>
<h2 id="なぜ--false-を書いてしまうのか">なぜ <code>|| false</code> を書いてしまうのか？</h2>
<h3 id="よくある理由と誤解">よくある理由と誤解</h3>
<h4 id="1-他の言語からの影響">1. <strong>他の言語からの影響</strong></h4>
<pre><code class="language-javascript">// JavaScript
if (variable || false) {  // undefinedの場合にfalseにしたい
  // 処理
}
</code></pre>
<p>JavaScriptでは<code>undefined</code>や<code>null</code>を明示的に<code>false</code>に変換する意図がありますが、Rubyでは不要です。</p>
<h4 id="2-安全のためという誤った認識">2. <strong>「安全のため」という誤った認識</strong></h4>
<pre><code class="language-haml">&#x3C;!-- 「変数が存在しない場合のエラーを防ぐため」と思っている -->
- if @some_variable || false
</code></pre>
<p>しかし、Railsテンプレートでは存在しないインスタンス変数は自動的に<code>nil</code>として評価されるため、エラーにはなりません。</p>
<h4 id="3-デフォルト値の設定と混同">3. <strong>デフォルト値の設定と混同</strong></h4>
<pre><code class="language-ruby"># これは意味がある（デフォルト値の設定）
message = @user_message || "デフォルトメッセージ"

# これは意味がない（|| false）
if @show_banner || false
</code></pre>
<p>デフォルト値の設定では<code>||</code>演算子が有効ですが、<code>if</code>文の条件では不要です。</p>
<h2 id="正しいデフォルト値の扱い方">正しいデフォルト値の扱い方</h2>
<h3 id="コントローラーでの初期化">コントローラーでの初期化</h3>
<pre><code class="language-ruby">class ApplicationController &#x3C; ActionController::Base
  before_action :set_common_flags
  
  private
  
  def set_common_flags
    # 明示的にデフォルト値を設定
    @show_maintenance_notice = false
    @show_user_menu = true
    @enable_analytics = Rails.env.production?
  end
end
</code></pre>
<h3 id="ヘルパーメソッドの活用">ヘルパーメソッドの活用</h3>
<pre><code class="language-ruby"># app/helpers/application_helper.rb
module ApplicationHelper
  def show_maintenance_notice?
    @show_maintenance_notice || Rails.application.config.maintenance_mode
  end
  
  def show_user_menu?
    @show_user_menu.nil? ? user_signed_in? : @show_user_menu
  end
end
</code></pre>
<pre><code class="language-haml">&#x3C;!-- テンプレートで使用 -->
- if show_maintenance_notice?
  .maintenance-notice
    = maintenance_notice_text
    
- if show_user_menu?
  = render 'shared/user_menu'
</code></pre>
<h2 id="より高度なパターン">より高度なパターン</h2>
<h3 id="複数条件の組み合わせ">複数条件の組み合わせ</h3>
<pre><code class="language-haml">&#x3C;!-- ❌ 冗長 -->
- if (@user_signed_in || false) &#x26;&#x26; (@show_premium_features || false)
  .premium-section
    = render 'premium_features'

&#x3C;!-- ✅ 簡潔 -->
- if @user_signed_in &#x26;&#x26; @show_premium_features
  .premium-section  
    = render 'premium_features'
</code></pre>
<h3 id="否定条件の場合">否定条件の場合</h3>
<pre><code class="language-haml">&#x3C;!-- ❌ 冗長 -->
- unless @hide_footer || false
  = render 'shared/footer'

&#x3C;!-- ✅ 簡潔 -->
- unless @hide_footer
  = render 'shared/footer'
</code></pre>
<h2 id="パフォーマンスへの影響">パフォーマンスへの影響</h2>
<h3 id="微細だが意味のある改善">微細だが意味のある改善</h3>
<pre><code class="language-ruby"># 冗長な場合：|| false の評価コストが発生
# @banner_enabled || false

# 簡潔な場合：不要な評価がない  
# @banner_enabled
</code></pre>
<p>一回の実行では無視できるレベルですが、アクセス数の多いページでは積み重なります。</p>
<h3 id="メモリ使用量">メモリ使用量</h3>
<pre><code class="language-haml">&#x3C;!-- 1000個の条件がある大きなテンプレート -->
- 1000.times do |i|
  - if instance_variable_get("@flag_#{i}") || false  # 冗長
    .item= "Item #{i}"

&#x3C;!-- より効率的 -->
- 1000.times do |i|  
  - if instance_variable_get("@flag_#{i}")           # 簡潔
    .item= "Item #{i}"
</code></pre>
<h2 id="実際の開発現場での適用">実際の開発現場での適用</h2>
<h3 id="コードレビューでのチェックポイント">コードレビューでのチェックポイント</h3>
<pre><code class="language-ruby"># レビュー時にチェックすべきパターン
# ❌ 見つけたら修正を提案
if @variable || false
unless @variable || false  
@variable || false ? true : false

# ✅ 推奨パターン
if @variable
unless @variable
@variable ? true : false  # 明示的にboolean化が必要な場合のみ
</code></pre>
<h3 id="リファクタリングの進め方">リファクタリングの進め方</h3>
<ol>
<li><strong>一括置換で対応可能</strong></li>
</ol>
<pre><code class="language-bash"># 一括置換例（注意深く実行）
find app/views -name "*.haml" -exec sed -i 's/ || false//g' {} \;
</code></pre>
<ol start="2">
<li><strong>テストの実行</strong></li>
</ol>
<pre><code class="language-bash"># 置換後は必ずテストを実行
rails test
rspec
</code></pre>
<ol start="3">
<li><strong>段階的な修正</strong></li>
</ol>
<pre><code class="language-ruby"># ファイル単位で修正して動作確認
# 1. app/views/shared/ から開始
# 2. 各コントローラーのビューを順次修正
# 3. レイアウトファイルを最後に修正
</code></pre>
<h2 id="よくある質問faq">よくある質問（FAQ）</h2>
<h3 id="q--false-を書くことでエラーが防げるのでは">Q: <code>|| false</code> を書くことでエラーが防げるのでは？</h3>
<p><strong>A</strong>: Railsテンプレートでは、存在しないインスタンス変数は自動的に<code>nil</code>として評価されるため、エラーにはなりません。<code>|| false</code>は不要です。</p>
<h3 id="q-他の開発者が理解しやすいように明示的に書くべきでは">Q: 他の開発者が理解しやすいように明示的に書くべきでは？</h3>
<p><strong>A</strong>: Rubyらしいコードは簡潔性を重視します。<code>|| false</code>があることで、逆に「なぜこれが必要なのか？」と混乱を招く可能性があります。</p>
<h3 id="q--true-の場合はどうですか">Q: <code>|| true</code> の場合はどうですか？</h3>
<p><strong>A</strong>: <code>|| true</code>は意味があります。これは「変数が偽の場合に強制的に<code>true</code>にする」という明確な意図があるためです。</p>
<pre><code class="language-haml">&#x3C;!-- これは意味がある -->
- if @force_display || true
  .always-visible
    常に表示される内容
</code></pre>
<h3 id="q-nil-と-false-を区別したい場合は">Q: <code>nil</code> と <code>false</code> を区別したい場合は？</h3>
<p><strong>A</strong>: 明示的に区別が必要な場合は、以下のような書き方をします：</p>
<pre><code class="language-ruby"># コントローラー
@banner_status = :enabled   # :enabled, :disabled, nil

# ヘルパー
def show_banner?
  case @banner_status
  when :enabled then true
  when :disabled then false  
  else default_banner_setting  # nil の場合のデフォルト処理
  end
end
</code></pre>
<h2 id="まとめ">まとめ</h2>
<h3 id="重要なポイント">重要なポイント</h3>
<ol>
<li><strong><code>|| false</code> は冗長</strong>: Railsテンプレートでは<code>nil</code>も<code>false</code>も偽として評価される</li>
<li><strong>簡潔性を重視</strong>: Rubyらしいコードは不要な記述を避ける</li>
<li><strong>明確な意図を持つ</strong>: デフォルト値の設定と条件分岐は分けて考える</li>
<li><strong>一貫性を保つ</strong>: チーム全体で統一したスタイルを採用する</li>
</ol>
<h3 id="推奨事項">推奨事項</h3>
<pre><code class="language-haml">&#x3C;!-- ✅ 推奨 -->
- if @show_content
  .content= @content_text
  
- unless @hide_section  
  .section= render 'shared/section'

&#x3C;!-- ❌ 非推奨 -->  
- if @show_content || false
  .content= @content_text
  
- unless @hide_section || false
  .section= render 'shared/section'
</code></pre>
<h3 id="次のステップ">次のステップ</h3>
<ul>
<li>既存のコードベースで<code>|| false</code>パターンを検索して修正</li>
<li>チームのコーディングガイドラインに簡潔な書き方を追加</li>
<li>コードレビュー時にこのパターンをチェック項目に含める</li>
</ul>
<p>より簡潔で保守性の高いRailsアプリケーションを目指して、不要な冗長性を排除していきましょう！</p>
<h2 id="参考リンク">参考リンク</h2>
<ul>
<li><a href="https://railsguides.jp/layouts_and_rendering.html">Rails Guides - レイアウトとレンダリング</a></li>
<li><a href="https://docs.ruby-lang.org/ja/latest/doc/spec=2foperator.html">Ruby公式ドキュメント - 論理演算子</a></li>
<li><a href="https://haml.info/">Haml公式ドキュメント</a></li>
<li><a href="https://docs.ruby-lang.org/ja/latest/library/erb.html">ERB公式ドキュメント</a></li>
</ul></article><nav class="mt-8 pt-4 border-t border-gray-700 flex justify-between"><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/">← ホームへ</a><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/blog/">記事一覧へ →</a></nav></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-aa7deb192a774533.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n5:I[59665,[],\"MetadataBoundary\"]\n7:I[59665,[],\"OutletBoundary\"]\na:I[74911,[],\"AsyncMetadataOutlet\"]\nc:I[59665,[],\"ViewportBoundary\"]\ne:I[26614,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/19bdf9af4d1ae4d4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"vsam1ev7JOOxd7sM1deBX\",\"p\":\"\",\"c\":[\"\",\"blog\",\"rails-or-false-redundancy-guide\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"rails-or-false-redundancy-guide\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/19bdf9af4d1ae4d4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png\",\"type\":\"image/png\"}]}],[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac __variable_9a8899 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"rails-or-false-redundancy-guide\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"REqCQdW6N8GWibEV5QPso\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[74911,[],\"AsyncMetadata\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script><script>self.__next_f.push([1,"12:I[6874,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"\"]\n14:I[31203,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"default\"]\n15:I[4197,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"default\"]\n13:T491b,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"rails初心者が見落としがちな-falseの冗長性とテンプレートでの真偽値評価\"\u003eRails初心者が見落としがちな『|| false』の冗長性とテンプレートでの真偽値評価\u003c/h1\u003e\n\u003cp\u003eRailsアプリケーションを開発していると、テンプレート内で条件分岐を書く機会が多くあります。その際、以下のようなコードを書いたことはありませんか？\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e- if @is_display_banner || false\n  .banner\n    お知らせ: システムメンテナンスを実施します\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e実は、この\u003ccode\u003e|| false\u003c/code\u003eの部分は\u003cstrong\u003e不要\u003c/strong\u003eです。この記事では、なぜ不要なのか、Railsのテンプレートエンジンでの真偽値評価の仕組みから、より簡潔で読みやすいコードの書き方まで詳しく解説します。\u003c/p\u003e\n\u003ch2 id=\"この記事で学べること\"\u003eこの記事で学べること\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e✅ \u003cstrong\u003eRailsテンプレートでの\u003ccode\u003enil\u003c/code\u003eと\u003ccode\u003efalse\u003c/code\u003eの評価ルール\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e✅ \u003cstrong\u003e\u003ccode\u003e|| false\u003c/code\u003eが冗長になる理由と仕組み\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e✅ \u003cstrong\u003eより簡潔で保守性の高いコードの書き方\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e✅ \u003cstrong\u003e実際の開発現場でよくある間違いパターンと修正方法\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"前提知識rubyの真偽値評価\"\u003e前提知識：Rubyの真偽値評価\u003c/h2\u003e\n\u003cp\u003eまず、Rubyの基本的な真偽値評価ルールを確認しましょう。\u003c/p\u003e\n\u003ch3 id=\"rubyで偽とみなされる値\"\u003eRubyで「偽」とみなされる値\u003c/h3\u003e\n\u003cp\u003eRubyでは、以下の2つの値だけが「偽（falsy）」として扱われます：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003enil   # 偽\nfalse # 偽\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"rubyで真とみなされる値\"\u003eRubyで「真」とみなされる値\u003c/h3\u003e\n\u003cp\u003eそれ以外のすべての値は「真（truthy）」として扱われます：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003etrue        # 真\n0           # 真（多くの言語とは異なり、Rubyでは0も真）\n\"\"          # 真（空文字列も真）\n[]          # 真（空配列も真）\n{}          # 真（空ハッシュも真）\n\"false\"     # 真（文字列の\"false\"も真）\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e💡 \u003cstrong\u003e他の言語との違い\u003c/strong\u003e: JavaScript、Python、PHPなどでは\u003ccode\u003e0\u003c/code\u003e、\u003ccode\u003e\"\"\u003c/code\u003e、\u003ccode\u003e[]\u003c/code\u003eが偽として扱われることがありますが、Rubyでは\u003ccode\u003enil\u003c/code\u003eと\u003ccode\u003efalse\u003c/code\u003e以外はすべて真です。\u003c/p\u003e\n\u003ch2 id=\"railsテンプレートでのインスタンス変数評価\"\u003eRailsテンプレートでのインスタンス変数評価\u003c/h2\u003e\n\u003cp\u003eRailsのテンプレート（HamlやERB）では、インスタンス変数が特別な方法で評価されます。\u003c/p\u003e\n\u003ch3 id=\"インスタンス変数が存在しない場合\"\u003eインスタンス変数が存在しない場合\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# コントローラーで @banner_enabled を設定していない場合\nclass HomeController \u0026#x3C; ApplicationController\n  def index\n    # @banner_enabled を設定せず\n  end\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- テンプレートで参照すると --\u003e\n- if @banner_enabled\n  .banner お知らせ\n  \n\u0026#x3C;!-- これは以下と同等 --\u003e\n- if nil  # @banner_enabled が nil として評価される\n  .banner お知らせ\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003e結果\u003c/strong\u003e: \u003ccode\u003enil\u003c/code\u003eは偽なので、バナーは表示されません。\u003c/p\u003e\n\u003ch3 id=\"インスタンス変数が明示的に設定されている場合\"\u003eインスタンス変数が明示的に設定されている場合\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003eclass HomeController \u0026#x3C; ApplicationController\n  def index\n    @banner_enabled = true   # 明示的に true を設定\n    # または\n    @banner_enabled = false  # 明示的に false を設定\n    # または  \n    @banner_enabled = nil    # 明示的に nil を設定\n  end\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"なぜ--false-が冗長なのか\"\u003eなぜ \u003ccode\u003e|| false\u003c/code\u003e が冗長なのか\u003c/h2\u003e\n\u003cp\u003eそれでは、具体的に\u003ccode\u003e|| false\u003c/code\u003eがなぜ不要なのかを見てみましょう。\u003c/p\u003e\n\u003ch3 id=\"パターン1-インスタンス変数が存在しない場合\"\u003eパターン1: インスタンス変数が存在しない場合\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- 冗長な書き方 --\u003e\n- if @banner_enabled || false\n  .banner お知らせ\n\n\u0026#x3C;!-- 簡潔な書き方 --\u003e  \n- if @banner_enabled\n  .banner お知らせ\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eどちらも同じ動作\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e@banner_enabled\u003c/code\u003eが存在しない → \u003ccode\u003enil\u003c/code\u003eとして評価\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enil || false\u003c/code\u003e → \u003ccode\u003efalse\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enil\u003c/code\u003eそのものも偽なので、結果は同じ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"パターン2-インスタンス変数が-true-の場合\"\u003eパターン2: インスタンス変数が \u003ccode\u003etrue\u003c/code\u003e の場合\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# コントローラー\n@banner_enabled = true\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- 冗長な書き方 --\u003e\n- if @banner_enabled || false  # true || false → true\n  .banner お知らせ\n\n\u0026#x3C;!-- 簡潔な書き方 --\u003e\n- if @banner_enabled           # true\n  .banner お知らせ\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eどちらも同じ動作\u003c/strong\u003e: バナーが表示される\u003c/p\u003e\n\u003ch3 id=\"パターン3-インスタンス変数が-false-の場合\"\u003eパターン3: インスタンス変数が \u003ccode\u003efalse\u003c/code\u003e の場合\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# コントローラー  \n@banner_enabled = false\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- 冗長な書き方 --\u003e\n- if @banner_enabled || false  # false || false → false\n  .banner お知らせ\n\n\u0026#x3C;!-- 簡潔な書き方 --\u003e\n- if @banner_enabled           # false  \n  .banner お知らせ\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eどちらも同じ動作\u003c/strong\u003e: バナーが表示されない\u003c/p\u003e\n\u003ch2 id=\"論理演算子--の動作原理\"\u003e論理演算子 \u003ccode\u003e||\u003c/code\u003e の動作原理\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e||\u003c/code\u003e演算子の動作を詳しく理解しましょう。\u003c/p\u003e\n\u003ch3 id=\"基本的な動作\"\u003e基本的な動作\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# 左辺が真の場合、右辺は評価されず左辺を返す\ntrue || false   # → true\ntrue || nil     # → true  \n\"hello\" || nil  # → \"hello\"\n\n# 左辺が偽の場合、右辺を評価して返す\nfalse || true   # → true\nfalse || false  # → false\nnil || \"hello\"  # → \"hello\"\nnil || false    # → false\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"-false-の場合の詳細\"\u003e\u003ccode\u003e|| false\u003c/code\u003e の場合の詳細\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# Case 1: 左辺が真\n@banner_enabled = true\nresult = @banner_enabled || false  # → true（右辺のfalseは評価されない）\n\n# Case 2: 左辺が false\n@banner_enabled = false  \nresult = @banner_enabled || false  # → false（右辺のfalseが返される）\n\n# Case 3: 左辺が nil（変数が存在しない場合）\n# @banner_enabled は定義されていない\nresult = @banner_enabled || false  # → false（右辺のfalseが返される）\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eつまり、どのケースでも\u003ccode\u003e|| false\u003c/code\u003eがあってもなくても、\u003ccode\u003eif\u003c/code\u003e文での評価結果は変わりません。\u003c/p\u003e\n\u003ch2 id=\"実際のコード例での比較\"\u003e実際のコード例での比較\u003c/h2\u003e\n\u003ch3 id=\"-冗長な書き方の例\"\u003e❌ 冗長な書き方の例\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- app/views/shared/_header.html.haml --\u003e\n- if @show_maintenance_notice || false\n  .maintenance-notice\n    = @maintenance_notice_text || \"システムメンテナンス中\"\n\n- if @show_user_menu || false\n  .user-menu\n    = render 'user_menu'\n    \n- if @display_flash_messages || false\n  .flash-messages\n    - flash.each do |type, message|\n      .flash{class: type}= message\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"-簡潔で読みやすい書き方\"\u003e✅ 簡潔で読みやすい書き方\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- app/views/shared/_header.html.haml --\u003e\n- if @show_maintenance_notice\n  .maintenance-notice\n    = @maintenance_notice_text || \"システムメンテナンス中\"\n\n- if @show_user_menu\n  .user-menu\n    = render 'user_menu'\n    \n- if @display_flash_messages\n  .flash-messages\n    - flash.each do |type, message|\n      .flash{class: type}= message\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"erbでの例\"\u003eERBでの例\u003c/h2\u003e\n\u003cp\u003eHamlだけでなくERBでも同様です：\u003c/p\u003e\n\u003ch3 id=\"-冗長な書き方\"\u003e❌ 冗長な書き方\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-erb\"\u003e\u0026#x3C;!-- app/views/layouts/application.html.erb --\u003e\n\u0026#x3C;% if @show_sidebar || false %\u003e\n  \u0026#x3C;aside class=\"sidebar\"\u003e\n    \u0026#x3C;%= render 'shared/sidebar' %\u003e\n  \u0026#x3C;/aside\u003e\n\u0026#x3C;% end %\u003e\n\n\u0026#x3C;% if @enable_analytics || false %\u003e\n  \u0026#x3C;%= render 'shared/analytics' %\u003e\n\u0026#x3C;% end %\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"-簡潔な書き方\"\u003e✅ 簡潔な書き方\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-erb\"\u003e\u0026#x3C;!-- app/views/layouts/application.html.erb --\u003e\n\u0026#x3C;% if @show_sidebar %\u003e\n  \u0026#x3C;aside class=\"sidebar\"\u003e\n    \u0026#x3C;%= render 'shared/sidebar' %\u003e\n  \u0026#x3C;/aside\u003e\n\u0026#x3C;% end %\u003e\n\n\u0026#x3C;% if @enable_analytics %\u003e\n  \u0026#x3C;%= render 'shared/analytics' %\u003e\n\u0026#x3C;% end %\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"なぜ--false-を書いてしまうのか\"\u003eなぜ \u003ccode\u003e|| false\u003c/code\u003e を書いてしまうのか？\u003c/h2\u003e\n\u003ch3 id=\"よくある理由と誤解\"\u003eよくある理由と誤解\u003c/h3\u003e\n\u003ch4 id=\"1-他の言語からの影響\"\u003e1. \u003cstrong\u003e他の言語からの影響\u003c/strong\u003e\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// JavaScript\nif (variable || false) {  // undefinedの場合にfalseにしたい\n  // 処理\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eJavaScriptでは\u003ccode\u003eundefined\u003c/code\u003eや\u003ccode\u003enull\u003c/code\u003eを明示的に\u003ccode\u003efalse\u003c/code\u003eに変換する意図がありますが、Rubyでは不要です。\u003c/p\u003e\n\u003ch4 id=\"2-安全のためという誤った認識\"\u003e2. \u003cstrong\u003e「安全のため」という誤った認識\u003c/strong\u003e\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- 「変数が存在しない場合のエラーを防ぐため」と思っている --\u003e\n- if @some_variable || false\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eしかし、Railsテンプレートでは存在しないインスタンス変数は自動的に\u003ccode\u003enil\u003c/code\u003eとして評価されるため、エラーにはなりません。\u003c/p\u003e\n\u003ch4 id=\"3-デフォルト値の設定と混同\"\u003e3. \u003cstrong\u003eデフォルト値の設定と混同\u003c/strong\u003e\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# これは意味がある（デフォルト値の設定）\nmessage = @user_message || \"デフォルトメッセージ\"\n\n# これは意味がない（|| false）\nif @show_banner || false\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eデフォルト値の設定では\u003ccode\u003e||\u003c/code\u003e演算子が有効ですが、\u003ccode\u003eif\u003c/code\u003e文の条件では不要です。\u003c/p\u003e\n\u003ch2 id=\"正しいデフォルト値の扱い方\"\u003e正しいデフォルト値の扱い方\u003c/h2\u003e\n\u003ch3 id=\"コントローラーでの初期化\"\u003eコントローラーでの初期化\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003eclass ApplicationController \u0026#x3C; ActionController::Base\n  before_action :set_common_flags\n  \n  private\n  \n  def set_common_flags\n    # 明示的にデフォルト値を設定\n    @show_maintenance_notice = false\n    @show_user_menu = true\n    @enable_analytics = Rails.env.production?\n  end\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ヘルパーメソッドの活用\"\u003eヘルパーメソッドの活用\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# app/helpers/application_helper.rb\nmodule ApplicationHelper\n  def show_maintenance_notice?\n    @show_maintenance_notice || Rails.application.config.maintenance_mode\n  end\n  \n  def show_user_menu?\n    @show_user_menu.nil? ? user_signed_in? : @show_user_menu\n  end\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- テンプレートで使用 --\u003e\n- if show_maintenance_notice?\n  .maintenance-notice\n    = maintenance_notice_text\n    \n- if show_user_menu?\n  = render 'shared/user_menu'\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"より高度なパターン\"\u003eより高度なパターン\u003c/h2\u003e\n\u003ch3 id=\"複数条件の組み合わせ\"\u003e複数条件の組み合わせ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- ❌ 冗長 --\u003e\n- if (@user_signed_in || false) \u0026#x26;\u0026#x26; (@show_premium_features || false)\n  .premium-section\n    = render 'premium_features'\n\n\u0026#x3C;!-- ✅ 簡潔 --\u003e\n- if @user_signed_in \u0026#x26;\u0026#x26; @show_premium_features\n  .premium-section  \n    = render 'premium_features'\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"否定条件の場合\"\u003e否定条件の場合\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- ❌ 冗長 --\u003e\n- unless @hide_footer || false\n  = render 'shared/footer'\n\n\u0026#x3C;!-- ✅ 簡潔 --\u003e\n- unless @hide_footer\n  = render 'shared/footer'\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"パフォーマンスへの影響\"\u003eパフォーマンスへの影響\u003c/h2\u003e\n\u003ch3 id=\"微細だが意味のある改善\"\u003e微細だが意味のある改善\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# 冗長な場合：|| false の評価コストが発生\n# @banner_enabled || false\n\n# 簡潔な場合：不要な評価がない  \n# @banner_enabled\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e一回の実行では無視できるレベルですが、アクセス数の多いページでは積み重なります。\u003c/p\u003e\n\u003ch3 id=\"メモリ使用量\"\u003eメモリ使用量\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- 1000個の条件がある大きなテンプレート --\u003e\n- 1000.times do |i|\n  - if instance_variable_get(\"@flag_#{i}\") || false  # 冗長\n    .item= \"Item #{i}\"\n\n\u0026#x3C;!-- より効率的 --\u003e\n- 1000.times do |i|  \n  - if instance_variable_get(\"@flag_#{i}\")           # 簡潔\n    .item= \"Item #{i}\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"実際の開発現場での適用\"\u003e実際の開発現場での適用\u003c/h2\u003e\n\u003ch3 id=\"コードレビューでのチェックポイント\"\u003eコードレビューでのチェックポイント\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# レビュー時にチェックすべきパターン\n# ❌ 見つけたら修正を提案\nif @variable || false\nunless @variable || false  \n@variable || false ? true : false\n\n# ✅ 推奨パターン\nif @variable\nunless @variable\n@variable ? true : false  # 明示的にboolean化が必要な場合のみ\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"リファクタリングの進め方\"\u003eリファクタリングの進め方\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e一括置換で対応可能\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# 一括置換例（注意深く実行）\nfind app/views -name \"*.haml\" -exec sed -i 's/ || false//g' {} \\;\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\u003cstrong\u003eテストの実行\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# 置換後は必ずテストを実行\nrails test\nrspec\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"3\"\u003e\n\u003cli\u003e\u003cstrong\u003e段階的な修正\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# ファイル単位で修正して動作確認\n# 1. app/views/shared/ から開始\n# 2. 各コントローラーのビューを順次修正\n# 3. レイアウトファイルを最後に修正\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"よくある質問faq\"\u003eよくある質問（FAQ）\u003c/h2\u003e\n\u003ch3 id=\"q--false-を書くことでエラーが防げるのでは\"\u003eQ: \u003ccode\u003e|| false\u003c/code\u003e を書くことでエラーが防げるのでは？\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eA\u003c/strong\u003e: Railsテンプレートでは、存在しないインスタンス変数は自動的に\u003ccode\u003enil\u003c/code\u003eとして評価されるため、エラーにはなりません。\u003ccode\u003e|| false\u003c/code\u003eは不要です。\u003c/p\u003e\n\u003ch3 id=\"q-他の開発者が理解しやすいように明示的に書くべきでは\"\u003eQ: 他の開発者が理解しやすいように明示的に書くべきでは？\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eA\u003c/strong\u003e: Rubyらしいコードは簡潔性を重視します。\u003ccode\u003e|| false\u003c/code\u003eがあることで、逆に「なぜこれが必要なのか？」と混乱を招く可能性があります。\u003c/p\u003e\n\u003ch3 id=\"q--true-の場合はどうですか\"\u003eQ: \u003ccode\u003e|| true\u003c/code\u003e の場合はどうですか？\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eA\u003c/strong\u003e: \u003ccode\u003e|| true\u003c/code\u003eは意味があります。これは「変数が偽の場合に強制的に\u003ccode\u003etrue\u003c/code\u003eにする」という明確な意図があるためです。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- これは意味がある --\u003e\n- if @force_display || true\n  .always-visible\n    常に表示される内容\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"q-nil-と-false-を区別したい場合は\"\u003eQ: \u003ccode\u003enil\u003c/code\u003e と \u003ccode\u003efalse\u003c/code\u003e を区別したい場合は？\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eA\u003c/strong\u003e: 明示的に区別が必要な場合は、以下のような書き方をします：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ruby\"\u003e# コントローラー\n@banner_status = :enabled   # :enabled, :disabled, nil\n\n# ヘルパー\ndef show_banner?\n  case @banner_status\n  when :enabled then true\n  when :disabled then false  \n  else default_banner_setting  # nil の場合のデフォルト処理\n  end\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"まとめ\"\u003eまとめ\u003c/h2\u003e\n\u003ch3 id=\"重要なポイント\"\u003e重要なポイント\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003e|| false\u003c/code\u003e は冗長\u003c/strong\u003e: Railsテンプレートでは\u003ccode\u003enil\u003c/code\u003eも\u003ccode\u003efalse\u003c/code\u003eも偽として評価される\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e簡潔性を重視\u003c/strong\u003e: Rubyらしいコードは不要な記述を避ける\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e明確な意図を持つ\u003c/strong\u003e: デフォルト値の設定と条件分岐は分けて考える\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e一貫性を保つ\u003c/strong\u003e: チーム全体で統一したスタイルを採用する\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"推奨事項\"\u003e推奨事項\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-haml\"\u003e\u0026#x3C;!-- ✅ 推奨 --\u003e\n- if @show_content\n  .content= @content_text\n  \n- unless @hide_section  \n  .section= render 'shared/section'\n\n\u0026#x3C;!-- ❌ 非推奨 --\u003e  \n- if @show_content || false\n  .content= @content_text\n  \n- unless @hide_section || false\n  .section= render 'shared/section'\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"次のステップ\"\u003e次のステップ\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e既存のコードベースで\u003ccode\u003e|| false\u003c/code\u003eパターンを検索して修正\u003c/li\u003e\n\u003cli\u003eチームのコーディングガイドラインに簡潔な書き方を追加\u003c/li\u003e\n\u003cli\u003eコードレビュー時にこのパターンをチェック項目に含める\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eより簡潔で保守性の高いRailsアプリケーションを目指して、不要な冗長性を排除していきましょう！\u003c/p\u003e\n\u003ch2 id=\"参考リンク\"\u003e参考リンク\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://railsguides.jp/layouts_and_rendering.html\"\u003eRails Guides - レイアウトとレンダリング\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.ruby-lang.org/ja/latest/doc/spec=2foperator.html\"\u003eRuby公式ドキュメント - 論理演算子\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://haml.info/\"\u003eHaml公式ドキュメント\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.ruby-lang.org/ja/latest/library/erb.html\"\u003eERB公式ドキュメント\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto py-10 px-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-green-600\",\"children\":[\"#\",45]}],\" \",\"Rails初心者が見落としがちな『|| false』の冗長性とテンプレートでの真偽値評価\"]}],[\"$\",\"ul\",null,{\"className\":\"list-none border-b border-gray-600 pb-4 mb-6\",\"children\":[[\"$\",\"li\",null,{\"className\":\"text-gray-500 text-sm\",\"children\":[\"作成日時: \",\"2025-09-05 11:59\"]}],[\"$\",\"li\",null,{\"className\":\"text-gray-500 text-sm\",\"children\":[\"更新日時: \",\"2025-09-05 11:59\"]}],[\"$\",\"li\",null,{\"className\":\"flex flex-wrap gap-2 mt-2\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Rails\"}],[\"$\",\"span\",\"1\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Ruby\"}],[\"$\",\"span\",\"2\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"HAML\"}],[\"$\",\"span\",\"3\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"ERB\"}],[\"$\",\"span\",\"4\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Template\"}],[\"$\",\"span\",\"5\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Best Practices\"}],[\"$\",\"span\",\"6\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Code Quality\"}]]}]]}],[\"$\",\"nav\",null,{\"className\":\"mb-6 pb-4 border-b border-gray-700 flex justify-between\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"← ホームへ\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"記事一覧へ →\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose dark:prose-invert\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}],[\"$\",\"$L14\",null,{}],[\"$\",\"nav\",null,{\"className\":\"mt-8 pt-4 border-t border-gray-700 flex justify-between\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"← ホームへ\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"記事一覧へ →\"}]]}],[\"$\",\"$L15\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Maita Tomoya Dev IO\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"米田智哉の技術ブログ。キャッチアップしたことをメモします。\"}]],\"error\":null,\"digest\":\"$undefined\"}\nb:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>