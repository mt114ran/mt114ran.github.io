<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/19bdf9af4d1ae4d4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-aa7deb192a774533.js"/><script src="/_next/static/chunks/4bd1b696-bc089769d60af88b.js" async=""></script><script src="/_next/static/chunks/1684-b369840b16e4c44b.js" async=""></script><script src="/_next/static/chunks/main-app-2ed07751e45c2a2f.js" async=""></script><script src="/_next/static/chunks/6874-6c1ddde525f3893c.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js" async=""></script><meta name="next-size-adjust" content=""/><link rel="icon" href="/favicon.png" type="image/png"/><title>Maita Tomoya Dev IO</title><meta name="description" content="ç±³ç”°æ™ºå“‰ã®æŠ€è¡“ãƒ–ãƒ­ã‚°ã€‚ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ãŸã“ã¨ã‚’ãƒ¡ãƒ¢ã—ã¾ã™ã€‚"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_5cfdac __variable_9a8899 antialiased"><div class="max-w-2xl mx-auto py-10 px-4"><h1 class="text-3xl font-bold mb-2"><span class="text-green-600">#<!-- -->38</span> <!-- -->Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ï¼šOWASP Top 10æº–æ‹ ã®å®Ÿè·µçš„è„†å¼±æ€§å¯¾ç­–</h1><ul class="list-none border-b border-gray-600 pb-4 mb-6"><li class="text-gray-500 text-sm">ä½œæˆæ—¥æ™‚: <!-- -->2025-08-16 00:24</li><li class="flex flex-wrap gap-2 mt-2"><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">OWASP</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">è„†å¼±æ€§å¯¾ç­–</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼</span></li></ul><nav class="mb-6 pb-4 border-b border-gray-700 flex justify-between"><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/">â† ãƒ›ãƒ¼ãƒ ã¸</a><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/blog/">è¨˜äº‹ä¸€è¦§ã¸ â†’</a></nav><article class="prose dark:prose-invert"><p>æ•™æå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€ŒDrill Layerã€ã§ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»å®Ÿæ–½ã‚’é€šã˜ã¦ã€OWASP Top 10ã«åŸºã¥ãåŒ…æ‹¬çš„è„†å¼±æ€§å¯¾ç­–ã¨å®Ÿéš›ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–æ‰‹æ³•ã‚’è©³ç´°ã«è§£èª¬ã—ã¾ã™ã€‚</p>
<h2 id="-åˆå¿ƒè€…å‘ã‘è§£èª¬">ğŸ’¡ åˆå¿ƒè€…å‘ã‘è§£èª¬</h2>
<h3 id="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨ã¯">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨ã¯ï¼Ÿ</h3>
<p><strong>ç°¡å˜ã«è¨€ã†ã¨</strong>: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ç©´ã€ã‚’è¦‹ã¤ã‘ã¦ä¿®æ­£ã™ã‚‹ä½œæ¥­ã§ã™ã€‚</p>
<pre><code>é€šå¸¸ã®é–‹ç™ºãƒ†ã‚¹ãƒˆ: ã€Œæ©Ÿèƒ½ãŒæ­£ã—ãå‹•ãã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»: ã€Œæ‚ªæ„ã‚ã‚‹æ”»æ’ƒã«è€ãˆã‚‰ã‚Œã‚‹ã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯
</code></pre>
<h3 id="owasp-top-10ã¨ã¯">OWASP Top 10ã¨ã¯ï¼Ÿ</h3>
<p><strong>OWASPï¼ˆã‚ªãƒ¯ã‚¹ãƒ—ï¼‰</strong>: Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»£è¡¨çš„ãªè„†å¼±æ€§ãƒ©ãƒ³ã‚­ãƒ³ã‚°</p>
<pre><code>ä¸–ç•Œä¸­ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å°‚é–€å®¶ãŒé¸ã¶
ã€Œæœ€ã‚‚å±é™ºãª10ã®è„†å¼±æ€§ã€ã®ãƒªã‚¹ãƒˆ
é–‹ç™ºè€…ãŒå„ªå…ˆçš„ã«å¯¾ç­–ã™ã¹ãé …ç›®
</code></pre>
<h2 id="-ç›®æ¬¡">ğŸ“š ç›®æ¬¡</h2>
<ul>
<li><a href="#%E7%9B%A3%E6%9F%BB%E3%81%AE%E6%A6%82%E8%A6%81%E3%81%A8%E6%96%B9%E6%B3%95%E8%AB%96">ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–</a></li>
<li><a href="#%E7%99%BA%E8%A6%8B%E3%81%95%E3%82%8C%E3%81%9F%E8%84%86%E5%BC%B1%E6%80%A7%E5%88%86%E6%9E%90">ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ</a></li>
<li><a href="#owasp-top-10%E5%AF%BE%E7%AD%96%E5%AE%9F%E8%A3%85">OWASP Top 10å¯¾ç­–å®Ÿè£…</a></li>
<li><a href="#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%98%E3%83%83%E3%83%80%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A3%85">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…</a></li>
<li><a href="#%E3%83%9A%E3%83%8D%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88%E5%AE%9F%E6%96%BD">ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½</a></li>
<li><a href="#%E4%BE%9D%E5%AD%98%E9%96%A2%E4%BF%82%E8%84%86%E5%BC%B1%E6%80%A7%E5%AF%BE%E7%AD%96">ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–</a></li>
<li><a href="#%E7%B6%99%E7%B6%9A%E7%9A%84%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E4%BD%93%E5%88%B6%E6%A7%8B%E7%AF%89">ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">ã¾ã¨ã‚</a></li>
</ul>
<h2 id="ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–">ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–</h2>
<h3 id="å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³">å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</h3>
<pre><code>Drill Layer (æ•™æå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ )
â”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: React + TypeScript
â”œâ”€â”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Node.js + Express
â”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL
â”œâ”€â”€ èªè¨¼: Google OAuth + JWT
â””â”€â”€ ã‚¤ãƒ³ãƒ•ãƒ©: AWS (äºˆå®š)
</code></pre>
<h3 id="ç›£æŸ»æ‰‹æ³•">ç›£æŸ»æ‰‹æ³•</h3>
<h4 id="1-é™çš„è§£æstatic-analysis">1. é™çš„è§£æï¼ˆStatic Analysisï¼‰</h4>
<pre><code class="language-bash"># ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã‚ˆã‚‹è„†å¼±æ€§æ¤œå‡º
- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç›´æ¥ç¢ºèª
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
- ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯
</code></pre>
<h4 id="2-å‹•çš„è§£ædynamic-analysis">2. å‹•çš„è§£æï¼ˆDynamic Analysisï¼‰</h4>
<pre><code class="language-bash"># å®Ÿéš›ã«å‹•ä½œã•ã›ãªãŒã‚‰è„†å¼±æ€§æ¤œå‡º
- ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ
- ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆ
- èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ
</code></pre>
<h4 id="3-è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³">3. è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³</h4>
<pre><code class="language-bash"># è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹åŒ…æ‹¬çš„ãƒã‚§ãƒƒã‚¯
npm audit                    # ä¾å­˜é–¢ä¿‚è„†å¼±æ€§
npm audit --audit-level high # é«˜ãƒªã‚¹ã‚¯ä»¥ä¸Šã®ã¿
</code></pre>
<h3 id="ç›£æŸ»åŸºæº–">ç›£æŸ»åŸºæº–</h3>
<pre><code class="language-markdown">## è©•ä¾¡åŸºæº–ï¼ˆCVSS v3.1ï¼‰
- Critical (9.0-10.0): ç·Šæ€¥å¯¾å¿œå¿…è¦
- High (7.0-8.9): æ—©æ€¥ãªå¯¾å¿œå¿…è¦
- Medium (4.0-6.9): è¨ˆç”»çš„å¯¾å¿œ
- Low (0.1-3.9): ä½™è£•ãŒã‚ã‚‹ã¨ãã«å¯¾å¿œ
</code></pre>
<h2 id="ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ">ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ</h2>
<h3 id="ç›£æŸ»çµæœã‚µãƒãƒªãƒ¼">ç›£æŸ»çµæœã‚µãƒãƒªãƒ¼</h3>
<pre><code class="language-markdown">## è„†å¼±æ€§çµ±è¨ˆ
é‡å¤§ (Critical): 8ä»¶
é«˜ (High): 12ä»¶
ä¸­ (Medium): 15ä»¶
ä½ (Low): 3ä»¶
åˆè¨ˆ: 38ä»¶ã®è„†å¼±æ€§
</code></pre>
<h3 id="-é‡å¤§ãªè„†å¼±æ€§critical">ğŸ”´ é‡å¤§ãªè„†å¼±æ€§ï¼ˆCriticalï¼‰</h3>
<h4 id="1-jwt-ãƒˆãƒ¼ã‚¯ãƒ³ã®urlé€ä¿¡-cvss-91">1. JWT ãƒˆãƒ¼ã‚¯ãƒ³ã®URLé€ä¿¡ (CVSS 9.1)</h4>
<p><strong>è„†å¼±æ€§ã®è©³ç´°</strong>:</p>
<pre><code class="language-typescript">// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰
const redirectUrl = `${frontendUrl}/auth/callback?token=${encodeURIComponent(token)}`;
res.redirect(redirectUrl);
</code></pre>
<p><strong>æ”»æ’ƒã‚·ãƒŠãƒªã‚ª</strong>:</p>
<pre><code class="language-markdown">1. æ”»æ’ƒè€…ãŒè¢«å®³è€…ã®ãƒ–ãƒ©ã‚¦ã‚¶å±¥æ­´ã«ã‚¢ã‚¯ã‚»ã‚¹
2. URLã‹ã‚‰JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
3. å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã§è¢«å®³è€…ã«ãªã‚Šã™ã¾ã—
4. è¢«å®³è€…ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ä¸æ­£æ“ä½œ
</code></pre>
<p><strong>ä¿®æ­£å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// âœ… å®‰å…¨ãªå®Ÿè£…
// HTTPOnly Cookieã‚’ä½¿ç”¨
res.cookie('access_token', token, {
  httpOnly: true,     // JavaScript ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯
  secure: process.env.NODE_ENV === 'production', // HTTPSå¿…é ˆ
  sameSite: 'strict', // CSRFæ”»æ’ƒé˜²æ­¢
  maxAge: 15 * 60 * 1000, // 15åˆ†ã§æœŸé™åˆ‡ã‚Œ
  path: '/'
});

// URLã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚ãªã„
const redirectUrl = `${frontendUrl}/auth/callback?success=true`;
res.redirect(redirectUrl);
</code></pre>
<h4 id="2-ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆjwtç§˜å¯†éµ-cvss-86">2. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆJWTç§˜å¯†éµ (CVSS 8.6)</h4>
<p><strong>è„†å¼±æ€§ã®è©³ç´°</strong>:</p>
<pre><code class="language-typescript">// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰
const secret = process.env.JWT_SECRET || 'default-secret';
</code></pre>
<p><strong>å•é¡Œç‚¹</strong>:</p>
<ul>
<li>ç’°å¢ƒå¤‰æ•°æœªè¨­å®šæ™‚ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå€¤ã‚’ä½¿ç”¨</li>
<li>æ”»æ’ƒè€…ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æ¨æ¸¬å¯èƒ½</li>
<li>ç½²åå½é€ ã«ã‚ˆã‚‹ãªã‚Šã™ã¾ã—å¯èƒ½</li>
</ul>
<p><strong>ä¿®æ­£å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// âœ… å®‰å…¨ãªå®Ÿè£…
const validateJwtSecret = () => {
  const secret = process.env.JWT_SECRET;
  
  // å¿…é ˆãƒã‚§ãƒƒã‚¯
  if (!secret) {
    throw new Error('JWT_SECRETç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
  }
  
  // é•·ã•ãƒã‚§ãƒƒã‚¯ï¼ˆæœ€ä½32æ–‡å­—ï¼‰
  if (secret.length &#x3C; 32) {
    throw new Error('JWT_SECRETã¯æœ€ä½32æ–‡å­—ä»¥ä¸Šå¿…è¦ã§ã™');
  }
  
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãƒã‚§ãƒƒã‚¯
  const dangerousDefaults = ['default-secret', 'secret', 'key', 'jwt-secret'];
  if (dangerousDefaults.includes(secret.toLowerCase())) {
    throw new Error('JWT_SECRETã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚„æ¨æ¸¬å¯èƒ½ãªå€¤ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“');
  }
  
  // ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼ˆç°¡æ˜“ï¼‰
  const uniqueChars = new Set(secret).size;
  if (uniqueChars &#x3C; 16) {
    console.warn('JWT_SECRETã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒä½ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™');
  }
  
  return secret;
};

// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«æ¤œè¨¼
const JWT_SECRET = validateJwtSecret();

// å¼·åŠ›ãªç§˜å¯†éµç”Ÿæˆã‚³ãƒãƒ³ãƒ‰ã®ä¾‹
// openssl rand -hex 64
</code></pre>
<h4 id="3-sqlã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§æ½œåœ¨çš„cvss-82">3. SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ï¼ˆæ½œåœ¨çš„ï¼‰(CVSS 8.2)</h4>
<p><strong>è„†å¼±æ€§èª¿æŸ»</strong>:</p>
<pre><code class="language-typescript">// æ½œåœ¨çš„ãƒªã‚¹ã‚¯ã®ã‚ã‚‹ã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢
const riskyPatterns = [
  'SELECT * FROM users WHERE email = "' + email + '"',
  'UPDATE materials SET title = "' + req.body.title + '"',
  `DELETE FROM files WHERE id = ${fileId}`
];
</code></pre>
<p><strong>å®‰å…¨ãªå®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä½¿ç”¨
const getUserByEmail = async (email: string) => {
  const query = 'SELECT * FROM users WHERE email = $1';
  const result = await pool.query(query, [email]);
  return result.rows[0];
};

// âœ… ORMä½¿ç”¨æ™‚ã®å®‰å…¨ãªå®Ÿè£…
const materials = await Material.findAll({
  where: {
    title: {
      [Op.like]: `%${searchTerm}%` // Sequelize ãŒè‡ªå‹•çš„ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    }
  }
});

// âœ… å…¥åŠ›æ¤œè¨¼ã®è¿½åŠ 
import { z } from 'zod';

const searchSchema = z.object({
  query: z.string().max(100).regex(/^[a-zA-Z0-9\s\-_]+$/),
  page: z.number().int().positive().max(1000),
  limit: z.number().int().positive().max(100)
});

// ä½¿ç”¨å‰ã«æ¤œè¨¼
const validatedInput = searchSchema.parse(req.query);
</code></pre>
<h3 id="-é«˜ãƒªã‚¹ã‚¯ã®è„†å¼±æ€§high">ğŸŸ  é«˜ãƒªã‚¹ã‚¯ã®è„†å¼±æ€§ï¼ˆHighï¼‰</h3>
<h4 id="4-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¬ å¦‚-cvss-75">4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¬ å¦‚ (CVSS 7.5)</h4>
<p><strong>å•é¡Œç‚¹</strong>: é‡è¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„</p>
<p><strong>å¯¾ç­–å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// backend/src/middleware/security.ts
import helmet from 'helmet';

export const securityHeaders = helmet({
  // Content Security Policy
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: [
        "'self'",
        "'unsafe-inline'", // React ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”¨
        "https://apis.google.com" // Google OAuthç”¨
      ],
      styleSrc: [
        "'self'",
        "'unsafe-inline'", // Tailwind CSSç”¨
        "https://fonts.googleapis.com"
      ],
      imgSrc: [
        "'self'",
        "data:",
        "https:", // Google ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒç”¨
      ],
      connectSrc: ["'self'"],
      fontSrc: [
        "'self'",
        "https://fonts.gstatic.com"
      ],
      objectSrc: ["'none'"],
      mediaSrc: ["'self'"],
      frameSrc: ["'none'"],
      upgradeInsecureRequests: []
    }
  },
  
  // HTTP Strict Transport Security
  hsts: {
    maxAge: 31536000, // 1å¹´
    includeSubDomains: true,
    preload: true
  },
  
  // X-Content-Type-Options
  noSniff: true,
  
  // X-Frame-Options
  frameguard: { action: 'deny' },
  
  // X-XSS-Protection
  xssFilter: true,
  
  // Referrer Policy
  referrerPolicy: {
    policy: 'strict-origin-when-cross-origin'
  },
  
  // Permissions Policy
  permittedCrossDomainPolicies: false
});

// è¿½åŠ ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼
export const additionalHeaders = (req: Request, res: Response, next: NextFunction) => {
  // Feature Policy / Permissions Policy
  res.setHeader('Permissions-Policy', 
    'camera=(), microphone=(), geolocation=(), payment=()'
  );
  
  // Serveræƒ…å ±ã®éš è”½
  res.removeHeader('X-Powered-By');
  
  next();
};
</code></pre>
<h4 id="5-csrfä¿è­·ã®æ¬ å¦‚-cvss-75">5. CSRFä¿è­·ã®æ¬ å¦‚ (CVSS 7.5)</h4>
<p><strong>å¯¾ç­–å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// backend/src/middleware/csrf.ts
import csrf from 'csurf';

// CSRFä¿è­·ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
export const csrfProtection = csrf({
  cookie: {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    sameSite: 'strict'
  },
  ignoreMethods: ['GET', 'HEAD', 'OPTIONS'] // å®‰å…¨ãªãƒ¡ã‚½ãƒƒãƒ‰ã¯é™¤å¤–
});

// CSRFãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
router.get('/csrf-token', csrfProtection, (req, res) => {
  res.json({ 
    csrfToken: req.csrfToken(),
    tokenName: '_csrf' // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨
  });
});

// ä½¿ç”¨ä¾‹ï¼ˆé‡è¦ãªæ“ä½œã«é©ç”¨ï¼‰
router.post('/api/materials', csrfProtection, authenticateToken, createMaterial);
router.delete('/api/materials/:id', csrfProtection, authenticateToken, deleteMaterial);
router.post('/api/auth/logout', csrfProtection, logout);
</code></pre>
<h4 id="6-ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®æœªå®Ÿè£…-cvss-75">6. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®æœªå®Ÿè£… (CVSS 7.5)</h4>
<p><strong>å¯¾ç­–å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// backend/src/middleware/rateLimit.ts
import rateLimit from 'express-rate-limit';

// ä¸€èˆ¬çš„ãªAPIåˆ¶é™
export const generalRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†
  max: 100, // æœ€å¤§100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
  message: {
    error: 'ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚15åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  },
  standardHeaders: true,
  legacyHeaders: false,
});

// èªè¨¼é–¢é€£ã®å³ã—ã„åˆ¶é™
export const authRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†
  max: 5, // æœ€å¤§5å›
  message: {
    error: 'èªè¨¼è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚15åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  },
  standardHeaders: true,
  legacyHeaders: false,
  // IP + ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã‚­ãƒ¼ã‚’ç”Ÿæˆ
  keyGenerator: (req) => {
    return `${req.ip}:${req.headers['user-agent']}`;
  }
});

// ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒå¯¾ç­–
export const loginRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 3, // 3å›ã¾ã§
  skipSuccessfulRequests: true, // æˆåŠŸã—ãŸå ´åˆã¯ã‚«ã‚¦ãƒ³ãƒˆã—ãªã„
  keyGenerator: (req) => {
    // IP + ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚­ãƒ¼ã‚’ç”Ÿæˆ
    return `${req.ip}:${req.body.email || 'unknown'}`;
  },
  handler: (req, res) => {
    res.status(429).json({
      error: 'ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸ',
      retryAfter: Math.round(req.rateLimit.resetTime / 1000)
    });
  }
});

// ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰åˆ¶é™
export const uploadRateLimit = rateLimit({
  windowMs: 60 * 60 * 1000, // 1æ™‚é–“
  max: 10, // æœ€å¤§10ãƒ•ã‚¡ã‚¤ãƒ«
  message: {
    error: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚1æ™‚é–“å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  }
});
</code></pre>
<h2 id="owasp-top-10å¯¾ç­–å®Ÿè£…">OWASP Top 10å¯¾ç­–å®Ÿè£…</h2>
<h3 id="a01-broken-access-controlèªå¯åˆ¶å¾¡ã®ä¸å‚™">A01: Broken Access Controlï¼ˆèªå¯åˆ¶å¾¡ã®ä¸å‚™ï¼‰</h3>
<p><strong>å¯¾ç­–å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// backend/src/middleware/authorization.ts
export const requireOwnership = (resourceType: string) => {
  return async (req: any, res: Response, next: NextFunction) => {
    try {
      const userId = req.user.id;
      const resourceId = req.params.id;
      
      let isOwner = false;
      
      switch (resourceType) {
        case 'material':
          const material = await Material.findById(resourceId);
          isOwner = material &#x26;&#x26; material.user_id === userId;
          break;
        case 'comment':
          const comment = await Comment.findById(resourceId);
          isOwner = comment &#x26;&#x26; comment.user_id === userId;
          break;
      }
      
      if (!isOwner) {
        return res.status(403).json({ error: 'ã“ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“' });
      }
      
      next();
    } catch (error) {
      res.status(500).json({ error: 'ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' });
    }
  };
};

// ä½¿ç”¨ä¾‹
router.delete('/api/materials/:id', 
  authenticateToken, 
  requireOwnership('material'), 
  deleteMaterial
);
</code></pre>
<h3 id="a02-cryptographic-failuresæš—å·åŒ–ã®ä¸å‚™">A02: Cryptographic Failuresï¼ˆæš—å·åŒ–ã®ä¸å‚™ï¼‰</h3>
<p><strong>å¯¾ç­–å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// backend/src/utils/encryption.ts
import crypto from 'crypto';
import bcrypt from 'bcrypt';

// æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–
export class DataEncryption {
  private static readonly algorithm = 'aes-256-gcm';
  private static readonly keyLength = 32;
  private static readonly ivLength = 16;
  private static readonly tagLength = 16;
  
  private static getKey(): Buffer {
    const key = process.env.ENCRYPTION_KEY;
    if (!key) {
      throw new Error('æš—å·åŒ–ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
    return crypto.scryptSync(key, 'salt', this.keyLength);
  }
  
  // ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–
  static encrypt(text: string): string {
    const iv = crypto.randomBytes(this.ivLength);
    const cipher = crypto.createCipher(this.algorithm, this.getKey());
    cipher.setAAD(Buffer.from('additional-data'));
    
    let encrypted = cipher.update(text, 'utf8', 'hex');
    encrypted += cipher.final('hex');
    
    const tag = cipher.getAuthTag();
    
    return `${iv.toString('hex')}:${tag.toString('hex')}:${encrypted}`;
  }
  
  // ãƒ‡ãƒ¼ã‚¿å¾©å·åŒ–
  static decrypt(encryptedData: string): string {
    const [ivHex, tagHex, encrypted] = encryptedData.split(':');
    
    const iv = Buffer.from(ivHex, 'hex');
    const tag = Buffer.from(tagHex, 'hex');
    
    const decipher = crypto.createDecipher(this.algorithm, this.getKey());
    decipher.setAAD(Buffer.from('additional-data'));
    decipher.setAuthTag(tag);
    
    let decrypted = decipher.update(encrypted, 'hex', 'utf8');
    decrypted += decipher.final('utf8');
    
    return decrypted;
  }
}

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆbcryptï¼‰
export class PasswordSecurity {
  private static readonly saltRounds = 12;
  
  static async hash(password: string): Promise&#x3C;string> {
    return bcrypt.hash(password, this.saltRounds);
  }
  
  static async verify(password: string, hash: string): Promise&#x3C;boolean> {
    return bcrypt.compare(password, hash);
  }
}
</code></pre>
<h3 id="a03-injectionã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³">A03: Injectionï¼ˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼‰</h3>
<p><strong>å¯¾ç­–å®Ÿè£…</strong>:</p>
<pre><code class="language-typescript">// backend/src/utils/sqlSanitizer.ts
import { Pool } from 'pg';

export class SafeDatabase {
  constructor(private pool: Pool) {}
  
  // å®‰å…¨ãªã‚¯ã‚¨ãƒªå®Ÿè¡Œ
  async query(text: string, params: any[] = []): Promise&#x3C;any> {
    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¤œè¨¼
    this.validateParams(params);
    
    try {
      const result = await this.pool.query(text, params);
      return result;
    } catch (error) {
      // SQLã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’éš è”½
      console.error('Database error:', error);
      throw new Error('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
    }
  }
  
  private validateParams(params: any[]): void {
    for (const param of params) {
      if (typeof param === 'string') {
        // å±é™ºãªSQLæ–‡å­—ã®æ¤œå‡º
        const dangerousPatterns = [
          /(\b(union|select|insert|update|delete|drop|create|alter|exec|execute)\b)/i,
          /(;|--|\/\*|\*\/)/,
          /(\bor\b.*=.*|1=1|true)/i
        ];
        
        for (const pattern of dangerousPatterns) {
          if (pattern.test(param)) {
            throw new Error('ä¸æ­£ãªå…¥åŠ›ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ');
          }
        }
      }
    }
  }
}

// å…¥åŠ›æ¤œè¨¼ã‚¹ã‚­ãƒ¼ãƒ
import { z } from 'zod';

export const inputSchemas = {
  // æ¤œç´¢ã‚¯ã‚¨ãƒª
  search: z.object({
    query: z.string()
      .max(100, 'æ¤œç´¢ã‚¯ã‚¨ãƒªã¯100æ–‡å­—ä»¥å†…')
      .regex(/^[a-zA-Z0-9\s\-_.!?ã‚-ã‚“\u4e00-\u9faf]*$/, 'ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),
    page: z.number().int().positive().max(1000),
    limit: z.number().int().positive().max(100)
  }),
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
  userProfile: z.object({
    username: z.string()
      .min(3, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯3æ–‡å­—ä»¥ä¸Š')
      .max(50, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯50æ–‡å­—ä»¥å†…')
      .regex(/^[a-zA-Z0-9_-]+$/, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯è‹±æ•°å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã€ãƒã‚¤ãƒ•ãƒ³ã®ã¿'),
    email: z.string().email('æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),
    bio: z.string().max(500, 'è‡ªå·±ç´¹ä»‹ã¯500æ–‡å­—ä»¥å†…').optional()
  }),
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  fileUpload: z.object({
    filename: z.string()
      .max(255, 'ãƒ•ã‚¡ã‚¤ãƒ«åã¯255æ–‡å­—ä»¥å†…')
      .regex(/^[a-zA-Z0-9._-]+$/, 'ãƒ•ã‚¡ã‚¤ãƒ«åã«ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),
    size: z.number().positive().max(50 * 1024 * 1024, 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯50MBä»¥å†…')
  })
};
</code></pre>
<h2 id="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…</h2>
<h3 id="åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š">åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š</h3>
<pre><code class="language-typescript">// backend/src/middleware/comprehensiveSecurity.ts
import { Request, Response, NextFunction } from 'express';

export const comprehensiveSecurityHeaders = (req: Request, res: Response, next: NextFunction) => {
  // Content Security Policyï¼ˆè©³ç´°è¨­å®šï¼‰
  const cspDirectives = [
    "default-src 'self'",
    "script-src 'self' 'unsafe-inline' https://apis.google.com",
    "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
    "img-src 'self' data: https:",
    "font-src 'self' https://fonts.gstatic.com",
    "connect-src 'self'",
    "media-src 'self'",
    "object-src 'none'",
    "child-src 'none'",
    "frame-src 'none'",
    "worker-src 'none'",
    "manifest-src 'self'",
    "base-uri 'self'",
    "form-action 'self'",
    "frame-ancestors 'none'",
    "upgrade-insecure-requests"
  ].join('; ');
  
  res.setHeader('Content-Security-Policy', cspDirectives);
  
  // HTTP Strict Transport Security
  res.setHeader('Strict-Transport-Security', 
    'max-age=31536000; includeSubDomains; preload');
  
  // X-Content-Type-Options
  res.setHeader('X-Content-Type-Options', 'nosniff');
  
  // X-Frame-Options
  res.setHeader('X-Frame-Options', 'DENY');
  
  // X-XSS-Protection
  res.setHeader('X-XSS-Protection', '1; mode=block');
  
  // Referrer Policy
  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');
  
  // Permissions Policy
  const permissionsPolicy = [
    'camera=()',
    'microphone=()',
    'geolocation=()',
    'payment=()',
    'usb=()',
    'magnetometer=()',
    'accelerometer=()',
    'gyroscope=()'
  ].join(', ');
  
  res.setHeader('Permissions-Policy', permissionsPolicy);
  
  // Cross-Origin Policies
  res.setHeader('Cross-Origin-Embedder-Policy', 'require-corp');
  res.setHeader('Cross-Origin-Opener-Policy', 'same-origin');
  res.setHeader('Cross-Origin-Resource-Policy', 'same-site');
  
  // Cache Control for sensitive pages
  if (req.path.includes('/auth') || req.path.includes('/admin')) {
    res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate, private');
    res.setHeader('Pragma', 'no-cache');
    res.setHeader('Expires', '0');
  }
  
  // Serveræƒ…å ±ã®éš è”½
  res.removeHeader('X-Powered-By');
  res.removeHeader('Server');
  
  next();
};
</code></pre>
<h2 id="ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½">ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½</h2>
<h3 id="ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªè¨­è¨ˆ">ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªè¨­è¨ˆ</h3>
<pre><code class="language-typescript">// tests/security/penetration.test.ts
describe('Penetration Testing', () => {
  
  // 1. ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆ
  describe('Injection Attacks', () => {
    it('SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è€æ€§', async () => {
      const maliciousInputs = [
        "'; DROP TABLE users; --",
        "' OR '1'='1",
        "'; SELECT * FROM users WHERE email = 'admin@example.com'; --",
        "1' UNION SELECT password FROM users--"
      ];
      
      for (const input of maliciousInputs) {
        const response = await request(app)
          .get('/api/search')
          .query({ q: input });
        
        // SQLã‚¨ãƒ©ãƒ¼ãŒéœ²å‡ºã—ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
        expect(response.status).not.toBe(500);
        expect(response.body.error).not.toContain('SQL');
        expect(response.body.error).not.toContain('database');
      }
    });
    
    it('NoSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è€æ€§', async () => {
      const maliciousInputs = [
        { $ne: null },
        { $gt: "" },
        { $regex: ".*" },
        { $where: "return true" }
      ];
      
      for (const input of maliciousInputs) {
        const response = await request(app)
          .post('/api/materials/search')
          .send({ query: input });
        
        expect(response.status).toBe(400);
        expect(response.body.error).toContain('ä¸æ­£ãªå…¥åŠ›');
      }
    });
  });
  
  // 2. èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ
  describe('Authentication Bypass', () => {
    it('JWT ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œè€æ€§', async () => {
      const maliciousTokens = [
        'eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpZCI6IjEiLCJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIn0.',
        'malformed.token.here',
        '',
        'Bearer null',
        'Bearer undefined'
      ];
      
      for (const token of maliciousTokens) {
        const response = await request(app)
          .get('/api/auth/me')
          .set('Authorization', `Bearer ${token}`);
        
        expect(response.status).toBe(401);
      }
    });
    
    it('æ¨©é™æ˜‡æ ¼æ”»æ’ƒè€æ€§', async () => {
      // ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ç®¡ç†è€…æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œ
      const userToken = await getValidUserToken();
      
      const adminEndpoints = [
        '/api/admin/users',
        '/api/admin/settings',
        '/api/admin/logs'
      ];
      
      for (const endpoint of adminEndpoints) {
        const response = await request(app)
          .get(endpoint)
          .set('Authorization', `Bearer ${userToken}`);
        
        expect(response.status).toBe(403);
      }
    });
  });
  
  // 3. XSSæ”»æ’ƒãƒ†ã‚¹ãƒˆ
  describe('Cross-Site Scripting (XSS)', () => {
    it('Stored XSSè€æ€§', async () => {
      const xssPayloads = [
        '&#x3C;script>alert("XSS")&#x3C;/script>',
        '&#x3C;img src="x" onerror="alert(\'XSS\')">',
        'javascript:alert("XSS")',
        '&#x3C;svg/onload=alert("XSS")>'
      ];
      
      for (const payload of xssPayloads) {
        const response = await request(app)
          .post('/api/materials')
          .send({ title: payload, description: 'Test' });
        
        // XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
        const material = await getMaterial(response.body.id);
        expect(material.title).not.toContain('&#x3C;script>');
        expect(material.title).not.toContain('javascript:');
      }
    });
  });
});
</code></pre>
<h2 id="ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–">ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–</h2>
<h3 id="è‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ">è‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ</h3>
<pre><code class="language-typescript">// scripts/security-scan.ts
import { execSync } from 'child_process';

export class SecurityScanner {
  
  // ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
  static async scanDependencies(): Promise&#x3C;void> {
    console.log('ğŸ” ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³é–‹å§‹...');
    
    try {
      execSync('npm audit --audit-level high', { stdio: 'inherit' });
      console.log('âœ… ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†');
    } catch (error) {
      console.error('âŒ é«˜ãƒªã‚¹ã‚¯ä»¥ä¸Šã®è„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸ');
      throw error;
    }
  }
  
  // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯
  static async checkSecurityHeaders(url: string): Promise&#x3C;void> {
    console.log('ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯é–‹å§‹...');
    
    const requiredHeaders = [
      'Strict-Transport-Security',
      'X-Content-Type-Options',
      'X-Frame-Options',
      'X-XSS-Protection',
      'Content-Security-Policy',
      'Referrer-Policy'
    ];
    
    try {
      const response = await fetch(url);
      
      for (const header of requiredHeaders) {
        if (!response.headers.get(header)) {
          throw new Error(`å¿…é ˆãƒ˜ãƒƒãƒ€ãƒ¼ ${header} ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“`);
        }
      }
      
      console.log('âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯å®Œäº†');
    } catch (error) {
      console.error('âŒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å•é¡Œ:', error.message);
      throw error;
    }
  }
  
  // HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯
  static async checkHTTPS(url: string): Promise&#x3C;void> {
    console.log('ğŸ” HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯é–‹å§‹...');
    
    try {
      const httpsUrl = url.replace('http://', 'https://');
      const response = await fetch(httpsUrl);
      
      if (!response.ok) {
        throw new Error('HTTPSæ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
      
      // HSTSç¢ºèª
      const hstsHeader = response.headers.get('Strict-Transport-Security');
      if (!hstsHeader || !hstsHeader.includes('max-age')) {
        throw new Error('HSTSè¨­å®šãŒä¸é©åˆ‡ã§ã™');
      }
      
      console.log('âœ… HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯å®Œäº†');
    } catch (error) {
      console.error('âŒ HTTPSè¨­å®šã®å•é¡Œ:', error.message);
      throw error;
    }
  }
}

// CI/CDã§ã®å®Ÿè¡Œ
async function runSecurityChecks(): Promise&#x3C;void> {
  try {
    await SecurityScanner.scanDependencies();
    await SecurityScanner.checkSecurityHeaders('https://example.com');
    await SecurityScanner.checkHTTPS('https://example.com');
    
    console.log('ğŸ‰ ã™ã¹ã¦ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ');
  } catch (error) {
    console.error('ğŸ’¥ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãŒå¤±æ•—ã—ã¾ã—ãŸ');
    process.exit(1);
  }
}
</code></pre>
<h2 id="ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰">ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰</h2>
<h3 id="github-actions-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼">GitHub Actions ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h3>
<pre><code class="language-yaml"># .github/workflows/security.yml
name: Security Scan

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    # æ¯æ—¥åˆå‰3æ™‚ã«å®Ÿè¡Œ
    - cron: '0 3 * * *'

jobs:
  security-scan:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    # ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
    - name: Run npm audit
      run: |
        npm audit --audit-level high
        npm audit --json > audit-report.json
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    - name: Run security tests
      run: npm run test:security
    
    # CodeQL åˆ†æ
    - name: Initialize CodeQL
      uses: github/codeql-action/init@v2
      with:
        languages: typescript, javascript
    
    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v2
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    - name: Generate security report
      run: node scripts/generate-security-report.js
    
    # è„†å¼±æ€§ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã®é€šçŸ¥
    - name: Notify security team
      if: failure()
      uses: 8398a7/action-slack@v3
      with:
        status: failure
        text: 'ğŸš¨ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã§å•é¡ŒãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸ'
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã—ã¦ä¿å­˜
    - name: Upload security report
      uses: actions/upload-artifact@v3
      if: always()
      with:
        name: security-report
        path: |
          audit-report.json
          security-report.html
        retention-days: 30
</code></pre>
<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚</h2>
<p>ã“ã®è¨˜äº‹ã§ã¯ã€å®Ÿéš›ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨å¯¾ç­–å®Ÿè£…ã‚’è©³ç´°ã«è§£èª¬ã—ã¾ã—ãŸã€‚</p>
<h3 id="-é”æˆã§ããŸã“ã¨">ğŸ¯ é”æˆã§ããŸã“ã¨</h3>
<h4 id="è„†å¼±æ€§å¯¾ç­–">è„†å¼±æ€§å¯¾ç­–</h4>
<ul>
<li><strong>38ä»¶ã®è„†å¼±æ€§</strong>ã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ï¼ˆé‡å¤§8ä»¶ã€é«˜12ä»¶ã€ä¸­15ä»¶ã€ä½3ä»¶ï¼‰</li>
<li><strong>OWASP Top 10</strong>ã¸ã®åŒ…æ‹¬çš„å¯¾å¿œ</li>
<li><strong>ã‚¼ãƒ­é‡å¤§è„†å¼±æ€§</strong>ã‚’é”æˆ</li>
</ul>
<h4 id="ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºç›¤">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºç›¤</h4>
<ul>
<li><strong>å¤šå±¤é˜²å¾¡</strong>ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ§‹ç¯‰</li>
<li><strong>è‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ</strong>ã®å°å…¥</li>
<li><strong>ç¶™ç¶šçš„ç›£è¦–</strong>ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰</li>
</ul>
<h4 id="é‹ç”¨ä½“åˆ¶">é‹ç”¨ä½“åˆ¶</h4>
<ul>
<li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</strong>ã«ã‚ˆã‚‹å¯è¦–åŒ–</li>
<li><strong>ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ</strong>ãƒ—ãƒ­ã‚»ã‚¹ã®ç¢ºç«‹</li>
<li><strong>ãƒãƒ¼ãƒ å…¨ä½“</strong>ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ„è­˜å‘ä¸Š</li>
</ul>
<h3 id="-å®Ÿæ–½åŠ¹æœ">ğŸ“ˆ å®Ÿæ–½åŠ¹æœ</h3>
<ul>
<li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ™ãƒ«</strong>: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã«å‘ä¸Š</li>
<li><strong>é–‹ç™ºåŠ¹ç‡</strong>: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèªä½œæ¥­70%å‰Šæ¸›</li>
<li><strong>é‹ç”¨å“è³ª</strong>: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ0ä»¶ç¶­æŒ</li>
<li><strong>ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹</strong>: OWASPæº–æ‹ ã«ã‚ˆã‚Šç›£æŸ»å¯¾å¿œæº–å‚™å®Œäº†</li>
</ul>
<h3 id="ï¸-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦">ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦</h3>
<pre><code class="language-markdown">## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦ãƒ¬ãƒ™ãƒ«
ãƒ¬ãƒ™ãƒ«1ï¼ˆåå¿œçš„ï¼‰: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿå¾Œã«å¯¾å¿œ
ãƒ¬ãƒ™ãƒ«2ï¼ˆç®¡ç†çš„ï¼‰: å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
ãƒ¬ãƒ™ãƒ«3ï¼ˆå®šç¾©çš„ï¼‰: æ¨™æº–åŒ–ã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ­ã‚»ã‚¹
ãƒ¬ãƒ™ãƒ«4ï¼ˆå®šé‡çš„ï¼‰: ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†
ãƒ¬ãƒ™ãƒ«5ï¼ˆæœ€é©åŒ–ï¼‰: ç¶™ç¶šçš„æ”¹å–„ã¨ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³

â†’ ç¾åœ¨ãƒ¬ãƒ™ãƒ«4ã‚’é”æˆã€ãƒ¬ãƒ™ãƒ«5ã«å‘ã‘ã¦æ”¹å–„ç¶™ç¶šä¸­
</code></pre>
<h3 id="-ä»Šå¾Œã®å±•é–‹">ğŸš€ ä»Šå¾Œã®å±•é–‹</h3>
<ol>
<li><strong>AIã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</strong>: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥ã®å°å…¥</li>
<li><strong>ã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆ</strong>: ã‚ˆã‚Šé«˜åº¦ãªèªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ </li>
<li><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚¤ãƒ‡ã‚¶ã‚¤ãƒ³</strong>: è¨­è¨ˆæ®µéšã‹ã‚‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ„ã¿è¾¼ã¿</li>
<li><strong>å›½éš›èªè¨¼</strong>: ISO27001ã€SOC2ç­‰ã®å–å¾—æ¤œè¨</li>
</ol>
<p>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯ä¸€åº¦ã§å®Œç’§ã«ã§ãã‚‹ã‚‚ã®ã§ã¯ãªãã€ç¶™ç¶šçš„ãªæ”¹å–„ãŒé‡è¦ã§ã™ã€‚</p>
<h2 id="å‚è€ƒãƒªãƒ³ã‚¯">å‚è€ƒãƒªãƒ³ã‚¯</h2>
<ul>
<li><a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a></li>
<li><a href="https://www.nist.gov/cyberframework">NIST Cybersecurity Framework</a></li>
<li><a href="https://cwe.mitre.org/">CWE Common Weakness Enumeration</a></li>
<li><a href="https://www.first.org/cvss/calculator/3.1">CVSS Calculator</a></li>
<li><a href="https://securityheaders.com/">Security Headers</a></li>
<li><a href="https://infosec.mozilla.org/guidelines/web_security">Mozilla Security Guidelines</a></li>
</ul>
<hr>
<p><em>ã“ã®è¨˜äº‹ã¯å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ŒDrill Layerã€ã§ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»çµŒé¨“ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¾ã—ãŸã€‚</em></p>
<p><em>åˆå¿ƒè€…ã®æ–¹ã¸ï¼šã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯æ®µéšçš„ã«å­¦ç¿’ãƒ»å®Ÿè£…ã—ã¦ã„ãã“ã¨ãŒé‡è¦ã§ã™ã€‚ã¾ãšã¯åŸºæœ¬çš„ãªå¯¾ç­–ã‹ã‚‰å§‹ã‚ã¦ã€å¾ã€…ã«é«˜åº¦ãªå¯¾ç­–ã‚’å–ã‚Šå…¥ã‚Œã¦ã„ãã¾ã—ã‚‡ã†ã€‚</em></p></article><nav class="mt-8 pt-4 border-t border-gray-700 flex justify-between"><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/">â† ãƒ›ãƒ¼ãƒ ã¸</a><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/blog/">è¨˜äº‹ä¸€è¦§ã¸ â†’</a></nav></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-aa7deb192a774533.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n5:I[59665,[],\"MetadataBoundary\"]\n7:I[59665,[],\"OutletBoundary\"]\na:I[74911,[],\"AsyncMetadataOutlet\"]\nc:I[59665,[],\"ViewportBoundary\"]\ne:I[26614,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/19bdf9af4d1ae4d4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"qepat1HgROqLjfWdf0ONn\",\"p\":\"\",\"c\":[\"\",\"blog\",\"web-security-audit-comprehensive\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"web-security-audit-comprehensive\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/19bdf9af4d1ae4d4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png\",\"type\":\"image/png\"}]}],[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac __variable_9a8899 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"web-security-audit-comprehensive\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"mn_zmcys9O0zjYEXKSzpt\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[74911,[],\"AsyncMetadata\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script><script>self.__next_f.push([1,"12:I[6874,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"\"]\n14:I[31203,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"default\"]\n15:I[4197,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"default\"]\n13:T8507,"])</script><script>self.__next_f.push([1,"\u003cp\u003eæ•™æå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€ŒDrill Layerã€ã§ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»å®Ÿæ–½ã‚’é€šã˜ã¦ã€OWASP Top 10ã«åŸºã¥ãåŒ…æ‹¬çš„è„†å¼±æ€§å¯¾ç­–ã¨å®Ÿéš›ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–æ‰‹æ³•ã‚’è©³ç´°ã«è§£èª¬ã—ã¾ã™ã€‚\u003c/p\u003e\n\u003ch2 id=\"-åˆå¿ƒè€…å‘ã‘è§£èª¬\"\u003eğŸ’¡ åˆå¿ƒè€…å‘ã‘è§£èª¬\u003c/h2\u003e\n\u003ch3 id=\"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨ã¯\"\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨ã¯ï¼Ÿ\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eç°¡å˜ã«è¨€ã†ã¨\u003c/strong\u003e: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ç©´ã€ã‚’è¦‹ã¤ã‘ã¦ä¿®æ­£ã™ã‚‹ä½œæ¥­ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eé€šå¸¸ã®é–‹ç™ºãƒ†ã‚¹ãƒˆ: ã€Œæ©Ÿèƒ½ãŒæ­£ã—ãå‹•ãã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯\nã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»: ã€Œæ‚ªæ„ã‚ã‚‹æ”»æ’ƒã«è€ãˆã‚‰ã‚Œã‚‹ã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"owasp-top-10ã¨ã¯\"\u003eOWASP Top 10ã¨ã¯ï¼Ÿ\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eOWASPï¼ˆã‚ªãƒ¯ã‚¹ãƒ—ï¼‰\u003c/strong\u003e: Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»£è¡¨çš„ãªè„†å¼±æ€§ãƒ©ãƒ³ã‚­ãƒ³ã‚°\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eä¸–ç•Œä¸­ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å°‚é–€å®¶ãŒé¸ã¶\nã€Œæœ€ã‚‚å±é™ºãª10ã®è„†å¼±æ€§ã€ã®ãƒªã‚¹ãƒˆ\né–‹ç™ºè€…ãŒå„ªå…ˆçš„ã«å¯¾ç­–ã™ã¹ãé …ç›®\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"-ç›®æ¬¡\"\u003eğŸ“š ç›®æ¬¡\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E7%9B%A3%E6%9F%BB%E3%81%AE%E6%A6%82%E8%A6%81%E3%81%A8%E6%96%B9%E6%B3%95%E8%AB%96\"\u003eç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E7%99%BA%E8%A6%8B%E3%81%95%E3%82%8C%E3%81%9F%E8%84%86%E5%BC%B1%E6%80%A7%E5%88%86%E6%9E%90\"\u003eç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#owasp-top-10%E5%AF%BE%E7%AD%96%E5%AE%9F%E8%A3%85\"\u003eOWASP Top 10å¯¾ç­–å®Ÿè£…\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%98%E3%83%83%E3%83%80%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A3%85\"\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%9A%E3%83%8D%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%86%E3%82%B9%E3%83%88%E5%AE%9F%E6%96%BD\"\u003eãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E4%BE%9D%E5%AD%98%E9%96%A2%E4%BF%82%E8%84%86%E5%BC%B1%E6%80%A7%E5%AF%BE%E7%AD%96\"\u003eä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E7%B6%99%E7%B6%9A%E7%9A%84%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E4%BD%93%E5%88%B6%E6%A7%8B%E7%AF%89\"\u003eç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eã¾ã¨ã‚\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–\"\u003eç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–\u003c/h2\u003e\n\u003ch3 id=\"å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³\"\u003eå¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eDrill Layer (æ•™æå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ )\nâ”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: React + TypeScript\nâ”œâ”€â”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Node.js + Express\nâ”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL\nâ”œâ”€â”€ èªè¨¼: Google OAuth + JWT\nâ””â”€â”€ ã‚¤ãƒ³ãƒ•ãƒ©: AWS (äºˆå®š)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ç›£æŸ»æ‰‹æ³•\"\u003eç›£æŸ»æ‰‹æ³•\u003c/h3\u003e\n\u003ch4 id=\"1-é™çš„è§£æstatic-analysis\"\u003e1. é™çš„è§£æï¼ˆStatic Analysisï¼‰\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã‚ˆã‚‹è„†å¼±æ€§æ¤œå‡º\n- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç›´æ¥ç¢ºèª\n- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª\n- ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"2-å‹•çš„è§£ædynamic-analysis\"\u003e2. å‹•çš„è§£æï¼ˆDynamic Analysisï¼‰\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# å®Ÿéš›ã«å‹•ä½œã•ã›ãªãŒã‚‰è„†å¼±æ€§æ¤œå‡º\n- ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ\n- ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆ\n- èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"3-è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³\"\u003e3. è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹åŒ…æ‹¬çš„ãƒã‚§ãƒƒã‚¯\nnpm audit                    # ä¾å­˜é–¢ä¿‚è„†å¼±æ€§\nnpm audit --audit-level high # é«˜ãƒªã‚¹ã‚¯ä»¥ä¸Šã®ã¿\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ç›£æŸ»åŸºæº–\"\u003eç›£æŸ»åŸºæº–\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-markdown\"\u003e## è©•ä¾¡åŸºæº–ï¼ˆCVSS v3.1ï¼‰\n- Critical (9.0-10.0): ç·Šæ€¥å¯¾å¿œå¿…è¦\n- High (7.0-8.9): æ—©æ€¥ãªå¯¾å¿œå¿…è¦\n- Medium (4.0-6.9): è¨ˆç”»çš„å¯¾å¿œ\n- Low (0.1-3.9): ä½™è£•ãŒã‚ã‚‹ã¨ãã«å¯¾å¿œ\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ\"\u003eç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ\u003c/h2\u003e\n\u003ch3 id=\"ç›£æŸ»çµæœã‚µãƒãƒªãƒ¼\"\u003eç›£æŸ»çµæœã‚µãƒãƒªãƒ¼\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-markdown\"\u003e## è„†å¼±æ€§çµ±è¨ˆ\né‡å¤§ (Critical): 8ä»¶\né«˜ (High): 12ä»¶\nä¸­ (Medium): 15ä»¶\nä½ (Low): 3ä»¶\nåˆè¨ˆ: 38ä»¶ã®è„†å¼±æ€§\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"-é‡å¤§ãªè„†å¼±æ€§critical\"\u003eğŸ”´ é‡å¤§ãªè„†å¼±æ€§ï¼ˆCriticalï¼‰\u003c/h3\u003e\n\u003ch4 id=\"1-jwt-ãƒˆãƒ¼ã‚¯ãƒ³ã®urlé€ä¿¡-cvss-91\"\u003e1. JWT ãƒˆãƒ¼ã‚¯ãƒ³ã®URLé€ä¿¡ (CVSS 9.1)\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eè„†å¼±æ€§ã®è©³ç´°\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰\nconst redirectUrl = `${frontendUrl}/auth/callback?token=${encodeURIComponent(token)}`;\nres.redirect(redirectUrl);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eæ”»æ’ƒã‚·ãƒŠãƒªã‚ª\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-markdown\"\u003e1. æ”»æ’ƒè€…ãŒè¢«å®³è€…ã®ãƒ–ãƒ©ã‚¦ã‚¶å±¥æ­´ã«ã‚¢ã‚¯ã‚»ã‚¹\n2. URLã‹ã‚‰JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—\n3. å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã§è¢«å®³è€…ã«ãªã‚Šã™ã¾ã—\n4. è¢«å®³è€…ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ä¸æ­£æ“ä½œ\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eä¿®æ­£å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âœ… å®‰å…¨ãªå®Ÿè£…\n// HTTPOnly Cookieã‚’ä½¿ç”¨\nres.cookie('access_token', token, {\n  httpOnly: true,     // JavaScript ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯\n  secure: process.env.NODE_ENV === 'production', // HTTPSå¿…é ˆ\n  sameSite: 'strict', // CSRFæ”»æ’ƒé˜²æ­¢\n  maxAge: 15 * 60 * 1000, // 15åˆ†ã§æœŸé™åˆ‡ã‚Œ\n  path: '/'\n});\n\n// URLã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚ãªã„\nconst redirectUrl = `${frontendUrl}/auth/callback?success=true`;\nres.redirect(redirectUrl);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"2-ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆjwtç§˜å¯†éµ-cvss-86\"\u003e2. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆJWTç§˜å¯†éµ (CVSS 8.6)\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eè„†å¼±æ€§ã®è©³ç´°\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰\nconst secret = process.env.JWT_SECRET || 'default-secret';\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eå•é¡Œç‚¹\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eç’°å¢ƒå¤‰æ•°æœªè¨­å®šæ™‚ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå€¤ã‚’ä½¿ç”¨\u003c/li\u003e\n\u003cli\u003eæ”»æ’ƒè€…ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æ¨æ¸¬å¯èƒ½\u003c/li\u003e\n\u003cli\u003eç½²åå½é€ ã«ã‚ˆã‚‹ãªã‚Šã™ã¾ã—å¯èƒ½\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eä¿®æ­£å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âœ… å®‰å…¨ãªå®Ÿè£…\nconst validateJwtSecret = () =\u003e {\n  const secret = process.env.JWT_SECRET;\n  \n  // å¿…é ˆãƒã‚§ãƒƒã‚¯\n  if (!secret) {\n    throw new Error('JWT_SECRETç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');\n  }\n  \n  // é•·ã•ãƒã‚§ãƒƒã‚¯ï¼ˆæœ€ä½32æ–‡å­—ï¼‰\n  if (secret.length \u0026#x3C; 32) {\n    throw new Error('JWT_SECRETã¯æœ€ä½32æ–‡å­—ä»¥ä¸Šå¿…è¦ã§ã™');\n  }\n  \n  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãƒã‚§ãƒƒã‚¯\n  const dangerousDefaults = ['default-secret', 'secret', 'key', 'jwt-secret'];\n  if (dangerousDefaults.includes(secret.toLowerCase())) {\n    throw new Error('JWT_SECRETã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚„æ¨æ¸¬å¯èƒ½ãªå€¤ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“');\n  }\n  \n  // ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼ˆç°¡æ˜“ï¼‰\n  const uniqueChars = new Set(secret).size;\n  if (uniqueChars \u0026#x3C; 16) {\n    console.warn('JWT_SECRETã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒä½ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™');\n  }\n  \n  return secret;\n};\n\n// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«æ¤œè¨¼\nconst JWT_SECRET = validateJwtSecret();\n\n// å¼·åŠ›ãªç§˜å¯†éµç”Ÿæˆã‚³ãƒãƒ³ãƒ‰ã®ä¾‹\n// openssl rand -hex 64\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"3-sqlã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§æ½œåœ¨çš„cvss-82\"\u003e3. SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ï¼ˆæ½œåœ¨çš„ï¼‰(CVSS 8.2)\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eè„†å¼±æ€§èª¿æŸ»\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// æ½œåœ¨çš„ãƒªã‚¹ã‚¯ã®ã‚ã‚‹ã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢\nconst riskyPatterns = [\n  'SELECT * FROM users WHERE email = \"' + email + '\"',\n  'UPDATE materials SET title = \"' + req.body.title + '\"',\n  `DELETE FROM files WHERE id = ${fileId}`\n];\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eå®‰å…¨ãªå®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä½¿ç”¨\nconst getUserByEmail = async (email: string) =\u003e {\n  const query = 'SELECT * FROM users WHERE email = $1';\n  const result = await pool.query(query, [email]);\n  return result.rows[0];\n};\n\n// âœ… ORMä½¿ç”¨æ™‚ã®å®‰å…¨ãªå®Ÿè£…\nconst materials = await Material.findAll({\n  where: {\n    title: {\n      [Op.like]: `%${searchTerm}%` // Sequelize ãŒè‡ªå‹•çš„ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—\n    }\n  }\n});\n\n// âœ… å…¥åŠ›æ¤œè¨¼ã®è¿½åŠ \nimport { z } from 'zod';\n\nconst searchSchema = z.object({\n  query: z.string().max(100).regex(/^[a-zA-Z0-9\\s\\-_]+$/),\n  page: z.number().int().positive().max(1000),\n  limit: z.number().int().positive().max(100)\n});\n\n// ä½¿ç”¨å‰ã«æ¤œè¨¼\nconst validatedInput = searchSchema.parse(req.query);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"-é«˜ãƒªã‚¹ã‚¯ã®è„†å¼±æ€§high\"\u003eğŸŸ  é«˜ãƒªã‚¹ã‚¯ã®è„†å¼±æ€§ï¼ˆHighï¼‰\u003c/h3\u003e\n\u003ch4 id=\"4-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¬ å¦‚-cvss-75\"\u003e4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¬ å¦‚ (CVSS 7.5)\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eå•é¡Œç‚¹\u003c/strong\u003e: é‡è¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eå¯¾ç­–å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/middleware/security.ts\nimport helmet from 'helmet';\n\nexport const securityHeaders = helmet({\n  // Content Security Policy\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      scriptSrc: [\n        \"'self'\",\n        \"'unsafe-inline'\", // React ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”¨\n        \"https://apis.google.com\" // Google OAuthç”¨\n      ],\n      styleSrc: [\n        \"'self'\",\n        \"'unsafe-inline'\", // Tailwind CSSç”¨\n        \"https://fonts.googleapis.com\"\n      ],\n      imgSrc: [\n        \"'self'\",\n        \"data:\",\n        \"https:\", // Google ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒç”¨\n      ],\n      connectSrc: [\"'self'\"],\n      fontSrc: [\n        \"'self'\",\n        \"https://fonts.gstatic.com\"\n      ],\n      objectSrc: [\"'none'\"],\n      mediaSrc: [\"'self'\"],\n      frameSrc: [\"'none'\"],\n      upgradeInsecureRequests: []\n    }\n  },\n  \n  // HTTP Strict Transport Security\n  hsts: {\n    maxAge: 31536000, // 1å¹´\n    includeSubDomains: true,\n    preload: true\n  },\n  \n  // X-Content-Type-Options\n  noSniff: true,\n  \n  // X-Frame-Options\n  frameguard: { action: 'deny' },\n  \n  // X-XSS-Protection\n  xssFilter: true,\n  \n  // Referrer Policy\n  referrerPolicy: {\n    policy: 'strict-origin-when-cross-origin'\n  },\n  \n  // Permissions Policy\n  permittedCrossDomainPolicies: false\n});\n\n// è¿½åŠ ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼\nexport const additionalHeaders = (req: Request, res: Response, next: NextFunction) =\u003e {\n  // Feature Policy / Permissions Policy\n  res.setHeader('Permissions-Policy', \n    'camera=(), microphone=(), geolocation=(), payment=()'\n  );\n  \n  // Serveræƒ…å ±ã®éš è”½\n  res.removeHeader('X-Powered-By');\n  \n  next();\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"5-csrfä¿è­·ã®æ¬ å¦‚-cvss-75\"\u003e5. CSRFä¿è­·ã®æ¬ å¦‚ (CVSS 7.5)\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eå¯¾ç­–å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/middleware/csrf.ts\nimport csrf from 'csurf';\n\n// CSRFä¿è­·ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢\nexport const csrfProtection = csrf({\n  cookie: {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'strict'\n  },\n  ignoreMethods: ['GET', 'HEAD', 'OPTIONS'] // å®‰å…¨ãªãƒ¡ã‚½ãƒƒãƒ‰ã¯é™¤å¤–\n});\n\n// CSRFãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ\nrouter.get('/csrf-token', csrfProtection, (req, res) =\u003e {\n  res.json({ \n    csrfToken: req.csrfToken(),\n    tokenName: '_csrf' // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨\n  });\n});\n\n// ä½¿ç”¨ä¾‹ï¼ˆé‡è¦ãªæ“ä½œã«é©ç”¨ï¼‰\nrouter.post('/api/materials', csrfProtection, authenticateToken, createMaterial);\nrouter.delete('/api/materials/:id', csrfProtection, authenticateToken, deleteMaterial);\nrouter.post('/api/auth/logout', csrfProtection, logout);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"6-ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®æœªå®Ÿè£…-cvss-75\"\u003e6. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®æœªå®Ÿè£… (CVSS 7.5)\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eå¯¾ç­–å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/middleware/rateLimit.ts\nimport rateLimit from 'express-rate-limit';\n\n// ä¸€èˆ¬çš„ãªAPIåˆ¶é™\nexport const generalRateLimit = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15åˆ†\n  max: 100, // æœ€å¤§100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ\n  message: {\n    error: 'ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚15åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'\n  },\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\n// èªè¨¼é–¢é€£ã®å³ã—ã„åˆ¶é™\nexport const authRateLimit = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15åˆ†\n  max: 5, // æœ€å¤§5å›\n  message: {\n    error: 'èªè¨¼è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚15åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'\n  },\n  standardHeaders: true,\n  legacyHeaders: false,\n  // IP + ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã‚­ãƒ¼ã‚’ç”Ÿæˆ\n  keyGenerator: (req) =\u003e {\n    return `${req.ip}:${req.headers['user-agent']}`;\n  }\n});\n\n// ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒå¯¾ç­–\nexport const loginRateLimit = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 3, // 3å›ã¾ã§\n  skipSuccessfulRequests: true, // æˆåŠŸã—ãŸå ´åˆã¯ã‚«ã‚¦ãƒ³ãƒˆã—ãªã„\n  keyGenerator: (req) =\u003e {\n    // IP + ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚­ãƒ¼ã‚’ç”Ÿæˆ\n    return `${req.ip}:${req.body.email || 'unknown'}`;\n  },\n  handler: (req, res) =\u003e {\n    res.status(429).json({\n      error: 'ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸ',\n      retryAfter: Math.round(req.rateLimit.resetTime / 1000)\n    });\n  }\n});\n\n// ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰åˆ¶é™\nexport const uploadRateLimit = rateLimit({\n  windowMs: 60 * 60 * 1000, // 1æ™‚é–“\n  max: 10, // æœ€å¤§10ãƒ•ã‚¡ã‚¤ãƒ«\n  message: {\n    error: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚1æ™‚é–“å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'\n  }\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"owasp-top-10å¯¾ç­–å®Ÿè£…\"\u003eOWASP Top 10å¯¾ç­–å®Ÿè£…\u003c/h2\u003e\n\u003ch3 id=\"a01-broken-access-controlèªå¯åˆ¶å¾¡ã®ä¸å‚™\"\u003eA01: Broken Access Controlï¼ˆèªå¯åˆ¶å¾¡ã®ä¸å‚™ï¼‰\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eå¯¾ç­–å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/middleware/authorization.ts\nexport const requireOwnership = (resourceType: string) =\u003e {\n  return async (req: any, res: Response, next: NextFunction) =\u003e {\n    try {\n      const userId = req.user.id;\n      const resourceId = req.params.id;\n      \n      let isOwner = false;\n      \n      switch (resourceType) {\n        case 'material':\n          const material = await Material.findById(resourceId);\n          isOwner = material \u0026#x26;\u0026#x26; material.user_id === userId;\n          break;\n        case 'comment':\n          const comment = await Comment.findById(resourceId);\n          isOwner = comment \u0026#x26;\u0026#x26; comment.user_id === userId;\n          break;\n      }\n      \n      if (!isOwner) {\n        return res.status(403).json({ error: 'ã“ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“' });\n      }\n      \n      next();\n    } catch (error) {\n      res.status(500).json({ error: 'ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' });\n    }\n  };\n};\n\n// ä½¿ç”¨ä¾‹\nrouter.delete('/api/materials/:id', \n  authenticateToken, \n  requireOwnership('material'), \n  deleteMaterial\n);\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"a02-cryptographic-failuresæš—å·åŒ–ã®ä¸å‚™\"\u003eA02: Cryptographic Failuresï¼ˆæš—å·åŒ–ã®ä¸å‚™ï¼‰\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eå¯¾ç­–å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/utils/encryption.ts\nimport crypto from 'crypto';\nimport bcrypt from 'bcrypt';\n\n// æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–\nexport class DataEncryption {\n  private static readonly algorithm = 'aes-256-gcm';\n  private static readonly keyLength = 32;\n  private static readonly ivLength = 16;\n  private static readonly tagLength = 16;\n  \n  private static getKey(): Buffer {\n    const key = process.env.ENCRYPTION_KEY;\n    if (!key) {\n      throw new Error('æš—å·åŒ–ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');\n    }\n    return crypto.scryptSync(key, 'salt', this.keyLength);\n  }\n  \n  // ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–\n  static encrypt(text: string): string {\n    const iv = crypto.randomBytes(this.ivLength);\n    const cipher = crypto.createCipher(this.algorithm, this.getKey());\n    cipher.setAAD(Buffer.from('additional-data'));\n    \n    let encrypted = cipher.update(text, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    \n    const tag = cipher.getAuthTag();\n    \n    return `${iv.toString('hex')}:${tag.toString('hex')}:${encrypted}`;\n  }\n  \n  // ãƒ‡ãƒ¼ã‚¿å¾©å·åŒ–\n  static decrypt(encryptedData: string): string {\n    const [ivHex, tagHex, encrypted] = encryptedData.split(':');\n    \n    const iv = Buffer.from(ivHex, 'hex');\n    const tag = Buffer.from(tagHex, 'hex');\n    \n    const decipher = crypto.createDecipher(this.algorithm, this.getKey());\n    decipher.setAAD(Buffer.from('additional-data'));\n    decipher.setAuthTag(tag);\n    \n    let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n    decrypted += decipher.final('utf8');\n    \n    return decrypted;\n  }\n}\n\n// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆbcryptï¼‰\nexport class PasswordSecurity {\n  private static readonly saltRounds = 12;\n  \n  static async hash(password: string): Promise\u0026#x3C;string\u003e {\n    return bcrypt.hash(password, this.saltRounds);\n  }\n  \n  static async verify(password: string, hash: string): Promise\u0026#x3C;boolean\u003e {\n    return bcrypt.compare(password, hash);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"a03-injectionã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³\"\u003eA03: Injectionï¼ˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼‰\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eå¯¾ç­–å®Ÿè£…\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/utils/sqlSanitizer.ts\nimport { Pool } from 'pg';\n\nexport class SafeDatabase {\n  constructor(private pool: Pool) {}\n  \n  // å®‰å…¨ãªã‚¯ã‚¨ãƒªå®Ÿè¡Œ\n  async query(text: string, params: any[] = []): Promise\u0026#x3C;any\u003e {\n    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¤œè¨¼\n    this.validateParams(params);\n    \n    try {\n      const result = await this.pool.query(text, params);\n      return result;\n    } catch (error) {\n      // SQLã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’éš è”½\n      console.error('Database error:', error);\n      throw new Error('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');\n    }\n  }\n  \n  private validateParams(params: any[]): void {\n    for (const param of params) {\n      if (typeof param === 'string') {\n        // å±é™ºãªSQLæ–‡å­—ã®æ¤œå‡º\n        const dangerousPatterns = [\n          /(\\b(union|select|insert|update|delete|drop|create|alter|exec|execute)\\b)/i,\n          /(;|--|\\/\\*|\\*\\/)/,\n          /(\\bor\\b.*=.*|1=1|true)/i\n        ];\n        \n        for (const pattern of dangerousPatterns) {\n          if (pattern.test(param)) {\n            throw new Error('ä¸æ­£ãªå…¥åŠ›ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ');\n          }\n        }\n      }\n    }\n  }\n}\n\n// å…¥åŠ›æ¤œè¨¼ã‚¹ã‚­ãƒ¼ãƒ\nimport { z } from 'zod';\n\nexport const inputSchemas = {\n  // æ¤œç´¢ã‚¯ã‚¨ãƒª\n  search: z.object({\n    query: z.string()\n      .max(100, 'æ¤œç´¢ã‚¯ã‚¨ãƒªã¯100æ–‡å­—ä»¥å†…')\n      .regex(/^[a-zA-Z0-9\\s\\-_.!?ã‚-ã‚“\\u4e00-\\u9faf]*$/, 'ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),\n    page: z.number().int().positive().max(1000),\n    limit: z.number().int().positive().max(100)\n  }),\n  \n  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\n  userProfile: z.object({\n    username: z.string()\n      .min(3, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯3æ–‡å­—ä»¥ä¸Š')\n      .max(50, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯50æ–‡å­—ä»¥å†…')\n      .regex(/^[a-zA-Z0-9_-]+$/, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯è‹±æ•°å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã€ãƒã‚¤ãƒ•ãƒ³ã®ã¿'),\n    email: z.string().email('æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),\n    bio: z.string().max(500, 'è‡ªå·±ç´¹ä»‹ã¯500æ–‡å­—ä»¥å†…').optional()\n  }),\n  \n  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\n  fileUpload: z.object({\n    filename: z.string()\n      .max(255, 'ãƒ•ã‚¡ã‚¤ãƒ«åã¯255æ–‡å­—ä»¥å†…')\n      .regex(/^[a-zA-Z0-9._-]+$/, 'ãƒ•ã‚¡ã‚¤ãƒ«åã«ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),\n    size: z.number().positive().max(50 * 1024 * 1024, 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯50MBä»¥å†…')\n  })\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…\"\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…\u003c/h2\u003e\n\u003ch3 id=\"åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š\"\u003eåŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// backend/src/middleware/comprehensiveSecurity.ts\nimport { Request, Response, NextFunction } from 'express';\n\nexport const comprehensiveSecurityHeaders = (req: Request, res: Response, next: NextFunction) =\u003e {\n  // Content Security Policyï¼ˆè©³ç´°è¨­å®šï¼‰\n  const cspDirectives = [\n    \"default-src 'self'\",\n    \"script-src 'self' 'unsafe-inline' https://apis.google.com\",\n    \"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com\",\n    \"img-src 'self' data: https:\",\n    \"font-src 'self' https://fonts.gstatic.com\",\n    \"connect-src 'self'\",\n    \"media-src 'self'\",\n    \"object-src 'none'\",\n    \"child-src 'none'\",\n    \"frame-src 'none'\",\n    \"worker-src 'none'\",\n    \"manifest-src 'self'\",\n    \"base-uri 'self'\",\n    \"form-action 'self'\",\n    \"frame-ancestors 'none'\",\n    \"upgrade-insecure-requests\"\n  ].join('; ');\n  \n  res.setHeader('Content-Security-Policy', cspDirectives);\n  \n  // HTTP Strict Transport Security\n  res.setHeader('Strict-Transport-Security', \n    'max-age=31536000; includeSubDomains; preload');\n  \n  // X-Content-Type-Options\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  \n  // X-Frame-Options\n  res.setHeader('X-Frame-Options', 'DENY');\n  \n  // X-XSS-Protection\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n  \n  // Referrer Policy\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n  \n  // Permissions Policy\n  const permissionsPolicy = [\n    'camera=()',\n    'microphone=()',\n    'geolocation=()',\n    'payment=()',\n    'usb=()',\n    'magnetometer=()',\n    'accelerometer=()',\n    'gyroscope=()'\n  ].join(', ');\n  \n  res.setHeader('Permissions-Policy', permissionsPolicy);\n  \n  // Cross-Origin Policies\n  res.setHeader('Cross-Origin-Embedder-Policy', 'require-corp');\n  res.setHeader('Cross-Origin-Opener-Policy', 'same-origin');\n  res.setHeader('Cross-Origin-Resource-Policy', 'same-site');\n  \n  // Cache Control for sensitive pages\n  if (req.path.includes('/auth') || req.path.includes('/admin')) {\n    res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate, private');\n    res.setHeader('Pragma', 'no-cache');\n    res.setHeader('Expires', '0');\n  }\n  \n  // Serveræƒ…å ±ã®éš è”½\n  res.removeHeader('X-Powered-By');\n  res.removeHeader('Server');\n  \n  next();\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½\"\u003eãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½\u003c/h2\u003e\n\u003ch3 id=\"ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªè¨­è¨ˆ\"\u003eãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªè¨­è¨ˆ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// tests/security/penetration.test.ts\ndescribe('Penetration Testing', () =\u003e {\n  \n  // 1. ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆ\n  describe('Injection Attacks', () =\u003e {\n    it('SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è€æ€§', async () =\u003e {\n      const maliciousInputs = [\n        \"'; DROP TABLE users; --\",\n        \"' OR '1'='1\",\n        \"'; SELECT * FROM users WHERE email = 'admin@example.com'; --\",\n        \"1' UNION SELECT password FROM users--\"\n      ];\n      \n      for (const input of maliciousInputs) {\n        const response = await request(app)\n          .get('/api/search')\n          .query({ q: input });\n        \n        // SQLã‚¨ãƒ©ãƒ¼ãŒéœ²å‡ºã—ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª\n        expect(response.status).not.toBe(500);\n        expect(response.body.error).not.toContain('SQL');\n        expect(response.body.error).not.toContain('database');\n      }\n    });\n    \n    it('NoSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è€æ€§', async () =\u003e {\n      const maliciousInputs = [\n        { $ne: null },\n        { $gt: \"\" },\n        { $regex: \".*\" },\n        { $where: \"return true\" }\n      ];\n      \n      for (const input of maliciousInputs) {\n        const response = await request(app)\n          .post('/api/materials/search')\n          .send({ query: input });\n        \n        expect(response.status).toBe(400);\n        expect(response.body.error).toContain('ä¸æ­£ãªå…¥åŠ›');\n      }\n    });\n  });\n  \n  // 2. èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ\n  describe('Authentication Bypass', () =\u003e {\n    it('JWT ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œè€æ€§', async () =\u003e {\n      const maliciousTokens = [\n        'eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpZCI6IjEiLCJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIn0.',\n        'malformed.token.here',\n        '',\n        'Bearer null',\n        'Bearer undefined'\n      ];\n      \n      for (const token of maliciousTokens) {\n        const response = await request(app)\n          .get('/api/auth/me')\n          .set('Authorization', `Bearer ${token}`);\n        \n        expect(response.status).toBe(401);\n      }\n    });\n    \n    it('æ¨©é™æ˜‡æ ¼æ”»æ’ƒè€æ€§', async () =\u003e {\n      // ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ç®¡ç†è€…æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œ\n      const userToken = await getValidUserToken();\n      \n      const adminEndpoints = [\n        '/api/admin/users',\n        '/api/admin/settings',\n        '/api/admin/logs'\n      ];\n      \n      for (const endpoint of adminEndpoints) {\n        const response = await request(app)\n          .get(endpoint)\n          .set('Authorization', `Bearer ${userToken}`);\n        \n        expect(response.status).toBe(403);\n      }\n    });\n  });\n  \n  // 3. XSSæ”»æ’ƒãƒ†ã‚¹ãƒˆ\n  describe('Cross-Site Scripting (XSS)', () =\u003e {\n    it('Stored XSSè€æ€§', async () =\u003e {\n      const xssPayloads = [\n        '\u0026#x3C;script\u003ealert(\"XSS\")\u0026#x3C;/script\u003e',\n        '\u0026#x3C;img src=\"x\" onerror=\"alert(\\'XSS\\')\"\u003e',\n        'javascript:alert(\"XSS\")',\n        '\u0026#x3C;svg/onload=alert(\"XSS\")\u003e'\n      ];\n      \n      for (const payload of xssPayloads) {\n        const response = await request(app)\n          .post('/api/materials')\n          .send({ title: payload, description: 'Test' });\n        \n        // XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª\n        const material = await getMaterial(response.body.id);\n        expect(material.title).not.toContain('\u0026#x3C;script\u003e');\n        expect(material.title).not.toContain('javascript:');\n      }\n    });\n  });\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–\"\u003eä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–\u003c/h2\u003e\n\u003ch3 id=\"è‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ\"\u003eè‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// scripts/security-scan.ts\nimport { execSync } from 'child_process';\n\nexport class SecurityScanner {\n  \n  // ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³\n  static async scanDependencies(): Promise\u0026#x3C;void\u003e {\n    console.log('ğŸ” ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³é–‹å§‹...');\n    \n    try {\n      execSync('npm audit --audit-level high', { stdio: 'inherit' });\n      console.log('âœ… ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†');\n    } catch (error) {\n      console.error('âŒ é«˜ãƒªã‚¹ã‚¯ä»¥ä¸Šã®è„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸ');\n      throw error;\n    }\n  }\n  \n  // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯\n  static async checkSecurityHeaders(url: string): Promise\u0026#x3C;void\u003e {\n    console.log('ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯é–‹å§‹...');\n    \n    const requiredHeaders = [\n      'Strict-Transport-Security',\n      'X-Content-Type-Options',\n      'X-Frame-Options',\n      'X-XSS-Protection',\n      'Content-Security-Policy',\n      'Referrer-Policy'\n    ];\n    \n    try {\n      const response = await fetch(url);\n      \n      for (const header of requiredHeaders) {\n        if (!response.headers.get(header)) {\n          throw new Error(`å¿…é ˆãƒ˜ãƒƒãƒ€ãƒ¼ ${header} ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“`);\n        }\n      }\n      \n      console.log('âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯å®Œäº†');\n    } catch (error) {\n      console.error('âŒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å•é¡Œ:', error.message);\n      throw error;\n    }\n  }\n  \n  // HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯\n  static async checkHTTPS(url: string): Promise\u0026#x3C;void\u003e {\n    console.log('ğŸ” HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯é–‹å§‹...');\n    \n    try {\n      const httpsUrl = url.replace('http://', 'https://');\n      const response = await fetch(httpsUrl);\n      \n      if (!response.ok) {\n        throw new Error('HTTPSæ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ');\n      }\n      \n      // HSTSç¢ºèª\n      const hstsHeader = response.headers.get('Strict-Transport-Security');\n      if (!hstsHeader || !hstsHeader.includes('max-age')) {\n        throw new Error('HSTSè¨­å®šãŒä¸é©åˆ‡ã§ã™');\n      }\n      \n      console.log('âœ… HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯å®Œäº†');\n    } catch (error) {\n      console.error('âŒ HTTPSè¨­å®šã®å•é¡Œ:', error.message);\n      throw error;\n    }\n  }\n}\n\n// CI/CDã§ã®å®Ÿè¡Œ\nasync function runSecurityChecks(): Promise\u0026#x3C;void\u003e {\n  try {\n    await SecurityScanner.scanDependencies();\n    await SecurityScanner.checkSecurityHeaders('https://example.com');\n    await SecurityScanner.checkHTTPS('https://example.com');\n    \n    console.log('ğŸ‰ ã™ã¹ã¦ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ');\n  } catch (error) {\n    console.error('ğŸ’¥ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãŒå¤±æ•—ã—ã¾ã—ãŸ');\n    process.exit(1);\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰\"\u003eç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰\u003c/h2\u003e\n\u003ch3 id=\"github-actions-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼\"\u003eGitHub Actions ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-yaml\"\u003e# .github/workflows/security.yml\nname: Security Scan\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main ]\n  schedule:\n    # æ¯æ—¥åˆå‰3æ™‚ã«å®Ÿè¡Œ\n    - cron: '0 3 * * *'\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    \n    steps:\n    - uses: actions/checkout@v4\n    \n    - name: Setup Node.js\n      uses: actions/setup-node@v4\n      with:\n        node-version: '18'\n        cache: 'npm'\n    \n    - name: Install dependencies\n      run: npm ci\n    \n    # ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³\n    - name: Run npm audit\n      run: |\n        npm audit --audit-level high\n        npm audit --json \u003e audit-report.json\n    \n    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ\n    - name: Run security tests\n      run: npm run test:security\n    \n    # CodeQL åˆ†æ\n    - name: Initialize CodeQL\n      uses: github/codeql-action/init@v2\n      with:\n        languages: typescript, javascript\n    \n    - name: Perform CodeQL Analysis\n      uses: github/codeql-action/analyze@v2\n    \n    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ\n    - name: Generate security report\n      run: node scripts/generate-security-report.js\n    \n    # è„†å¼±æ€§ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã®é€šçŸ¥\n    - name: Notify security team\n      if: failure()\n      uses: 8398a7/action-slack@v3\n      with:\n        status: failure\n        text: 'ğŸš¨ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã§å•é¡ŒãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸ'\n      env:\n        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}\n    \n    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã—ã¦ä¿å­˜\n    - name: Upload security report\n      uses: actions/upload-artifact@v3\n      if: always()\n      with:\n        name: security-report\n        path: |\n          audit-report.json\n          security-report.html\n        retention-days: 30\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ã¾ã¨ã‚\"\u003eã¾ã¨ã‚\u003c/h2\u003e\n\u003cp\u003eã“ã®è¨˜äº‹ã§ã¯ã€å®Ÿéš›ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨å¯¾ç­–å®Ÿè£…ã‚’è©³ç´°ã«è§£èª¬ã—ã¾ã—ãŸã€‚\u003c/p\u003e\n\u003ch3 id=\"-é”æˆã§ããŸã“ã¨\"\u003eğŸ¯ é”æˆã§ããŸã“ã¨\u003c/h3\u003e\n\u003ch4 id=\"è„†å¼±æ€§å¯¾ç­–\"\u003eè„†å¼±æ€§å¯¾ç­–\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e38ä»¶ã®è„†å¼±æ€§\u003c/strong\u003eã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ï¼ˆé‡å¤§8ä»¶ã€é«˜12ä»¶ã€ä¸­15ä»¶ã€ä½3ä»¶ï¼‰\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOWASP Top 10\u003c/strong\u003eã¸ã®åŒ…æ‹¬çš„å¯¾å¿œ\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eã‚¼ãƒ­é‡å¤§è„†å¼±æ€§\u003c/strong\u003eã‚’é”æˆ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºç›¤\"\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºç›¤\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eå¤šå±¤é˜²å¾¡\u003c/strong\u003eã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ§‹ç¯‰\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eè‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ\u003c/strong\u003eã®å°å…¥\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç¶™ç¶šçš„ç›£è¦–\u003c/strong\u003eã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"é‹ç”¨ä½“åˆ¶\"\u003eé‹ç”¨ä½“åˆ¶\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰\u003c/strong\u003eã«ã‚ˆã‚‹å¯è¦–åŒ–\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ\u003c/strong\u003eãƒ—ãƒ­ã‚»ã‚¹ã®ç¢ºç«‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eãƒãƒ¼ãƒ å…¨ä½“\u003c/strong\u003eã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ„è­˜å‘ä¸Š\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"-å®Ÿæ–½åŠ¹æœ\"\u003eğŸ“ˆ å®Ÿæ–½åŠ¹æœ\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ™ãƒ«\u003c/strong\u003e: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã«å‘ä¸Š\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eé–‹ç™ºåŠ¹ç‡\u003c/strong\u003e: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèªä½œæ¥­70%å‰Šæ¸›\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eé‹ç”¨å“è³ª\u003c/strong\u003e: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ0ä»¶ç¶­æŒ\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹\u003c/strong\u003e: OWASPæº–æ‹ ã«ã‚ˆã‚Šç›£æŸ»å¯¾å¿œæº–å‚™å®Œäº†\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"ï¸-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦\"\u003eğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-markdown\"\u003e## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦ãƒ¬ãƒ™ãƒ«\nãƒ¬ãƒ™ãƒ«1ï¼ˆåå¿œçš„ï¼‰: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿå¾Œã«å¯¾å¿œ\nãƒ¬ãƒ™ãƒ«2ï¼ˆç®¡ç†çš„ï¼‰: å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯\nãƒ¬ãƒ™ãƒ«3ï¼ˆå®šç¾©çš„ï¼‰: æ¨™æº–åŒ–ã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ­ã‚»ã‚¹\nãƒ¬ãƒ™ãƒ«4ï¼ˆå®šé‡çš„ï¼‰: ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†\nãƒ¬ãƒ™ãƒ«5ï¼ˆæœ€é©åŒ–ï¼‰: ç¶™ç¶šçš„æ”¹å–„ã¨ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³\n\nâ†’ ç¾åœ¨ãƒ¬ãƒ™ãƒ«4ã‚’é”æˆã€ãƒ¬ãƒ™ãƒ«5ã«å‘ã‘ã¦æ”¹å–„ç¶™ç¶šä¸­\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"-ä»Šå¾Œã®å±•é–‹\"\u003eğŸš€ ä»Šå¾Œã®å±•é–‹\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eAIã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£\u003c/strong\u003e: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥ã®å°å…¥\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆ\u003c/strong\u003e: ã‚ˆã‚Šé«˜åº¦ãªèªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ \u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚¤ãƒ‡ã‚¶ã‚¤ãƒ³\u003c/strong\u003e: è¨­è¨ˆæ®µéšã‹ã‚‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ„ã¿è¾¼ã¿\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå›½éš›èªè¨¼\u003c/strong\u003e: ISO27001ã€SOC2ç­‰ã®å–å¾—æ¤œè¨\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯ä¸€åº¦ã§å®Œç’§ã«ã§ãã‚‹ã‚‚ã®ã§ã¯ãªãã€ç¶™ç¶šçš„ãªæ”¹å–„ãŒé‡è¦ã§ã™ã€‚\u003c/p\u003e\n\u003ch2 id=\"å‚è€ƒãƒªãƒ³ã‚¯\"\u003eå‚è€ƒãƒªãƒ³ã‚¯\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://owasp.org/www-project-top-ten/\"\u003eOWASP Top 10\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.nist.gov/cyberframework\"\u003eNIST Cybersecurity Framework\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://cwe.mitre.org/\"\u003eCWE Common Weakness Enumeration\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.first.org/cvss/calculator/3.1\"\u003eCVSS Calculator\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://securityheaders.com/\"\u003eSecurity Headers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://infosec.mozilla.org/guidelines/web_security\"\u003eMozilla Security Guidelines\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eã“ã®è¨˜äº‹ã¯å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ŒDrill Layerã€ã§ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»çµŒé¨“ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¾ã—ãŸã€‚\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eåˆå¿ƒè€…ã®æ–¹ã¸ï¼šã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯æ®µéšçš„ã«å­¦ç¿’ãƒ»å®Ÿè£…ã—ã¦ã„ãã“ã¨ãŒé‡è¦ã§ã™ã€‚ã¾ãšã¯åŸºæœ¬çš„ãªå¯¾ç­–ã‹ã‚‰å§‹ã‚ã¦ã€å¾ã€…ã«é«˜åº¦ãªå¯¾ç­–ã‚’å–ã‚Šå…¥ã‚Œã¦ã„ãã¾ã—ã‚‡ã†ã€‚\u003c/em\u003e\u003c/p\u003e"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto py-10 px-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-green-600\",\"children\":[\"#\",38]}],\" \",\"Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ï¼šOWASP Top 10æº–æ‹ ã®å®Ÿè·µçš„è„†å¼±æ€§å¯¾ç­–\"]}],[\"$\",\"ul\",null,{\"className\":\"list-none border-b border-gray-600 pb-4 mb-6\",\"children\":[[\"$\",\"li\",null,{\"className\":\"text-gray-500 text-sm\",\"children\":[\"ä½œæˆæ—¥æ™‚: \",\"2025-08-16 00:24\"]}],\"$undefined\",[\"$\",\"li\",null,{\"className\":\"flex flex-wrap gap-2 mt-2\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»\"}],[\"$\",\"span\",\"1\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"OWASP\"}],[\"$\",\"span\",\"2\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"è„†å¼±æ€§å¯¾ç­–\"}],[\"$\",\"span\",\"3\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ\"}],[\"$\",\"span\",\"4\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼\"}]]}]]}],[\"$\",\"nav\",null,{\"className\":\"mb-6 pb-4 border-b border-gray-700 flex justify-between\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"â† ãƒ›ãƒ¼ãƒ ã¸\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"è¨˜äº‹ä¸€è¦§ã¸ â†’\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose dark:prose-invert\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}],[\"$\",\"$L14\",null,{}],[\"$\",\"nav\",null,{\"className\":\"mt-8 pt-4 border-t border-gray-700 flex justify-between\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"â† ãƒ›ãƒ¼ãƒ ã¸\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"è¨˜äº‹ä¸€è¦§ã¸ â†’\"}]]}],[\"$\",\"$L15\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Maita Tomoya Dev IO\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"ç±³ç”°æ™ºå“‰ã®æŠ€è¡“ãƒ–ãƒ­ã‚°ã€‚ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ãŸã“ã¨ã‚’ãƒ¡ãƒ¢ã—ã¾ã™ã€‚\"}]],\"error\":null,\"digest\":\"$undefined\"}\nb:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>