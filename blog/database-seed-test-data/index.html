<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/19bdf9af4d1ae4d4.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-aa7deb192a774533.js"/><script src="/_next/static/chunks/4bd1b696-bc089769d60af88b.js" async=""></script><script src="/_next/static/chunks/1684-b369840b16e4c44b.js" async=""></script><script src="/_next/static/chunks/main-app-2ed07751e45c2a2f.js" async=""></script><script src="/_next/static/chunks/6874-6c1ddde525f3893c.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js" async=""></script><meta name="next-size-adjust" content=""/><link rel="icon" href="/favicon.png" type="image/png"/><title>Maita Tomoya Dev IO</title><meta name="description" content="ç±³ç”°æ™ºå“‰ã®æŠ€è¡“ãƒ–ãƒ­ã‚°ã€‚ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ãŸã“ã¨ã‚’ãƒ¡ãƒ¢ã—ã¾ã™ã€‚"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_5cfdac __variable_9a8899 antialiased"><div class="max-w-2xl mx-auto py-10 px-4"><h1 class="text-3xl font-bold mb-2"><span class="text-green-600">#<!-- -->36</span> <!-- -->ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ - npm run seed:testã®ä»•çµ„ã¿ã¨å®Ÿè£…</h1><ul class="list-none border-b border-gray-600 pb-4 mb-6"><li class="text-gray-500 text-sm">ä½œæˆæ—¥æ™‚: <!-- -->2025-08-15 10:59</li><li class="flex flex-wrap gap-2 mt-2"><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Database</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">Node.js</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">PostgreSQL</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">seed</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">test-data</span><span class="px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs">TypeScript</span></li></ul><nav class="mb-6 pb-4 border-b border-gray-700 flex justify-between"><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/">â† ãƒ›ãƒ¼ãƒ ã¸</a><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/blog/">è¨˜äº‹ä¸€è¦§ã¸ â†’</a></nav><article class="prose dark:prose-invert"><p>é–‹ç™ºä¸­ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€Œãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼ã€ã¨ã„ã†å•é¡Œã«é­é‡ã—ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿä»Šå›ã¯ã€æ•™æå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€ŒDrill Layerã€ã®é–‹ç™ºä¸­ã«ç™ºç”Ÿã—ãŸ<strong>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±å•é¡Œ</strong>ã¨ã€ãã®è§£æ±ºæ–¹æ³•ã§ã‚ã‚‹<code>npm run seed:test</code>ã‚³ãƒãƒ³ãƒ‰ã®ä»•çµ„ã¿ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚</p>
<h2 id="-åˆå¿ƒè€…å‘ã‘è§£èª¬">ğŸ’¡ åˆå¿ƒè€…å‘ã‘è§£èª¬</h2>
<h3 id="seedã‚·ãƒ¼ãƒ‰ã¨ã¯">seedï¼ˆã‚·ãƒ¼ãƒ‰ï¼‰ã¨ã¯ï¼Ÿ</h3>
<p><strong>ç°¡å˜ã«è¨€ã†ã¨</strong>: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚„ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã™ã‚‹å‡¦ç†ã®ã“ã¨ã§ã™ã€‚</p>
<pre><code>è¾²æ¥­ã§ç¨®ï¼ˆseedï¼‰ã‚’ã¾ãã‚ˆã†ã«ã€
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºç¤ã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã€Œã¾ãã€å‡¦ç†
</code></pre>
<h3 id="ãªãœå¿…è¦">ãªãœå¿…è¦ï¼Ÿ</h3>
<pre><code>å®Ÿéš›ã®é–‹ç™ºç¾å ´ã§ã‚ˆãã‚ã‚‹å•é¡Œï¼š
ãƒ»ã€Œæ˜¨æ—¥ã¾ã§è¡¨ç¤ºã•ã‚Œã¦ã„ãŸãƒ‡ãƒ¼ã‚¿ãŒãªã„ï¼ã€
ãƒ»ã€Œæ–°ã—ã„æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„ã‘ã©ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã€
ãƒ»ã€Œãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿ã§é–‹ç™ºã—ãŸã„ã€

â†’ seedã‚³ãƒãƒ³ãƒ‰ã§ä¸€ç™ºè§£æ±ºï¼
</code></pre>
<h2 id="-ç›®æ¬¡">ğŸ“š ç›®æ¬¡</h2>
<ul>
<li><a href="#%E5%95%8F%E9%A1%8C%E3%81%AE%E7%99%BA%E7%94%9F%E3%81%A8%E3%82%B7%E3%83%BC%E3%83%89%E3%81%AE%E5%BF%85%E8%A6%81%E6%80%A7">å•é¡Œã®ç™ºç”Ÿã¨ã‚·ãƒ¼ãƒ‰ã®å¿…è¦æ€§</a></li>
<li><a href="#npm-run-seedtest%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF">npm run seed:testã®ä»•çµ„ã¿</a></li>
<li><a href="#%E5%AE%9F%E8%A3%85%E3%81%AE%E8%A9%B3%E7%B4%B0%E3%81%A8%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC">å®Ÿè£…ã®è©³ç´°ã¨ã‚³ãƒ¼ãƒ‰è§£èª¬</a></li>
<li><a href="#postgresql%E9%85%8D%E5%88%97%E3%81%AE%E6%89%B1%E3%81%84%E6%96%B9">PostgreSQLé…åˆ—ã®æ‰±ã„æ–¹</a></li>
<li><a href="#%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a></li>
<li><a href="#%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9">ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</a></li>
<li><a href="#%E3%81%BE%E3%81%A8%E3%82%81">ã¾ã¨ã‚</a></li>
</ul>
<h2 id="å•é¡Œã®ç™ºç”Ÿã¨ã‚·ãƒ¼ãƒ‰ã®å¿…è¦æ€§">å•é¡Œã®ç™ºç”Ÿã¨ã‚·ãƒ¼ãƒ‰ã®å¿…è¦æ€§</h2>
<h3 id="ç™ºç”Ÿã—ãŸå•é¡Œ">ç™ºç”Ÿã—ãŸå•é¡Œ</h3>
<p>é–‹ç™ºä¸­ã€ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ³ã«é­é‡ã—ã¾ã—ãŸï¼š</p>
<pre><code class="language-bash"># APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã‚‹ã¨...
$ curl -s http://localhost:3000/api/materials | jq '. | length'
3  # ã‚ã‚Œï¼Ÿ10ä»¶ã‚ã£ãŸã¯ãšã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒ3ä»¶ã—ã‹ãªã„ï¼
</code></pre>
<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã€Œã•ãã»ã©ã¾ã§ã¯è¡¨ç¤ºã•ã‚Œã¦ã„ãŸãŒä»Šã¯è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã€ã¨ã„ã†å ±å‘ŠãŒã‚ã‚Šã€èª¿æŸ»ã—ãŸã¨ã“ã‚ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒä½•ã‚‰ã‹ã®ç†ç”±ã§å‰Šé™¤ã•ã‚Œã¦ã„ãŸã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚</p>
<h3 id="ã‚·ãƒ¼ãƒ‰ãŒå¿…è¦ãªç†ç”±">ã‚·ãƒ¼ãƒ‰ãŒå¿…è¦ãªç†ç”±</h3>
<ol>
<li><strong>é–‹ç™ºç’°å¢ƒã®çµ±ä¸€</strong>: ãƒãƒ¼ãƒ å…¨å“¡ãŒåŒã˜ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§é–‹ç™ºã§ãã‚‹</li>
<li><strong>å‹•ä½œç¢ºèªã®åŠ¹ç‡åŒ–</strong>: UIã®è¦‹ãŸç›®ã‚„æ©Ÿèƒ½ã‚’ç´ æ—©ãç¢ºèªã§ãã‚‹</li>
<li><strong>ãƒ†ã‚¹ãƒˆã®å†ç¾æ€§</strong>: åŒã˜æ¡ä»¶ã§ãƒ†ã‚¹ãƒˆã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã§ãã‚‹</li>
<li><strong>ãƒ‡ãƒ¢ç’°å¢ƒã®æ§‹ç¯‰</strong>: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒ—ãƒ¬ã‚¼ãƒ³ç”¨ãƒ‡ãƒ¼ã‚¿ã‚’ç°¡å˜ã«ç”¨æ„</li>
</ol>
<h2 id="npm-run-seedtestã®ä»•çµ„ã¿">npm run seed:testã®ä»•çµ„ã¿</h2>
<h3 id="å…¨ä½“ã®æµã‚Œ">å…¨ä½“ã®æµã‚Œ</h3>
<div class="mermaid">graph TD
    A[npm run seed:test] --&gt; B[pnpm --filter @drill-layer/backend seed:test]
    B --&gt; C[ts-node runTestSeeds.ts]
    C --&gt; D[ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª]
    D --&gt; E[æ—¢å­˜ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿å‰Šé™¤]
    E --&gt; F[æ–°è¦ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŒ¿å…¥]
    F --&gt; G[å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º]</div>
<h3 id="1-packagejsonã®è¨­å®š">1. package.jsonã®è¨­å®š</h3>
<pre><code class="language-json">{
  "scripts": {
    "seed:test": "pnpm --filter @drill-layer/backend seed:test"
  }
}
</code></pre>
<p>ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®<code>package.json</code>ã«å®šç¾©ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã¯ã€monorepoæ§‹æˆã§ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<h3 id="2-ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ">2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>
<pre><code class="language-json">// packages/backend/package.json
{
  "scripts": {
    "seed:test": "ts-node src/infrastructure/db/seeds/runTestSeeds.ts"
  }
}
</code></pre>
<p>TypeScriptã§æ›¸ã‹ã‚ŒãŸã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç›´æ¥å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<h2 id="å®Ÿè£…ã®è©³ç´°ã¨ã‚³ãƒ¼ãƒ‰è§£èª¬">å®Ÿè£…ã®è©³ç´°ã¨ã‚³ãƒ¼ãƒ‰è§£èª¬</h2>
<h3 id="ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ã®ç®¡ç†">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ã®ç®¡ç†</h3>
<p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ¥ç¶šæƒ…å ±ï¼ˆãƒ›ã‚¹ãƒˆåã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ï¼‰ã‚’ã‚³ãƒ¼ãƒ‰ã«ç›´æ¥æ›¸ãè¾¼ã‚€ã®ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šå±é™ºã§ã™ã€‚<code>.env</code>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã£ã¦ç®¡ç†ã—ã€<code>dotenv</code>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§èª­ã¿è¾¼ã‚€ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚</p>
<pre><code class="language-bash"># .env ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾‹ï¼ˆã“ã‚Œã¯ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚å®Ÿéš›ã®å€¤ã«ç½®ãæ›ãˆã¦ãã ã•ã„ï¼‰
DATABASE_URL="postgresql://your_username:your_password@localhost:5432/your_database_name"

# å…·ä½“çš„ãªä¾‹ï¼š
# DATABASE_URL="postgresql://johndoe:secretpass123@localhost:5432/myapp_dev"
#                          â†‘ãƒ¦ãƒ¼ã‚¶ãƒ¼å â†‘ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰     â†‘ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å
# â€» ã“ã‚Œã‚‰ã¯ã™ã¹ã¦ã‚µãƒ³ãƒ—ãƒ«å€¤ã§ã™
</code></pre>
<p>âš ï¸ <strong>é‡è¦</strong>: ä¸Šè¨˜ã¯exampleã§ã™ã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯è‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ãŸå€¤ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚</p>
<pre><code class="language-typescript">// connection.ts
import { Pool } from 'pg';
import * as dotenv from 'dotenv';

dotenv.config(); // .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€

export const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
});
</code></pre>
<h3 id="ãƒ¡ã‚¤ãƒ³ã®ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«">ãƒ¡ã‚¤ãƒ³ã®ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«</h3>
<pre><code class="language-typescript">// runTestSeeds.ts
import seedTestMaterials from './seedTestMaterials';
import { pool } from '../connection';

const runTestSeeds = async () => {
  try {
    console.log('ğŸš€ ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ã®å®Ÿè¡Œã‚’é–‹å§‹ã—ã¾ã™...');
    
    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ
    await pool.query('SELECT NOW()');
    console.log('âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã—ãŸ');

    // ãƒ†ã‚¹ãƒˆæ•™æãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
    await seedTestMaterials();

    console.log('ğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
    
  } catch (error) {
    console.error('âŒ ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    process.exit(1);
  } finally {
    await pool.end();  // æ¥ç¶šãƒ—ãƒ¼ãƒ«ã‚’é–‰ã˜ã‚‹
  }
};

runTestSeeds();
</code></pre>
<h3 id="ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å®šç¾©ã¨æŒ¿å…¥">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å®šç¾©ã¨æŒ¿å…¥</h3>
<pre><code class="language-typescript">// seedTestMaterials.ts
const testMaterials = [
  {
    title: 'JavaScriptåŸºç¤å…¥é–€',
    description: 'JavaScriptã®åŸºæœ¬çš„ãªæ–‡æ³•ã¨æ¦‚å¿µã«ã¤ã„ã¦è§£èª¬ã—ãŸæ•™æã§ã™ã€‚',
    file_key: 'test-materials/javascript-basics.pdf',
    file_type: 'pdf',
    file_size: 2048576,  // 2MB
    tags: ['JavaScript', 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', 'åˆå¿ƒè€…'],
    likes: 15,
    downloads: 42
  },
  {
    title: 'React Component è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³',
    description: 'Reacté–‹ç™ºã«ãŠã‘ã‚‹å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆæ‰‹æ³•ã‚’è§£èª¬ã€‚',
    file_key: 'test-materials/react-components.pdf',
    file_type: 'pdf',
    file_size: 3145728,  // 3MB
    tags: ['React', 'TypeScript', 'ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ'],
    likes: 28,
    downloads: 67
  },
  // ... ä»–ã®æ•™æãƒ‡ãƒ¼ã‚¿
];

const seedTestMaterials = async () => {
  console.log('ğŸŒ± ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã‚’é–‹å§‹ã—ã¾ã™...');
  
  // æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆå†ªç­‰æ€§ã®ç¢ºä¿ï¼‰
  await pool.query(`
    DELETE FROM materials 
    WHERE file_key LIKE 'test-materials/%'
  `);
  
  let createdCount = 0;
  
  for (const material of testMaterials) {
    const result = await pool.query(
      `INSERT INTO materials (
        title, description, file_key, file_type, 
        file_size, tags, likes, downloads, 
        created_at, updated_at
      ) VALUES ($1, $2, $3, $4, $5, $6::text[], $7, $8, NOW(), NOW())
      RETURNING id`,
      [
        material.title,
        material.description,
        material.file_key,
        material.file_type,
        material.file_size,
        material.tags,  // PostgreSQLé…åˆ—ã¨ã—ã¦ç›´æ¥æ¸¡ã™
        material.likes,
        material.downloads
      ]
    );
    
    console.log(`âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: ${material.title} (ID: ${result.rows[0].id})`);
    createdCount++;
  }
  
  console.log(`ğŸ“Š åˆè¨ˆ ${createdCount} ä»¶ã®æ•™æãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ`);
};
</code></pre>
<h2 id="postgresqlé…åˆ—ã®æ‰±ã„æ–¹">PostgreSQLé…åˆ—ã®æ‰±ã„æ–¹</h2>
<h3 id="é‡è¦ãªãƒã‚¤ãƒ³ãƒˆpostgresqlé…åˆ—ã®å‹ã‚­ãƒ£ã‚¹ãƒˆ">é‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼šPostgreSQLé…åˆ—ã®å‹ã‚­ãƒ£ã‚¹ãƒˆ</h3>
<pre><code class="language-typescript">// âŒ é–“é•ã„ï¼šJSONæ–‡å­—åˆ—ã¨ã—ã¦æ¸¡ã™
JSON.stringify(material.tags)

// âœ… æ­£è§£ï¼šé…åˆ—ã¨ã—ã¦ç›´æ¥æ¸¡ã™ + å‹ã‚­ãƒ£ã‚¹ãƒˆ
material.tags  // $6::text[] ã§PostgreSQLé…åˆ—ã«ã‚­ãƒ£ã‚¹ãƒˆ
</code></pre>
<h3 id="é…åˆ—æ“ä½œã®è©³ç´°">é…åˆ—æ“ä½œã®è©³ç´°</h3>
<pre><code class="language-sql">-- PostgreSQLå´ã§ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
CREATE TABLE materials (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title VARCHAR(255) NOT NULL,
  tags TEXT[] NOT NULL,  -- é…åˆ—å‹
  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- é…åˆ—ã§ã®æ¤œç´¢ä¾‹
SELECT * FROM materials WHERE 'JavaScript' = ANY(tags);
SELECT * FROM materials WHERE tags &#x26;&#x26; ARRAY['React', 'TypeScript'];
</code></pre>
<h3 id="nodejså´ã§ã®é…åˆ—æ“ä½œ">Node.jså´ã§ã®é…åˆ—æ“ä½œ</h3>
<pre><code class="language-typescript">// é…åˆ—ãƒ‡ãƒ¼ã‚¿ã®å®‰å…¨ãªæŒ¿å…¥
const insertMaterial = async (materialData: any) => {
  // é…åˆ—ã®æ¤œè¨¼
  if (!Array.isArray(materialData.tags)) {
    throw new Error('tagsã¯é…åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™');
  }
  
  // é…åˆ—è¦ç´ ã®æ¤œè¨¼
  const validatedTags = materialData.tags
    .filter(tag => typeof tag === 'string' &#x26;&#x26; tag.trim().length > 0)
    .slice(0, 10); // æœ€å¤§10å€‹ã¾ã§
  
  const result = await pool.query(
    'INSERT INTO materials (title, tags) VALUES ($1, $2::text[]) RETURNING id',
    [materialData.title, validatedTags]
  );
  
  return result.rows[0];
};
</code></pre>
<h2 id="ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>
<h3 id="ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•">ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•</h3>
<h4 id="1-ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„">1. ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„</h4>
<p><strong>è¨ºæ–­ã‚³ãƒãƒ³ãƒ‰</strong>:</p>
<pre><code class="language-bash"># ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã‚’ç¢ºèª
curl -s http://localhost:3000/api/materials | jq '. | length'

# ç›´æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç¢ºèª
psql -d drill_layer_dev -c "SELECT COUNT(*) FROM materials;"
</code></pre>
<p><strong>è§£æ±ºæ³•</strong>:</p>
<pre><code class="language-bash"># 0ä»¶ã®å ´åˆã¯ã‚·ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
npm run seed:test
</code></pre>
<h4 id="2-cannot-read-properties-of-null-ã‚¨ãƒ©ãƒ¼">2. "Cannot read properties of null" ã‚¨ãƒ©ãƒ¼</h4>
<p><strong>åŸå› </strong>: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ãƒ‡ãƒ¼ã‚¿ãŒç©ºã®çŠ¶æ…‹ã‚’æƒ³å®šã—ã¦ã„ãªã„</p>
<p><strong>è§£æ±ºæ³•</strong>:</p>
<pre><code class="language-javascript">// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰
const materials = data.materials.map(material => ...)

// âœ… å®‰å…¨ãªã‚³ãƒ¼ãƒ‰
const [materials, setMaterials] = useState&#x3C;Material[]>([]);
const materialsList = data?.materials || [];
</code></pre>
<h4 id="3-postgresqlé…åˆ—ã‚¨ãƒ©ãƒ¼">3. PostgreSQLé…åˆ—ã‚¨ãƒ©ãƒ¼</h4>
<p><strong>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</strong>:</p>
<pre><code>error: malformed array literal
</code></pre>
<p><strong>è§£æ±ºæ³•</strong>:</p>
<pre><code class="language-typescript">// âŒ é–“é•ã„
material.tags = JSON.stringify(['tag1', 'tag2']);

// âœ… æ­£è§£
material.tags = ['tag1', 'tag2'];  // é…åˆ—ã®ã¾ã¾æ¸¡ã™
// SQL: $1::text[] ã§å‹ã‚­ãƒ£ã‚¹ãƒˆ
</code></pre>
<h4 id="4-æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®ãƒªãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼">4. æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®ãƒªãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼</h4>
<p><strong>è§£æ±ºæ³•</strong>:</p>
<pre><code class="language-typescript">const runTestSeeds = async () => {
  try {
    // ã‚·ãƒ¼ãƒ‰å‡¦ç†
  } catch (error) {
    console.error(error);
    process.exit(1);
  } finally {
    await pool.end();  // å¿…ãšæ¥ç¶šã‚’é–‰ã˜ã‚‹
  }
};
</code></pre>
<h2 id="ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹">ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h2>
<h3 id="1-å†ªç­‰æ€§idempotencyã®ç¢ºä¿">1. å†ªç­‰æ€§ï¼ˆIdempotencyï¼‰ã®ç¢ºä¿</h3>
<p>ã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä½•åº¦å®Ÿè¡Œã—ã¦ã‚‚åŒã˜çµæœã«ãªã‚‹ã‚ˆã†è¨­è¨ˆï¼š</p>
<pre><code class="language-sql">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰æ–°è¦æŒ¿å…¥
DELETE FROM materials WHERE file_key LIKE 'test-materials/%'
</code></pre>
<h3 id="2-ç’°å¢ƒã”ã¨ã®ã‚·ãƒ¼ãƒ‰åˆ†é›¢">2. ç’°å¢ƒã”ã¨ã®ã‚·ãƒ¼ãƒ‰åˆ†é›¢</h3>
<pre><code class="language-javascript">// é–‹ç™ºç’°å¢ƒç”¨
npm run seed:dev

// ãƒ†ã‚¹ãƒˆç’°å¢ƒç”¨
npm run seed:test

// ãƒ‡ãƒ¢ç’°å¢ƒç”¨
npm run seed:demo
</code></pre>
<h3 id="3-ãƒ‡ãƒ¼ã‚¿ã®ç¾å®Ÿæ€§">3. ãƒ‡ãƒ¼ã‚¿ã®ç¾å®Ÿæ€§</h3>
<pre><code class="language-typescript">// ç¾å®Ÿçš„ãªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
const testMaterials = [
  {
    title: 'JavaScriptåŸºç¤å…¥é–€',
    // å®Ÿéš›ã«ã‚ã‚Šãã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º
    file_size: 2048576,  // 2MB
    // å®Ÿéš›ã«ã‚ã‚Šãã†ãªã‚¿ã‚°
    tags: ['JavaScript', 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', 'åˆå¿ƒè€…'],
    // ç¾å®Ÿçš„ãªæ•°å€¤
    likes: Math.floor(Math.random() * 50) + 1,
    downloads: Math.floor(Math.random() * 100) + 1
  }
];
</code></pre>
<p><strong>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ´»ç”¨</strong>:
<a href="https://fakerjs.dev/">Faker.js</a>ã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å°å…¥ã™ã‚‹ã¨ã€åå‰ã€ä½æ‰€ã€æ–‡ç« ã€æ—¥ä»˜ãªã©ã€ã‚ˆã‚Šç¾å®Ÿã«è¿‘ã„å¤šæ§˜ãªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ç°¡å˜ã«ç”Ÿæˆã§ãã€ãƒ†ã‚¹ãƒˆã®è³ªã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<pre><code class="language-typescript">import { faker } from '@faker-js/faker';

const generateTestMaterials = (count: number) => {
  return Array.from({ length: count }, () => ({
    title: faker.lorem.words(3),
    description: faker.lorem.paragraph(),
    file_size: faker.number.int({ min: 1024, max: 50 * 1024 * 1024 }),
    likes: faker.number.int({ min: 0, max: 100 }),
    downloads: faker.number.int({ min: 0, max: 1000 })
  }));
};
</code></pre>
<h3 id="4-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°">4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h3>
<pre><code class="language-typescript">const seedWithTransaction = async () => {
  const client = await pool.connect();
  try {
    await client.query('BEGIN');
    
    // ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥å‡¦ç†
    for (const material of testMaterials) {
      await client.query(insertQuery, values);
    }
    
    await client.query('COMMIT');
    console.log('ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Œäº†');
  } catch (error) {
    await client.query('ROLLBACK');
    console.error('ã‚¨ãƒ©ãƒ¼ã«ã‚ˆã‚Šãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯:', error);
    throw error;
  } finally {
    client.release();
  }
};
</code></pre>
<h3 id="5-å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªæŒ¿å…¥ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆ">5. å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªæŒ¿å…¥ï¼ˆãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆï¼‰</h3>
<p>ã‚·ãƒ¼ãƒ‰ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå¤§é‡ã«ã‚ã‚‹å ´åˆã€1ä»¶ãšã¤<code>INSERT</code>ã™ã‚‹ã‚ˆã‚Šã‚‚ã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ã¦1å›ã®ã‚¯ã‚¨ãƒªã§æŒ¿å…¥ã™ã‚‹ã€Œãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã€ãŒåŠ¹ç‡çš„ã§ã™ã€‚</p>
<pre><code class="language-typescript">// å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªæŒ¿å…¥
const seedMaterialsBulk = async () => {
  console.log('ğŸŒ± ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...');
  
  // æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
  await pool.query(`DELETE FROM materials WHERE file_key LIKE 'test-materials/%'`);
  
  // ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆç”¨ã®ã‚¯ã‚¨ãƒªã‚’æ§‹ç¯‰
  const placeholders = testMaterials.map((_, index) => {
    const offset = index * 8;
    return `($${offset + 1}, $${offset + 2}, $${offset + 3}, $${offset + 4}, $${offset + 5}, $${offset + 6}::text[], $${offset + 7}, $${offset + 8}, NOW(), NOW())`;
  }).join(',');
  
  const query = `
    INSERT INTO materials (
      title, description, file_key, file_type, 
      file_size, tags, likes, downloads, 
      created_at, updated_at
    ) VALUES ${placeholders}
    RETURNING id, title
  `;
  
  // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¹³å¦åŒ–
  const params = testMaterials.flatMap(material => [
    material.title,
    material.description,
    material.file_key,
    material.file_type,
    material.file_size,
    material.tags,
    material.likes,
    material.downloads
  ]);
  
  const result = await pool.query(query, params);
  console.log(`ğŸ“Š ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã§ ${result.rows.length} ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ`);
};
</code></pre>
<p><strong>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ</strong>:</p>
<ul>
<li>1ä»¶ãšã¤æŒ¿å…¥: 100ä»¶ã§ç´„2-3ç§’</li>
<li>ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆ: 100ä»¶ã§ç´„0.1-0.2ç§’</li>
</ul>
<h3 id="6-å®Ÿè¡Œçµæœã®ä¾‹">6. å®Ÿè¡Œçµæœã®ä¾‹</h3>
<p>å®Ÿéš›ã«<code>npm run seed:test</code>ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼š</p>
<pre><code class="language-bash">$ npm run seed:test

> @drill-layer/backend@1.0.0 seed:test
> ts-node src/infrastructure/db/seeds/runTestSeeds.ts

ğŸš€ ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ã®å®Ÿè¡Œã‚’é–‹å§‹ã—ã¾ã™...
âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã—ãŸ
ğŸŒ± ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã‚’é–‹å§‹ã—ã¾ã™...
âœ… æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ
âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: JavaScriptåŸºç¤å…¥é–€ (ID: dfb588c1-584c-4e4c-af74-f0602082dd6e)
âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: React Component è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ (ID: bcb13974-1ad0-44c0-b998-19ded98050d4)
âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã®åŸºç¤ (ID: 0add4528-b1ad-4771-be09-70d8b6c1b3c0)
âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: Pythonè‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆé›† (ID: f8a234b7-9c8d-4e5f-b6a1-2345678901ab)
âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: AWSåŸºç¤ã‚µãƒ¼ãƒ“ã‚¹æ¦‚è¦ (ID: 2ec83358-f95a-40a7-8708-4e36a85cc477)
ğŸ‰ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼
ğŸ“Š åˆè¨ˆ 10 ä»¶ã®æ•™æãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ
ğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼
</code></pre>
<h2 id="ã¾ã¨ã‚">ã¾ã¨ã‚</h2>
<p><code>npm run seed:test</code>ã¯ã€é–‹ç™ºåŠ¹ç‡ã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ã‚‹é‡è¦ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ä¸»ãªãƒ¡ãƒªãƒƒãƒˆã¯ï¼š</p>
<h3 id="-é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š">ğŸ¯ é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š</h3>
<ol>
<li><strong>å³åº§ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ</strong>ã§ãã‚‹</li>
<li><strong>ãƒãƒ¼ãƒ å…¨ä½“ã§åŒã˜ãƒ‡ãƒ¼ã‚¿</strong>ã‚’ä½¿ãˆã‚‹</li>
<li><strong>UIã®å‹•ä½œç¢ºèª</strong>ãŒç°¡å˜ã«ã§ãã‚‹</li>
<li><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ</strong>ã§ãã‚‹</li>
</ol>
<h3 id="-æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆ">ğŸ”§ æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆ</h3>
<ul>
<li>PostgreSQLé…åˆ—ã¯ç›´æ¥æ¸¡ã—ã¦<code>::text[]</code>ã§å‹ã‚­ãƒ£ã‚¹ãƒˆ</li>
<li>å†ªç­‰æ€§ã‚’ä¿ã¤ã“ã¨ã§å®‰å…¨ã«ä½•åº¦ã§ã‚‚å®Ÿè¡Œå¯èƒ½</li>
<li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°å‡ºåŠ›ã§å•é¡Œã‚’ç´ æ—©ãç‰¹å®š</li>
<li>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’ä¿è¨¼</li>
</ul>
<h3 id="-å®Ÿè·µçš„ãªæ´»ç”¨æ³•">ğŸ’¡ å®Ÿè·µçš„ãªæ´»ç”¨æ³•</h3>
<pre><code class="language-bash"># é–‹ç™ºé–‹å§‹æ™‚
npm run seed:test

# ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãŸæ™‚
npm run seed:test

# æ–°æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆæ™‚
npm run seed:test

# ãƒ‡ãƒ¢æº–å‚™æ™‚
npm run seed:demo
</code></pre>
<p>ä»Šå›ã®çµŒé¨“ã‹ã‚‰å­¦ã‚“ã ã“ã¨ï¼š</p>
<ul>
<li>ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¦ã‚‚æ…Œã¦ãšã«<code>seed</code>ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ</li>
<li>PostgreSQLé…åˆ—ã¯ç›´æ¥æ¸¡ã—ã¦å‹ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹</li>
<li>å†ªç­‰æ€§ã‚’ä¿ã¤ã“ã¨ã§å®‰å…¨ã«ä½•åº¦ã§ã‚‚å®Ÿè¡Œå¯èƒ½</li>
<li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°å‡ºåŠ›ã§å•é¡Œã‚’ç´ æ—©ãç‰¹å®š</li>
</ul>
<p>é–‹ç™ºç’°å¢ƒã§ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„å•é¡Œã«é­é‡ã—ãŸã‚‰ã€ã¾ãšã¯<code>npm run seed:test</code>ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ãã‚Œã ã‘ã§å•é¡ŒãŒè§£æ±ºã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ï¼</p>
<h2 id="å‚è€ƒãƒªãƒ³ã‚¯">å‚è€ƒãƒªãƒ³ã‚¯</h2>
<ul>
<li><a href="https://www.postgresql.org/docs/current/arrays.html">PostgreSQL: Arrays</a></li>
<li><a href="https://node-postgres.com/">Node.js: node-postgres</a></li>
<li><a href="https://github.com/TypeStrong/ts-node">TypeScript: ts-node</a></li>
<li><a href="https://docs.npmjs.com/cli/v9/using-npm/scripts">npm scripts</a></li>
<li><a href="https://pnpm.io/workspaces">pnpm Workspaces</a></li>
<li><a href="https://fakerjs.dev/">Faker.js - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
</ul>
<hr>
<p><em>ã“ã®è¨˜äº‹ã¯ã€å®Ÿéš›ã®é–‹ç™ºä¸­ã«ç™ºç”Ÿã—ãŸå•é¡Œã¨ãã®è§£æ±ºéç¨‹ã‚’åŸºã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚åŒæ§˜ã®å•é¡Œã«ç›´é¢ã—ã¦ã„ã‚‹é–‹ç™ºè€…ã®å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚</em></p></article><nav class="mt-8 pt-4 border-t border-gray-700 flex justify-between"><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/">â† ãƒ›ãƒ¼ãƒ ã¸</a><a class="text-blue-400 hover:text-blue-300 hover:underline" href="/blog/">è¨˜äº‹ä¸€è¦§ã¸ â†’</a></nav></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-aa7deb192a774533.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[87555,[],\"\"]\n3:I[31295,[],\"\"]\n5:I[59665,[],\"MetadataBoundary\"]\n7:I[59665,[],\"OutletBoundary\"]\na:I[74911,[],\"AsyncMetadataOutlet\"]\nc:I[59665,[],\"ViewportBoundary\"]\ne:I[26614,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/19bdf9af4d1ae4d4.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"p3p38c87R5BfkPUNQY3w8\",\"p\":\"\",\"c\":[\"\",\"blog\",\"database-seed-test-data\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"database-seed-test-data\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/19bdf9af4d1ae4d4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.png\",\"type\":\"image/png\"}]}],[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac __variable_9a8899 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"blog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"database-seed-test-data\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[\"$\",\"$L5\",null,{\"children\":\"$L6\"}],null,[\"$\",\"$L7\",null,{\"children\":[\"$L8\",\"$L9\",[\"$\",\"$La\",null,{\"promise\":\"$@b\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"9UkI-H1dalmY4LsBdWd8Q\",{\"children\":[[\"$\",\"$Lc\",null,{\"children\":\"$Ld\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:\"$Sreact.suspense\"\n10:I[74911,[],\"AsyncMetadata\"]\n6:[\"$\",\"$f\",null,{\"fallback\":null,\"children\":[\"$\",\"$L10\",null,{\"promise\":\"$@11\"}]}]\n"])</script><script>self.__next_f.push([1,"9:null\n"])</script><script>self.__next_f.push([1,"12:I[6874,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"\"]\n14:I[31203,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"default\"]\n15:I[4197,[\"6874\",\"static/chunks/6874-6c1ddde525f3893c.js\",\"5953\",\"static/chunks/app/blog/%5Bslug%5D/page-26397bcee018c1a3.js\"],\"default\"]\n13:T51d9,"])</script><script>self.__next_f.push([1,"\u003cp\u003eé–‹ç™ºä¸­ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€Œãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„ï¼ã€ã¨ã„ã†å•é¡Œã«é­é‡ã—ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿä»Šå›ã¯ã€æ•™æå…±æœ‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€ŒDrill Layerã€ã®é–‹ç™ºä¸­ã«ç™ºç”Ÿã—ãŸ\u003cstrong\u003eãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±å•é¡Œ\u003c/strong\u003eã¨ã€ãã®è§£æ±ºæ–¹æ³•ã§ã‚ã‚‹\u003ccode\u003enpm run seed:test\u003c/code\u003eã‚³ãƒãƒ³ãƒ‰ã®ä»•çµ„ã¿ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚\u003c/p\u003e\n\u003ch2 id=\"-åˆå¿ƒè€…å‘ã‘è§£èª¬\"\u003eğŸ’¡ åˆå¿ƒè€…å‘ã‘è§£èª¬\u003c/h2\u003e\n\u003ch3 id=\"seedã‚·ãƒ¼ãƒ‰ã¨ã¯\"\u003eseedï¼ˆã‚·ãƒ¼ãƒ‰ï¼‰ã¨ã¯ï¼Ÿ\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eç°¡å˜ã«è¨€ã†ã¨\u003c/strong\u003e: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚„ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æŠ•å…¥ã™ã‚‹å‡¦ç†ã®ã“ã¨ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eè¾²æ¥­ã§ç¨®ï¼ˆseedï¼‰ã‚’ã¾ãã‚ˆã†ã«ã€\nãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«åŸºç¤ã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ã€Œã¾ãã€å‡¦ç†\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ãªãœå¿…è¦\"\u003eãªãœå¿…è¦ï¼Ÿ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003eå®Ÿéš›ã®é–‹ç™ºç¾å ´ã§ã‚ˆãã‚ã‚‹å•é¡Œï¼š\nãƒ»ã€Œæ˜¨æ—¥ã¾ã§è¡¨ç¤ºã•ã‚Œã¦ã„ãŸãƒ‡ãƒ¼ã‚¿ãŒãªã„ï¼ã€\nãƒ»ã€Œæ–°ã—ã„æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ãŸã„ã‘ã©ãƒ‡ãƒ¼ã‚¿ãŒãªã„ã€\nãƒ»ã€Œãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿ã§é–‹ç™ºã—ãŸã„ã€\n\nâ†’ seedã‚³ãƒãƒ³ãƒ‰ã§ä¸€ç™ºè§£æ±ºï¼\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"-ç›®æ¬¡\"\u003eğŸ“š ç›®æ¬¡\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E5%95%8F%E9%A1%8C%E3%81%AE%E7%99%BA%E7%94%9F%E3%81%A8%E3%82%B7%E3%83%BC%E3%83%89%E3%81%AE%E5%BF%85%E8%A6%81%E6%80%A7\"\u003eå•é¡Œã®ç™ºç”Ÿã¨ã‚·ãƒ¼ãƒ‰ã®å¿…è¦æ€§\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#npm-run-seedtest%E3%81%AE%E4%BB%95%E7%B5%84%E3%81%BF\"\u003enpm run seed:testã®ä»•çµ„ã¿\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E5%AE%9F%E8%A3%85%E3%81%AE%E8%A9%B3%E7%B4%B0%E3%81%A8%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E8%AA%AC\"\u003eå®Ÿè£…ã®è©³ç´°ã¨ã‚³ãƒ¼ãƒ‰è§£èª¬\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#postgresql%E9%85%8D%E5%88%97%E3%81%AE%E6%89%B1%E3%81%84%E6%96%B9\"\u003ePostgreSQLé…åˆ—ã®æ‰±ã„æ–¹\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0\"\u003eãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%83%99%E3%82%B9%E3%83%88%E3%83%97%E3%83%A9%E3%82%AF%E3%83%86%E3%82%A3%E3%82%B9\"\u003eãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E3%81%BE%E3%81%A8%E3%82%81\"\u003eã¾ã¨ã‚\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"å•é¡Œã®ç™ºç”Ÿã¨ã‚·ãƒ¼ãƒ‰ã®å¿…è¦æ€§\"\u003eå•é¡Œã®ç™ºç”Ÿã¨ã‚·ãƒ¼ãƒ‰ã®å¿…è¦æ€§\u003c/h2\u003e\n\u003ch3 id=\"ç™ºç”Ÿã—ãŸå•é¡Œ\"\u003eç™ºç”Ÿã—ãŸå•é¡Œ\u003c/h3\u003e\n\u003cp\u003eé–‹ç™ºä¸­ã€ä»¥ä¸‹ã®ã‚ˆã†ãªçŠ¶æ³ã«é­é‡ã—ã¾ã—ãŸï¼š\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã‚‹ã¨...\n$ curl -s http://localhost:3000/api/materials | jq '. | length'\n3  # ã‚ã‚Œï¼Ÿ10ä»¶ã‚ã£ãŸã¯ãšã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒ3ä»¶ã—ã‹ãªã„ï¼\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã€Œã•ãã»ã©ã¾ã§ã¯è¡¨ç¤ºã•ã‚Œã¦ã„ãŸãŒä»Šã¯è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã€ã¨ã„ã†å ±å‘ŠãŒã‚ã‚Šã€èª¿æŸ»ã—ãŸã¨ã“ã‚ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒä½•ã‚‰ã‹ã®ç†ç”±ã§å‰Šé™¤ã•ã‚Œã¦ã„ãŸã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚\u003c/p\u003e\n\u003ch3 id=\"ã‚·ãƒ¼ãƒ‰ãŒå¿…è¦ãªç†ç”±\"\u003eã‚·ãƒ¼ãƒ‰ãŒå¿…è¦ãªç†ç”±\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eé–‹ç™ºç’°å¢ƒã®çµ±ä¸€\u003c/strong\u003e: ãƒãƒ¼ãƒ å…¨å“¡ãŒåŒã˜ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§é–‹ç™ºã§ãã‚‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå‹•ä½œç¢ºèªã®åŠ¹ç‡åŒ–\u003c/strong\u003e: UIã®è¦‹ãŸç›®ã‚„æ©Ÿèƒ½ã‚’ç´ æ—©ãç¢ºèªã§ãã‚‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eãƒ†ã‚¹ãƒˆã®å†ç¾æ€§\u003c/strong\u003e: åŒã˜æ¡ä»¶ã§ãƒ†ã‚¹ãƒˆã‚’ç¹°ã‚Šè¿”ã—å®Ÿè¡Œã§ãã‚‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eãƒ‡ãƒ¢ç’°å¢ƒã®æ§‹ç¯‰\u003c/strong\u003e: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¸ã®ãƒ—ãƒ¬ã‚¼ãƒ³ç”¨ãƒ‡ãƒ¼ã‚¿ã‚’ç°¡å˜ã«ç”¨æ„\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"npm-run-seedtestã®ä»•çµ„ã¿\"\u003enpm run seed:testã®ä»•çµ„ã¿\u003c/h2\u003e\n\u003ch3 id=\"å…¨ä½“ã®æµã‚Œ\"\u003eå…¨ä½“ã®æµã‚Œ\u003c/h3\u003e\n\u003cdiv class=\"mermaid\"\u003egraph TD\n    A[npm run seed:test] --\u0026gt; B[pnpm --filter @drill-layer/backend seed:test]\n    B --\u0026gt; C[ts-node runTestSeeds.ts]\n    C --\u0026gt; D[ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª]\n    D --\u0026gt; E[æ—¢å­˜ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿å‰Šé™¤]\n    E --\u0026gt; F[æ–°è¦ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŒ¿å…¥]\n    F --\u0026gt; G[å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º]\u003c/div\u003e\n\u003ch3 id=\"1-packagejsonã®è¨­å®š\"\u003e1. package.jsonã®è¨­å®š\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e{\n  \"scripts\": {\n    \"seed:test\": \"pnpm --filter @drill-layer/backend seed:test\"\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®\u003ccode\u003epackage.json\u003c/code\u003eã«å®šç¾©ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã¯ã€monorepoæ§‹æˆã§ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\u003c/p\u003e\n\u003ch3 id=\"2-ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ\"\u003e2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-json\"\u003e// packages/backend/package.json\n{\n  \"scripts\": {\n    \"seed:test\": \"ts-node src/infrastructure/db/seeds/runTestSeeds.ts\"\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTypeScriptã§æ›¸ã‹ã‚ŒãŸã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç›´æ¥å®Ÿè¡Œã—ã¾ã™ã€‚\u003c/p\u003e\n\u003ch2 id=\"å®Ÿè£…ã®è©³ç´°ã¨ã‚³ãƒ¼ãƒ‰è§£èª¬\"\u003eå®Ÿè£…ã®è©³ç´°ã¨ã‚³ãƒ¼ãƒ‰è§£èª¬\u003c/h2\u003e\n\u003ch3 id=\"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ã®ç®¡ç†\"\u003eãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæƒ…å ±ã®ç®¡ç†\u003c/h3\u003e\n\u003cp\u003eãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ¥ç¶šæƒ…å ±ï¼ˆãƒ›ã‚¹ãƒˆåã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ï¼‰ã‚’ã‚³ãƒ¼ãƒ‰ã«ç›´æ¥æ›¸ãè¾¼ã‚€ã®ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šå±é™ºã§ã™ã€‚\u003ccode\u003e.env\u003c/code\u003eãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã£ã¦ç®¡ç†ã—ã€\u003ccode\u003edotenv\u003c/code\u003eãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§èª­ã¿è¾¼ã‚€ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# .env ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¾‹ï¼ˆã“ã‚Œã¯ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚å®Ÿéš›ã®å€¤ã«ç½®ãæ›ãˆã¦ãã ã•ã„ï¼‰\nDATABASE_URL=\"postgresql://your_username:your_password@localhost:5432/your_database_name\"\n\n# å…·ä½“çš„ãªä¾‹ï¼š\n# DATABASE_URL=\"postgresql://johndoe:secretpass123@localhost:5432/myapp_dev\"\n#                          â†‘ãƒ¦ãƒ¼ã‚¶ãƒ¼å â†‘ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰     â†‘ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å\n# â€» ã“ã‚Œã‚‰ã¯ã™ã¹ã¦ã‚µãƒ³ãƒ—ãƒ«å€¤ã§ã™\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eâš ï¸ \u003cstrong\u003eé‡è¦\u003c/strong\u003e: ä¸Šè¨˜ã¯exampleã§ã™ã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯è‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ãŸå€¤ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// connection.ts\nimport { Pool } from 'pg';\nimport * as dotenv from 'dotenv';\n\ndotenv.config(); // .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€\n\nexport const pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ãƒ¡ã‚¤ãƒ³ã®ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«\"\u003eãƒ¡ã‚¤ãƒ³ã®ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// runTestSeeds.ts\nimport seedTestMaterials from './seedTestMaterials';\nimport { pool } from '../connection';\n\nconst runTestSeeds = async () =\u003e {\n  try {\n    console.log('ğŸš€ ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ã®å®Ÿè¡Œã‚’é–‹å§‹ã—ã¾ã™...');\n    \n    // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ\n    await pool.query('SELECT NOW()');\n    console.log('âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã—ãŸ');\n\n    // ãƒ†ã‚¹ãƒˆæ•™æãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ\n    await seedTestMaterials();\n\n    console.log('ğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼');\n    \n  } catch (error) {\n    console.error('âŒ ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);\n    process.exit(1);\n  } finally {\n    await pool.end();  // æ¥ç¶šãƒ—ãƒ¼ãƒ«ã‚’é–‰ã˜ã‚‹\n  }\n};\n\nrunTestSeeds();\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å®šç¾©ã¨æŒ¿å…¥\"\u003eãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å®šç¾©ã¨æŒ¿å…¥\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// seedTestMaterials.ts\nconst testMaterials = [\n  {\n    title: 'JavaScriptåŸºç¤å…¥é–€',\n    description: 'JavaScriptã®åŸºæœ¬çš„ãªæ–‡æ³•ã¨æ¦‚å¿µã«ã¤ã„ã¦è§£èª¬ã—ãŸæ•™æã§ã™ã€‚',\n    file_key: 'test-materials/javascript-basics.pdf',\n    file_type: 'pdf',\n    file_size: 2048576,  // 2MB\n    tags: ['JavaScript', 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', 'åˆå¿ƒè€…'],\n    likes: 15,\n    downloads: 42\n  },\n  {\n    title: 'React Component è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³',\n    description: 'Reacté–‹ç™ºã«ãŠã‘ã‚‹å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆæ‰‹æ³•ã‚’è§£èª¬ã€‚',\n    file_key: 'test-materials/react-components.pdf',\n    file_type: 'pdf',\n    file_size: 3145728,  // 3MB\n    tags: ['React', 'TypeScript', 'ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ'],\n    likes: 28,\n    downloads: 67\n  },\n  // ... ä»–ã®æ•™æãƒ‡ãƒ¼ã‚¿\n];\n\nconst seedTestMaterials = async () =\u003e {\n  console.log('ğŸŒ± ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã‚’é–‹å§‹ã—ã¾ã™...');\n  \n  // æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆå†ªç­‰æ€§ã®ç¢ºä¿ï¼‰\n  await pool.query(`\n    DELETE FROM materials \n    WHERE file_key LIKE 'test-materials/%'\n  `);\n  \n  let createdCount = 0;\n  \n  for (const material of testMaterials) {\n    const result = await pool.query(\n      `INSERT INTO materials (\n        title, description, file_key, file_type, \n        file_size, tags, likes, downloads, \n        created_at, updated_at\n      ) VALUES ($1, $2, $3, $4, $5, $6::text[], $7, $8, NOW(), NOW())\n      RETURNING id`,\n      [\n        material.title,\n        material.description,\n        material.file_key,\n        material.file_type,\n        material.file_size,\n        material.tags,  // PostgreSQLé…åˆ—ã¨ã—ã¦ç›´æ¥æ¸¡ã™\n        material.likes,\n        material.downloads\n      ]\n    );\n    \n    console.log(`âœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: ${material.title} (ID: ${result.rows[0].id})`);\n    createdCount++;\n  }\n  \n  console.log(`ğŸ“Š åˆè¨ˆ ${createdCount} ä»¶ã®æ•™æãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ`);\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"postgresqlé…åˆ—ã®æ‰±ã„æ–¹\"\u003ePostgreSQLé…åˆ—ã®æ‰±ã„æ–¹\u003c/h2\u003e\n\u003ch3 id=\"é‡è¦ãªãƒã‚¤ãƒ³ãƒˆpostgresqlé…åˆ—ã®å‹ã‚­ãƒ£ã‚¹ãƒˆ\"\u003eé‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼šPostgreSQLé…åˆ—ã®å‹ã‚­ãƒ£ã‚¹ãƒˆ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âŒ é–“é•ã„ï¼šJSONæ–‡å­—åˆ—ã¨ã—ã¦æ¸¡ã™\nJSON.stringify(material.tags)\n\n// âœ… æ­£è§£ï¼šé…åˆ—ã¨ã—ã¦ç›´æ¥æ¸¡ã™ + å‹ã‚­ãƒ£ã‚¹ãƒˆ\nmaterial.tags  // $6::text[] ã§PostgreSQLé…åˆ—ã«ã‚­ãƒ£ã‚¹ãƒˆ\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"é…åˆ—æ“ä½œã®è©³ç´°\"\u003eé…åˆ—æ“ä½œã®è©³ç´°\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-sql\"\u003e-- PostgreSQLå´ã§ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©\nCREATE TABLE materials (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  title VARCHAR(255) NOT NULL,\n  tags TEXT[] NOT NULL,  -- é…åˆ—å‹\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP\n);\n\n-- é…åˆ—ã§ã®æ¤œç´¢ä¾‹\nSELECT * FROM materials WHERE 'JavaScript' = ANY(tags);\nSELECT * FROM materials WHERE tags \u0026#x26;\u0026#x26; ARRAY['React', 'TypeScript'];\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"nodejså´ã§ã®é…åˆ—æ“ä½œ\"\u003eNode.jså´ã§ã®é…åˆ—æ“ä½œ\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// é…åˆ—ãƒ‡ãƒ¼ã‚¿ã®å®‰å…¨ãªæŒ¿å…¥\nconst insertMaterial = async (materialData: any) =\u003e {\n  // é…åˆ—ã®æ¤œè¨¼\n  if (!Array.isArray(materialData.tags)) {\n    throw new Error('tagsã¯é…åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™');\n  }\n  \n  // é…åˆ—è¦ç´ ã®æ¤œè¨¼\n  const validatedTags = materialData.tags\n    .filter(tag =\u003e typeof tag === 'string' \u0026#x26;\u0026#x26; tag.trim().length \u003e 0)\n    .slice(0, 10); // æœ€å¤§10å€‹ã¾ã§\n  \n  const result = await pool.query(\n    'INSERT INTO materials (title, tags) VALUES ($1, $2::text[]) RETURNING id',\n    [materialData.title, validatedTags]\n  );\n  \n  return result.rows[0];\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°\"\u003eãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°\u003c/h2\u003e\n\u003ch3 id=\"ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•\"\u003eã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•\u003c/h3\u003e\n\u003ch4 id=\"1-ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„\"\u003e1. ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eè¨ºæ–­ã‚³ãƒãƒ³ãƒ‰\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã‚’ç¢ºèª\ncurl -s http://localhost:3000/api/materials | jq '. | length'\n\n# ç›´æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç¢ºèª\npsql -d drill_layer_dev -c \"SELECT COUNT(*) FROM materials;\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eè§£æ±ºæ³•\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# 0ä»¶ã®å ´åˆã¯ã‚·ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ\nnpm run seed:test\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"2-cannot-read-properties-of-null-ã‚¨ãƒ©ãƒ¼\"\u003e2. \"Cannot read properties of null\" ã‚¨ãƒ©ãƒ¼\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eåŸå› \u003c/strong\u003e: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ãƒ‡ãƒ¼ã‚¿ãŒç©ºã®çŠ¶æ…‹ã‚’æƒ³å®šã—ã¦ã„ãªã„\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eè§£æ±ºæ³•\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰\nconst materials = data.materials.map(material =\u003e ...)\n\n// âœ… å®‰å…¨ãªã‚³ãƒ¼ãƒ‰\nconst [materials, setMaterials] = useState\u0026#x3C;Material[]\u003e([]);\nconst materialsList = data?.materials || [];\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"3-postgresqlé…åˆ—ã‚¨ãƒ©ãƒ¼\"\u003e3. PostgreSQLé…åˆ—ã‚¨ãƒ©ãƒ¼\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eerror: malformed array literal\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eè§£æ±ºæ³•\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// âŒ é–“é•ã„\nmaterial.tags = JSON.stringify(['tag1', 'tag2']);\n\n// âœ… æ­£è§£\nmaterial.tags = ['tag1', 'tag2'];  // é…åˆ—ã®ã¾ã¾æ¸¡ã™\n// SQL: $1::text[] ã§å‹ã‚­ãƒ£ã‚¹ãƒˆ\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"4-æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®ãƒªãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼\"\u003e4. æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®ãƒªãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eè§£æ±ºæ³•\u003c/strong\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003econst runTestSeeds = async () =\u003e {\n  try {\n    // ã‚·ãƒ¼ãƒ‰å‡¦ç†\n  } catch (error) {\n    console.error(error);\n    process.exit(1);\n  } finally {\n    await pool.end();  // å¿…ãšæ¥ç¶šã‚’é–‰ã˜ã‚‹\n  }\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹\"\u003eãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹\u003c/h2\u003e\n\u003ch3 id=\"1-å†ªç­‰æ€§idempotencyã®ç¢ºä¿\"\u003e1. å†ªç­‰æ€§ï¼ˆIdempotencyï¼‰ã®ç¢ºä¿\u003c/h3\u003e\n\u003cp\u003eã‚·ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä½•åº¦å®Ÿè¡Œã—ã¦ã‚‚åŒã˜çµæœã«ãªã‚‹ã‚ˆã†è¨­è¨ˆï¼š\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-sql\"\u003e-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦ã‹ã‚‰æ–°è¦æŒ¿å…¥\nDELETE FROM materials WHERE file_key LIKE 'test-materials/%'\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"2-ç’°å¢ƒã”ã¨ã®ã‚·ãƒ¼ãƒ‰åˆ†é›¢\"\u003e2. ç’°å¢ƒã”ã¨ã®ã‚·ãƒ¼ãƒ‰åˆ†é›¢\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// é–‹ç™ºç’°å¢ƒç”¨\nnpm run seed:dev\n\n// ãƒ†ã‚¹ãƒˆç’°å¢ƒç”¨\nnpm run seed:test\n\n// ãƒ‡ãƒ¢ç’°å¢ƒç”¨\nnpm run seed:demo\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"3-ãƒ‡ãƒ¼ã‚¿ã®ç¾å®Ÿæ€§\"\u003e3. ãƒ‡ãƒ¼ã‚¿ã®ç¾å®Ÿæ€§\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// ç¾å®Ÿçš„ãªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ\nconst testMaterials = [\n  {\n    title: 'JavaScriptåŸºç¤å…¥é–€',\n    // å®Ÿéš›ã«ã‚ã‚Šãã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º\n    file_size: 2048576,  // 2MB\n    // å®Ÿéš›ã«ã‚ã‚Šãã†ãªã‚¿ã‚°\n    tags: ['JavaScript', 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', 'åˆå¿ƒè€…'],\n    // ç¾å®Ÿçš„ãªæ•°å€¤\n    likes: Math.floor(Math.random() * 50) + 1,\n    downloads: Math.floor(Math.random() * 100) + 1\n  }\n];\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ´»ç”¨\u003c/strong\u003e:\n\u003ca href=\"https://fakerjs.dev/\"\u003eFaker.js\u003c/a\u003eã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å°å…¥ã™ã‚‹ã¨ã€åå‰ã€ä½æ‰€ã€æ–‡ç« ã€æ—¥ä»˜ãªã©ã€ã‚ˆã‚Šç¾å®Ÿã«è¿‘ã„å¤šæ§˜ãªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ç°¡å˜ã«ç”Ÿæˆã§ãã€ãƒ†ã‚¹ãƒˆã®è³ªã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003eimport { faker } from '@faker-js/faker';\n\nconst generateTestMaterials = (count: number) =\u003e {\n  return Array.from({ length: count }, () =\u003e ({\n    title: faker.lorem.words(3),\n    description: faker.lorem.paragraph(),\n    file_size: faker.number.int({ min: 1024, max: 50 * 1024 * 1024 }),\n    likes: faker.number.int({ min: 0, max: 100 }),\n    downloads: faker.number.int({ min: 0, max: 1000 })\n  }));\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"4-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\"\u003e4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003econst seedWithTransaction = async () =\u003e {\n  const client = await pool.connect();\n  try {\n    await client.query('BEGIN');\n    \n    // ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥å‡¦ç†\n    for (const material of testMaterials) {\n      await client.query(insertQuery, values);\n    }\n    \n    await client.query('COMMIT');\n    console.log('ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Œäº†');\n  } catch (error) {\n    await client.query('ROLLBACK');\n    console.error('ã‚¨ãƒ©ãƒ¼ã«ã‚ˆã‚Šãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯:', error);\n    throw error;\n  } finally {\n    client.release();\n  }\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"5-å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªæŒ¿å…¥ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆ\"\u003e5. å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªæŒ¿å…¥ï¼ˆãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆï¼‰\u003c/h3\u003e\n\u003cp\u003eã‚·ãƒ¼ãƒ‰ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå¤§é‡ã«ã‚ã‚‹å ´åˆã€1ä»¶ãšã¤\u003ccode\u003eINSERT\u003c/code\u003eã™ã‚‹ã‚ˆã‚Šã‚‚ã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ã¦1å›ã®ã‚¯ã‚¨ãƒªã§æŒ¿å…¥ã™ã‚‹ã€Œãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã€ãŒåŠ¹ç‡çš„ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-typescript\"\u003e// å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªæŒ¿å…¥\nconst seedMaterialsBulk = async () =\u003e {\n  console.log('ğŸŒ± ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆä¸­...');\n  \n  // æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤\n  await pool.query(`DELETE FROM materials WHERE file_key LIKE 'test-materials/%'`);\n  \n  // ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆç”¨ã®ã‚¯ã‚¨ãƒªã‚’æ§‹ç¯‰\n  const placeholders = testMaterials.map((_, index) =\u003e {\n    const offset = index * 8;\n    return `($${offset + 1}, $${offset + 2}, $${offset + 3}, $${offset + 4}, $${offset + 5}, $${offset + 6}::text[], $${offset + 7}, $${offset + 8}, NOW(), NOW())`;\n  }).join(',');\n  \n  const query = `\n    INSERT INTO materials (\n      title, description, file_key, file_type, \n      file_size, tags, likes, downloads, \n      created_at, updated_at\n    ) VALUES ${placeholders}\n    RETURNING id, title\n  `;\n  \n  // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¹³å¦åŒ–\n  const params = testMaterials.flatMap(material =\u003e [\n    material.title,\n    material.description,\n    material.file_key,\n    material.file_type,\n    material.file_size,\n    material.tags,\n    material.likes,\n    material.downloads\n  ]);\n  \n  const result = await pool.query(query, params);\n  console.log(`ğŸ“Š ãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆã§ ${result.rows.length} ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ`);\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e1ä»¶ãšã¤æŒ¿å…¥: 100ä»¶ã§ç´„2-3ç§’\u003c/li\u003e\n\u003cli\u003eãƒãƒ«ã‚¯ã‚¤ãƒ³ã‚µãƒ¼ãƒˆ: 100ä»¶ã§ç´„0.1-0.2ç§’\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"6-å®Ÿè¡Œçµæœã®ä¾‹\"\u003e6. å®Ÿè¡Œçµæœã®ä¾‹\u003c/h3\u003e\n\u003cp\u003eå®Ÿéš›ã«\u003ccode\u003enpm run seed:test\u003c/code\u003eã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼š\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e$ npm run seed:test\n\n\u003e @drill-layer/backend@1.0.0 seed:test\n\u003e ts-node src/infrastructure/db/seeds/runTestSeeds.ts\n\nğŸš€ ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ã®å®Ÿè¡Œã‚’é–‹å§‹ã—ã¾ã™...\nâœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã—ãŸ\nğŸŒ± ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆã‚’é–‹å§‹ã—ã¾ã™...\nâœ… æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ\nâœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: JavaScriptåŸºç¤å…¥é–€ (ID: dfb588c1-584c-4e4c-af74-f0602082dd6e)\nâœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: React Component è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ (ID: bcb13974-1ad0-44c0-b998-19ded98050d4)\nâœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã®åŸºç¤ (ID: 0add4528-b1ad-4771-be09-70d8b6c1b3c0)\nâœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: Pythonè‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆé›† (ID: f8a234b7-9c8d-4e5f-b6a1-2345678901ab)\nâœ… æ•™æã‚’ç™»éŒ²ã—ã¾ã—ãŸ: AWSåŸºç¤ã‚µãƒ¼ãƒ“ã‚¹æ¦‚è¦ (ID: 2ec83358-f95a-40a7-8708-4e36a85cc477)\nğŸ‰ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼\nğŸ“Š åˆè¨ˆ 10 ä»¶ã®æ•™æãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ\nğŸ‰ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚·ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"ã¾ã¨ã‚\"\u003eã¾ã¨ã‚\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003enpm run seed:test\u003c/code\u003eã¯ã€é–‹ç™ºåŠ¹ç‡ã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ã‚‹é‡è¦ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ä¸»ãªãƒ¡ãƒªãƒƒãƒˆã¯ï¼š\u003c/p\u003e\n\u003ch3 id=\"-é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š\"\u003eğŸ¯ é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eå³åº§ã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ\u003c/strong\u003eã§ãã‚‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eãƒãƒ¼ãƒ å…¨ä½“ã§åŒã˜ãƒ‡ãƒ¼ã‚¿\u003c/strong\u003eã‚’ä½¿ãˆã‚‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUIã®å‹•ä½œç¢ºèª\u003c/strong\u003eãŒç°¡å˜ã«ã§ãã‚‹\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ\u003c/strong\u003eã§ãã‚‹\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"-æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆ\"\u003eğŸ”§ æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆ\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePostgreSQLé…åˆ—ã¯ç›´æ¥æ¸¡ã—ã¦\u003ccode\u003e::text[]\u003c/code\u003eã§å‹ã‚­ãƒ£ã‚¹ãƒˆ\u003c/li\u003e\n\u003cli\u003eå†ªç­‰æ€§ã‚’ä¿ã¤ã“ã¨ã§å®‰å…¨ã«ä½•åº¦ã§ã‚‚å®Ÿè¡Œå¯èƒ½\u003c/li\u003e\n\u003cli\u003eã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°å‡ºåŠ›ã§å•é¡Œã‚’ç´ æ—©ãç‰¹å®š\u003c/li\u003e\n\u003cli\u003eãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’ä¿è¨¼\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"-å®Ÿè·µçš„ãªæ´»ç”¨æ³•\"\u003eğŸ’¡ å®Ÿè·µçš„ãªæ´»ç”¨æ³•\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# é–‹ç™ºé–‹å§‹æ™‚\nnpm run seed:test\n\n# ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãŸæ™‚\nnpm run seed:test\n\n# æ–°æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆæ™‚\nnpm run seed:test\n\n# ãƒ‡ãƒ¢æº–å‚™æ™‚\nnpm run seed:demo\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eä»Šå›ã®çµŒé¨“ã‹ã‚‰å­¦ã‚“ã ã“ã¨ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¦ã‚‚æ…Œã¦ãšã«\u003ccode\u003eseed\u003c/code\u003eã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ\u003c/li\u003e\n\u003cli\u003ePostgreSQLé…åˆ—ã¯ç›´æ¥æ¸¡ã—ã¦å‹ã‚­ãƒ£ã‚¹ãƒˆã™ã‚‹\u003c/li\u003e\n\u003cli\u003eå†ªç­‰æ€§ã‚’ä¿ã¤ã“ã¨ã§å®‰å…¨ã«ä½•åº¦ã§ã‚‚å®Ÿè¡Œå¯èƒ½\u003c/li\u003e\n\u003cli\u003eã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°å‡ºåŠ›ã§å•é¡Œã‚’ç´ æ—©ãç‰¹å®š\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eé–‹ç™ºç’°å¢ƒã§ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„å•é¡Œã«é­é‡ã—ãŸã‚‰ã€ã¾ãšã¯\u003ccode\u003enpm run seed:test\u003c/code\u003eã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ãã‚Œã ã‘ã§å•é¡ŒãŒè§£æ±ºã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ï¼\u003c/p\u003e\n\u003ch2 id=\"å‚è€ƒãƒªãƒ³ã‚¯\"\u003eå‚è€ƒãƒªãƒ³ã‚¯\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.postgresql.org/docs/current/arrays.html\"\u003ePostgreSQL: Arrays\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://node-postgres.com/\"\u003eNode.js: node-postgres\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/TypeStrong/ts-node\"\u003eTypeScript: ts-node\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://docs.npmjs.com/cli/v9/using-npm/scripts\"\u003enpm scripts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://pnpm.io/workspaces\"\u003epnpm Workspaces\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://fakerjs.dev/\"\u003eFaker.js - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eã“ã®è¨˜äº‹ã¯ã€å®Ÿéš›ã®é–‹ç™ºä¸­ã«ç™ºç”Ÿã—ãŸå•é¡Œã¨ãã®è§£æ±ºéç¨‹ã‚’åŸºã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚åŒæ§˜ã®å•é¡Œã«ç›´é¢ã—ã¦ã„ã‚‹é–‹ç™ºè€…ã®å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚\u003c/em\u003e\u003c/p\u003e"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto py-10 px-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-3xl font-bold mb-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"text-green-600\",\"children\":[\"#\",36]}],\" \",\"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ - npm run seed:testã®ä»•çµ„ã¿ã¨å®Ÿè£…\"]}],[\"$\",\"ul\",null,{\"className\":\"list-none border-b border-gray-600 pb-4 mb-6\",\"children\":[[\"$\",\"li\",null,{\"className\":\"text-gray-500 text-sm\",\"children\":[\"ä½œæˆæ—¥æ™‚: \",\"2025-08-15 10:59\"]}],\"$undefined\",[\"$\",\"li\",null,{\"className\":\"flex flex-wrap gap-2 mt-2\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Database\"}],[\"$\",\"span\",\"1\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"Node.js\"}],[\"$\",\"span\",\"2\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"PostgreSQL\"}],[\"$\",\"span\",\"3\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"seed\"}],[\"$\",\"span\",\"4\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"test-data\"}],[\"$\",\"span\",\"5\",{\"className\":\"px-2 py-1 bg-gray-800 text-gray-300 rounded text-xs\",\"children\":\"TypeScript\"}]]}]]}],[\"$\",\"nav\",null,{\"className\":\"mb-6 pb-4 border-b border-gray-700 flex justify-between\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"â† ãƒ›ãƒ¼ãƒ ã¸\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"è¨˜äº‹ä¸€è¦§ã¸ â†’\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose dark:prose-invert\",\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"}}],[\"$\",\"$L14\",null,{}],[\"$\",\"nav\",null,{\"className\":\"mt-8 pt-4 border-t border-gray-700 flex justify-between\",\"children\":[[\"$\",\"$L12\",null,{\"href\":\"/\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"â† ãƒ›ãƒ¼ãƒ ã¸\"}],[\"$\",\"$L12\",null,{\"href\":\"/blog\",\"className\":\"text-blue-400 hover:text-blue-300 hover:underline\",\"children\":\"è¨˜äº‹ä¸€è¦§ã¸ â†’\"}]]}],[\"$\",\"$L15\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n8:null\n"])</script><script>self.__next_f.push([1,"11:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Maita Tomoya Dev IO\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"ç±³ç”°æ™ºå“‰ã®æŠ€è¡“ãƒ–ãƒ­ã‚°ã€‚ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ãŸã“ã¨ã‚’ãƒ¡ãƒ¢ã—ã¾ã™ã€‚\"}]],\"error\":null,\"digest\":\"$undefined\"}\nb:{\"metadata\":\"$11:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>