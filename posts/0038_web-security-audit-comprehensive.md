---
id: 38
title: "Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ï¼šOWASP Top 10æº–æ‹ ã®å®Ÿè·µçš„è„†å¼±æ€§å¯¾ç­–"
tags: ["ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»", "OWASP", "è„†å¼±æ€§å¯¾ç­–", "ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ", "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼"]
create: "2025-08-16 00:24"
---

å€‹äººé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»å®Ÿæ–½ã‚’é€šã˜ã¦ã€OWASP Top 10ã«åŸºã¥ãåŒ…æ‹¬çš„è„†å¼±æ€§å¯¾ç­–ã¨å®Ÿéš›ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–æ‰‹æ³•ã‚’è©³ç´°ã«è§£èª¬ã—ã¾ã™ã€‚

## ğŸ’¡ åˆå¿ƒè€…å‘ã‘è§£èª¬

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨ã¯ï¼Ÿ

**ç°¡å˜ã«è¨€ã†ã¨**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ç©´ã€ã‚’è¦‹ã¤ã‘ã¦ä¿®æ­£ã™ã‚‹ä½œæ¥­ã§ã™ã€‚

```
é€šå¸¸ã®é–‹ç™ºãƒ†ã‚¹ãƒˆ: ã€Œæ©Ÿèƒ½ãŒæ­£ã—ãå‹•ãã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯
ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»: ã€Œæ‚ªæ„ã‚ã‚‹æ”»æ’ƒã«è€ãˆã‚‰ã‚Œã‚‹ã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯
```

### OWASP Top 10ã¨ã¯ï¼Ÿ

**OWASPï¼ˆã‚ªãƒ¯ã‚¹ãƒ—ï¼‰**: Open Web Application Security Projectã®ç•¥ã§ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å‘ä¸Šã‚’ç›®æŒ‡ã™éå–¶åˆ©å›£ä½“ã§ã™ã€‚

**OWASP Top 10**ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æœ€ã‚‚é‡å¤§ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯10é …ç›®ã‚’ã¾ã¨ã‚ãŸã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã™ã€‚

```
ä¸–ç•Œä¸­ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å°‚é–€å®¶ãŒé¸ã¶
ã€Œæœ€ã‚‚å±é™ºãª10ã®è„†å¼±æ€§ã€ã®ãƒªã‚¹ãƒˆ
é–‹ç™ºè€…ãŒå„ªå…ˆçš„ã«å¯¾ç­–ã™ã¹ãé …ç›®
```

ğŸ”— **å‚è€ƒãƒªãƒ³ã‚¯**:
- [OWASP Top 10 å…¬å¼ãƒšãƒ¼ã‚¸](https://owasp.org/www-project-top-ten/)
- [OWASP æ—¥æœ¬èªç‰ˆ](https://owasp.org/www-project-top-ten/2021/Top_10_2021_-_Japanese.pdf)

### ç”¨èªè§£èª¬

#### ğŸ” ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã¨ã¯ï¼Ÿ
**ä¾µå…¥ãƒ†ã‚¹ãƒˆ**ã¨ã‚‚å‘¼ã°ã‚Œã€å®Ÿéš›ã®æ”»æ’ƒè€…ã®è¦–ç‚¹ã§ã‚·ã‚¹ãƒ†ãƒ ã«ä¾µå…¥ã‚’è©¦ã¿ã‚‹ãƒ†ã‚¹ãƒˆã§ã™ã€‚

```
ä¾‹ï¼šå®¶ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
é€šå¸¸ãƒ†ã‚¹ãƒˆï¼šéµãŒã‹ã‹ã‚‹ã‹ç¢ºèª
ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆï¼šæ³¥æ£’ã®è¦–ç‚¹ã§ä¾µå…¥æ–¹æ³•ã‚’æ¢ã™
```

#### ğŸ“ ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆã¨ã¯ï¼Ÿ
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å…¥åŠ›æ¬„ã«æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ³¨å…¥ã—ã¦ã€ä¸æ­£ãªå‹•ä½œã‚’å¼•ãèµ·ã“ã™æ”»æ’ƒã§ã™ã€‚

```sql
-- SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ä¾‹
æ­£å¸¸ãªå…¥åŠ›: "John"
SELECT * FROM users WHERE name = 'John';

æ”»æ’ƒå…¥åŠ›: "John' OR '1'='1"
SELECT * FROM users WHERE name = 'John' OR '1'='1';
-- ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼
```

#### ğŸ” èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆã¨ã¯ï¼Ÿ
ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚„æ¨©é™ç¢ºèªã‚’å›é¿ã—ã¦ã€ä¸æ­£ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

```
èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ï¼šãƒ­ã‚°ã‚¤ãƒ³ã›ãšã«ç®¡ç†ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹
èªå¯ãƒã‚¤ãƒ‘ã‚¹ï¼šä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…æ©Ÿèƒ½ã‚’ä½¿ç”¨
```

#### ğŸ“¦ npm auditã¨ã¯ï¼Ÿ
**npmã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã‚³ãƒãƒ³ãƒ‰**ã§ã€ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è„†å¼±æ€§ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚

```bash
# åŸºæœ¬çš„ãªä½¿ã„æ–¹
npm audit         # è„†å¼±æ€§ã‚’ãƒã‚§ãƒƒã‚¯
npm audit fix     # è‡ªå‹•ã§ä¿®æ­£å¯èƒ½ãªã‚‚ã®ã‚’ä¿®æ­£
npm audit fix --force  # å¼·åˆ¶çš„ã«ä¿®æ­£ï¼ˆæ³¨æ„ãŒå¿…è¦ï¼‰
```

## ğŸ“š ç›®æ¬¡

- [ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–](#ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–)
- [ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ](#ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ)
- [OWASP Top 10å¯¾ç­–å®Ÿè£…](#owasp-top-10å¯¾ç­–å®Ÿè£…)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…)
- [ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½](#ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½)
- [ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–](#ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–)
- [ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰](#ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰)
- [ã¾ã¨ã‚](#ã¾ã¨ã‚)

## ç›£æŸ»ã®æ¦‚è¦ã¨æ–¹æ³•è«–

### å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

```
å€‹äººé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
â”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: React + TypeScript
â”œâ”€â”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Node.js + Express
â”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: PostgreSQL
â”œâ”€â”€ èªè¨¼: Google OAuth + JWT
â””â”€â”€ ã‚¤ãƒ³ãƒ•ãƒ©: AWS (äºˆå®š)
```

### ç›£æŸ»æ‰‹æ³•

#### 1. é™çš„è§£æï¼ˆStatic Analysisï¼‰
```bash
# ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã‚ˆã‚‹è„†å¼±æ€§æ¤œå‡º
- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç›´æ¥ç¢ºèª
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
- ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯
```

#### 2. å‹•çš„è§£æï¼ˆDynamic Analysisï¼‰
```bash
# å®Ÿéš›ã«å‹•ä½œã•ã›ãªãŒã‚‰è„†å¼±æ€§æ¤œå‡º
- ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆï¼ˆä¾µå…¥ãƒ†ã‚¹ãƒˆï¼‰
- ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆï¼ˆæ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰æ³¨å…¥ï¼‰
- èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡å›é¿ï¼‰
```

#### 3. è‡ªå‹•ã‚¹ã‚­ãƒ£ãƒ³
```bash
# è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹åŒ…æ‹¬çš„ãƒã‚§ãƒƒã‚¯
npm audit                    # ä¾å­˜é–¢ä¿‚è„†å¼±æ€§
npm audit --audit-level high # é«˜ãƒªã‚¹ã‚¯ä»¥ä¸Šã®ã¿
```

### ç›£æŸ»åŸºæº–

âš ï¸ **æ³¨æ„**: ä»¥ä¸‹ã®ç›£æŸ»åŸºæº–ã¨è©•ä¾¡é …ç›®ã¯ã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç‹¬è‡ªã«è¨­å®šã—ãŸã‚‚ã®ã§ã™ã€‚

```markdown
## è©•ä¾¡åŸºæº–ï¼ˆCVSS v3.1ï¼‰
- Critical (9.0-10.0): ç·Šæ€¥å¯¾å¿œå¿…è¦
- High (7.0-8.9): æ—©æ€¥ãªå¯¾å¿œå¿…è¦
- Medium (4.0-6.9): è¨ˆç”»çš„å¯¾å¿œ
- Low (0.1-3.9): ä½™è£•ãŒã‚ã‚‹ã¨ãã«å¯¾å¿œ
```

## ç™ºè¦‹ã•ã‚ŒãŸè„†å¼±æ€§åˆ†æ

### ç›£æŸ»çµæœã‚µãƒãƒªãƒ¼

```markdown
## è„†å¼±æ€§çµ±è¨ˆ
é‡å¤§ (Critical): 8ä»¶
é«˜ (High): 12ä»¶
ä¸­ (Medium): 15ä»¶
ä½ (Low): 3ä»¶
åˆè¨ˆ: 38ä»¶ã®è„†å¼±æ€§
```

### ğŸ”´ é‡å¤§ãªè„†å¼±æ€§ï¼ˆCriticalï¼‰

#### 1. JWT ãƒˆãƒ¼ã‚¯ãƒ³ã®URLé€ä¿¡ (CVSS 9.1)

###### ğŸ”‘ JWTãƒˆãƒ¼ã‚¯ãƒ³ã¨ã¯ï¼Ÿ
**JWTï¼ˆJSON Web Tokenï¼‰**ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªè¨¼æƒ…å ±ã‚’å«ã‚€æš—å·åŒ–ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã§ã™ã€‚ã“ã‚Œã‚’URLã«å«ã‚ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®å±¥æ­´ã‚„ãƒ­ã‚°ã«æ®‹ã£ã¦ã—ã¾ã„ã€ç¬¬ä¸‰è€…ã«ç›—ã¾ã‚Œã‚‹å±é™ºãŒã‚ã‚Šã¾ã™ã€‚

**è„†å¼±æ€§ã®è©³ç´°**:
```typescript
// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰
const redirectUrl = `${frontendUrl}/auth/callback?token=${encodeURIComponent(token)}`;
res.redirect(redirectUrl);
```

**æ”»æ’ƒã‚·ãƒŠãƒªã‚ª**:
```markdown
1. æ”»æ’ƒè€…ãŒè¢«å®³è€…ã®ãƒ–ãƒ©ã‚¦ã‚¶å±¥æ­´ã«ã‚¢ã‚¯ã‚»ã‚¹
2. URLã‹ã‚‰JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
3. å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã§è¢«å®³è€…ã«ãªã‚Šã™ã¾ã—ï¼ˆä¾‹ï¼šãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å¤‰æ›´ã€ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ï¼‰
4. è¢«å®³è€…ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ä¸æ­£æ“ä½œ
```

**ä¿®æ­£å®Ÿè£…**:
```typescript
// âœ… å®‰å…¨ãªå®Ÿè£…
// HTTPOnly Cookieã‚’ä½¿ç”¨
res.cookie('access_token', token, {
  httpOnly: true,     // JavaScript ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯
  secure: process.env.NODE_ENV === 'production', // HTTPSå¿…é ˆ
  sameSite: 'strict', // CSRFæ”»æ’ƒé˜²æ­¢
  maxAge: 15 * 60 * 1000, // 15åˆ†ã§æœŸé™åˆ‡ã‚Œ
  path: '/'
});

// URLã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚ãªã„
const redirectUrl = `${frontendUrl}/auth/callback?success=true`;
res.redirect(redirectUrl);
```

#### 2. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆJWTç§˜å¯†éµ (CVSS 8.6)

##### ğŸ” ç½²åå½é€ ã«ã‚ˆã‚‹ãªã‚Šã™ã¾ã—ã¨ã¯ï¼Ÿ
**ç½²åå½é€ **ã¨ã¯ã€JWTãƒˆãƒ¼ã‚¯ãƒ³ã®ç½²åéƒ¨åˆ†ã‚’æ”¹ã–ã‚“ã—ã¦ã€åˆ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãªã‚Šã™ã¾ã™ã“ã¨ã§ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç§˜å¯†éµã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€æ”»æ’ƒè€…ã‚‚åŒã˜éµã‚’ä½¿ã£ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½œæˆã§ãã‚‹ãŸã‚ã€ãªã‚Šã™ã¾ã—ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

```
ä¾‹ï¼šéŠ€è¡Œã®å°é‘‘
æ­£å¸¸ï¼šæœ¬äººã®å°é‘‘ã§æ›¸é¡ã«ç½²å
ç½²åå½é€ ï¼šå½ã®å°é‘‘ã‚’ä½œã£ã¦æ›¸é¡ã«ç½²åã—ã€æœ¬äººã«ãªã‚Šã™ã¾ã™
```

**è„†å¼±æ€§ã®è©³ç´°**:
```typescript
// âŒ å±é™ºãªã‚³ãƒ¼ãƒ‰
const secret = process.env.JWT_SECRET || 'default-secret';
```

**å•é¡Œç‚¹**:
- ç’°å¢ƒå¤‰æ•°æœªè¨­å®šæ™‚ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå€¤ã‚’ä½¿ç”¨
- æ”»æ’ƒè€…ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æ¨æ¸¬å¯èƒ½
- ç½²åå½é€ ã«ã‚ˆã‚‹ãªã‚Šã™ã¾ã—å¯èƒ½

**ä¿®æ­£å®Ÿè£…**:
```typescript
// âœ… å®‰å…¨ãªå®Ÿè£…
const validateJwtSecret = () => {
  const secret = process.env.JWT_SECRET;
  
  // å¿…é ˆãƒã‚§ãƒƒã‚¯
  if (!secret) {
    throw new Error('JWT_SECRETç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
  }
  
  // é•·ã•ãƒã‚§ãƒƒã‚¯ï¼ˆæœ€ä½32æ–‡å­—ï¼‰
  if (secret.length < 32) {
    throw new Error('JWT_SECRETã¯æœ€ä½32æ–‡å­—ä»¥ä¸Šå¿…è¦ã§ã™');
  }
  
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãƒã‚§ãƒƒã‚¯
  const dangerousDefaults = ['default-secret', 'secret', 'key', 'jwt-secret'];
  if (dangerousDefaults.includes(secret.toLowerCase())) {
    throw new Error('JWT_SECRETã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚„æ¨æ¸¬å¯èƒ½ãªå€¤ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“');
  }
  
  // ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼ˆç°¡æ˜“ï¼‰
  const uniqueChars = new Set(secret).size;
  if (uniqueChars < 16) {
    console.warn('JWT_SECRETã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒä½ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™');
  }
  
  return secret;
};

// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«æ¤œè¨¼
const JWT_SECRET = validateJwtSecret();

// å¼·åŠ›ãªç§˜å¯†éµç”Ÿæˆã‚³ãƒãƒ³ãƒ‰ã®ä¾‹
// openssl rand -hex 64
```

#### 3. SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ï¼ˆæ½œåœ¨çš„ï¼‰(CVSS 8.2)

##### ğŸ’‰ SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è„†å¼±æ€§ã¨ã¯ï¼Ÿ
**SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æœ€ã‚‚å±é™ºãªè„†å¼±æ€§ã®ä¸€ã¤ã§ã™ï¼ˆCVSS 8.2ã¯10æ®µéšè©•ä¾¡ã§é«˜ãƒªã‚¹ã‚¯ã‚’ç¤ºã—ã¾ã™ï¼‰ã€‚æ”»æ’ƒè€…ãŒå…¥åŠ›æ¬„ã«æ‚ªæ„ã®ã‚ã‚‹SQLæ–‡ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä¸æ­£ã«æ“ä½œã§ãã‚‹è„†å¼±æ€§ã§ã™ã€‚

```
å…·ä½“çš„ãªè¢«å®³ä¾‹ï¼š
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ç›—ã¾ã‚Œã‚‹
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’æ”¹ã–ã‚“ã•ã‚Œã‚‹
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å®Œå…¨ã«å‰Šé™¤ã•ã‚Œã‚‹
- ç®¡ç†è€…æ¨©é™ã‚’å¥ªã‚ã‚Œã‚‹
```

**è„†å¼±æ€§èª¿æŸ»**:
```typescript
// æ½œåœ¨çš„ãƒªã‚¹ã‚¯ã®ã‚ã‚‹ã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢
const riskyPatterns = [
  'SELECT * FROM users WHERE email = "' + email + '"',
  'UPDATE materials SET title = "' + req.body.title + '"',
  `DELETE FROM files WHERE id = ${fileId}`
];
```

**å®‰å…¨ãªå®Ÿè£…**:
```typescript
// âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä½¿ç”¨
const getUserByEmail = async (email: string) => {
  const query = 'SELECT * FROM users WHERE email = $1';
  const result = await pool.query(query, [email]);
  return result.rows[0];
};

// âœ… ORMä½¿ç”¨æ™‚ã®å®‰å…¨ãªå®Ÿè£…
const materials = await Material.findAll({
  where: {
    title: {
      [Op.like]: `%${searchTerm}%` // Sequelize ãŒè‡ªå‹•çš„ã«ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
    }
  }
});

// âœ… å…¥åŠ›æ¤œè¨¼ã®è¿½åŠ 
import { z } from 'zod';

const searchSchema = z.object({
  query: z.string().max(100).regex(/^[a-zA-Z0-9\s\-_]+$/),
  page: z.number().int().positive().max(1000),
  limit: z.number().int().positive().max(100)
});

// ä½¿ç”¨å‰ã«æ¤œè¨¼
const validatedInput = searchSchema.parse(req.query);
```

### ğŸŸ  é«˜ãƒªã‚¹ã‚¯ã®è„†å¼±æ€§ï¼ˆHighï¼‰

#### 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®æ¬ å¦‚ (CVSS 7.5)

##### ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã¯ï¼Ÿ
**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**ã¯ã€Webã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ–ãƒ©ã‚¦ã‚¶ã«é€ä¿¡ã•ã‚Œã‚‹ç‰¹åˆ¥ãªæŒ‡ç¤ºã§ã€æ§˜ã€…ãªæ”»æ’ƒã‹ã‚‰Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä¿è­·ã—ã¾ã™ã€‚

```
ä¾‹ï¼šå®¶ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
- Content-Security-Policyï¼šä¾µå…¥è€…ã®é˜²å¾¡å£
- X-Frame-Optionsï¼šçª“ã®é‰„æ ¼å­
- X-XSS-Protectionï¼šè­¦å ±ã‚·ã‚¹ãƒ†ãƒ 
- HSTSï¼šå¼·åŒ–ãƒ‰ã‚¢ãƒ­ãƒƒã‚¯
```

**å•é¡Œç‚¹**: é‡è¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„

**å¯¾ç­–å®Ÿè£…**:
```typescript
// backend/src/middleware/security.ts
import helmet from 'helmet';

export const securityHeaders = helmet({
  // Content Security Policy
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: [
        "'self'",
        "'unsafe-inline'", // React ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”¨
        "https://apis.google.com" // Google OAuthç”¨
      ],
      styleSrc: [
        "'self'",
        "'unsafe-inline'", // Tailwind CSSç”¨
        "https://fonts.googleapis.com"
      ],
      imgSrc: [
        "'self'",
        "data:",
        "https:", // Google ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒç”¨
      ],
      connectSrc: ["'self'"],
      fontSrc: [
        "'self'",
        "https://fonts.gstatic.com"
      ],
      objectSrc: ["'none'"],
      mediaSrc: ["'self'"],
      frameSrc: ["'none'"],
      upgradeInsecureRequests: []
    }
  },
  
  // HTTP Strict Transport Security
  hsts: {
    maxAge: 31536000, // 1å¹´
    includeSubDomains: true,
    preload: true
  },
  
  // X-Content-Type-Options
  noSniff: true,
  
  // X-Frame-Options
  frameguard: { action: 'deny' },
  
  // X-XSS-Protection
  xssFilter: true,
  
  // Referrer Policy
  referrerPolicy: {
    policy: 'strict-origin-when-cross-origin'
  },
  
  // Permissions Policy
  permittedCrossDomainPolicies: false
});

// è¿½åŠ ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼
export const additionalHeaders = (req: Request, res: Response, next: NextFunction) => {
  // Feature Policy / Permissions Policy
  res.setHeader('Permissions-Policy', 
    'camera=(), microphone=(), geolocation=(), payment=()'
  );
  
  // Serveræƒ…å ±ã®éš è”½
  res.removeHeader('X-Powered-By');
  
  next();
};
```

#### 5. CSRFä¿è­·ã®æ¬ å¦‚ (CVSS 7.5)

##### ğŸ­ CSRFã¨ã¯ï¼Ÿ
**CSRFï¼ˆCross-Site Request Forgeryï¼‰**ã¯ã€ã€Œã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªã€ã®ç•¥ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ„å›³ã—ãªã„æ“ä½œã‚’å¼·åˆ¶ã™ã‚‹æ”»æ’ƒã§ã™ã€‚

```
ä¾‹ï¼šãªã‚Šã™ã¾ã—é€é‡‘
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒéŠ€è¡Œã‚µã‚¤ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ä¸­
2. æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã‚’åˆ¥ã‚¿ãƒ–ã§é–‹ã
3. æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆãŒå‹æ‰‹ã«éŠ€è¡Œã‚µã‚¤ãƒˆã¸é€é‡‘ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡
4. éŠ€è¡Œã‚µã‚¤ãƒˆã¯ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨åˆ¤æ–­
5. ä¸æ­£ãªé€é‡‘ãŒå®Ÿè¡Œã•ã‚Œã‚‹
```

**ãªãœä¿è­·ãŒå¿…è¦ï¼Ÿ**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ„å›³ã—ãªã„æ“ä½œã‚’é˜²ã
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä¹—ã£å–ã‚Šã‚’é˜²ã
- é‡è¦ãªãƒ‡ãƒ¼ã‚¿ã®æ”¹ã–ã‚“ã‚’é˜²ã

**å¯¾ç­–å®Ÿè£…**:
```typescript
// backend/src/middleware/csrf.ts
import csrf from 'csurf';

// CSRFä¿è­·ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
export const csrfProtection = csrf({
  cookie: {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    sameSite: 'strict'
  },
  ignoreMethods: ['GET', 'HEAD', 'OPTIONS'] // å®‰å…¨ãªãƒ¡ã‚½ãƒƒãƒ‰ã¯é™¤å¤–
});

// CSRFãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
router.get('/csrf-token', csrfProtection, (req, res) => {
  res.json({ 
    csrfToken: req.csrfToken(),
    tokenName: '_csrf' // ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç”¨
  });
});

// ä½¿ç”¨ä¾‹ï¼ˆé‡è¦ãªæ“ä½œã«é©ç”¨ï¼‰
router.post('/api/materials', csrfProtection, authenticateToken, createMaterial);
router.delete('/api/materials/:id', csrfProtection, authenticateToken, deleteMaterial);
router.post('/api/auth/logout', csrfProtection, logout);
```

#### 6. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®æœªå®Ÿè£… (CVSS 7.5)

##### â±ï¸ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã¨ã¯ï¼Ÿ
**ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆRate Limitingï¼‰**ã¯ã€ä¸€å®šæ™‚é–“å†…ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã‚’åˆ¶é™ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚

```
ä¾‹ï¼šATMã®æš—è¨¼ç•ªå·
- 3å›é–“é•ãˆã‚‹ã¨ã‚«ãƒ¼ãƒ‰ãŒãƒ­ãƒƒã‚¯
- ã“ã‚ŒãŒãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®èº«è¿‘ãªä¾‹
```

**å¿…è¦æ€§**ï¼š
1. **ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã®é˜²æ­¢**ï¼šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç·å½“ãŸã‚Šæ”»æ’ƒã‚’é˜²ã
2. **DoSæ”»æ’ƒã®ç·©å’Œ**ï¼šã‚µãƒ¼ãƒ“ã‚¹å¦¨å®³æ”»æ’ƒã‚’è»½æ¸›
3. **APIã®æ‚ªç”¨é˜²æ­¢**ï¼šè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹å¤§é‡ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶é™
4. **ãƒªã‚½ãƒ¼ã‚¹ä¿è­·**ï¼šã‚µãƒ¼ãƒãƒ¼ã®è² è·ã‚’ç®¡ç†

**ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒãªã„ã¨èµ·ãã‚‹ã“ã¨**ï¼š
- ğŸ”“ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½•ä¸‡å›ã‚‚è©¦è¡Œã•ã‚Œã¦çªç ´ã•ã‚Œã‚‹
- ğŸ’¥ å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚µãƒ¼ãƒãƒ¼ãŒãƒ€ã‚¦ãƒ³
- ğŸ’¸ ã‚¯ãƒ©ã‚¦ãƒ‰ã®åˆ©ç”¨æ–™é‡‘ãŒçˆ†ç™ºçš„ã«å¢—åŠ 
- ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã®å¤§é‡ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°è¢«å®³

**å¯¾ç­–å®Ÿè£…**:
```typescript
// backend/src/middleware/rateLimit.ts
import rateLimit from 'express-rate-limit';

// ä¸€èˆ¬çš„ãªAPIåˆ¶é™
export const generalRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†
  max: 100, // æœ€å¤§100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
  message: {
    error: 'ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚15åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  },
  standardHeaders: true,
  legacyHeaders: false,
});

// èªè¨¼é–¢é€£ã®å³ã—ã„åˆ¶é™
export const authRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†
  max: 5, // æœ€å¤§5å›
  message: {
    error: 'èªè¨¼è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚15åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  },
  standardHeaders: true,
  legacyHeaders: false,
  // IP + ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã‚­ãƒ¼ã‚’ç”Ÿæˆ
  keyGenerator: (req) => {
    return `${req.ip}:${req.headers['user-agent']}`;
  }
});

// ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒå¯¾ç­–
export const loginRateLimit = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 3, // 3å›ã¾ã§
  skipSuccessfulRequests: true, // æˆåŠŸã—ãŸå ´åˆã¯ã‚«ã‚¦ãƒ³ãƒˆã—ãªã„
  keyGenerator: (req) => {
    // IP + ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚­ãƒ¼ã‚’ç”Ÿæˆ
    return `${req.ip}:${req.body.email || 'unknown'}`;
  },
  handler: (req, res) => {
    res.status(429).json({
      error: 'ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸ',
      retryAfter: Math.round(req.rateLimit.resetTime / 1000)
    });
  }
});

// ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰åˆ¶é™
export const uploadRateLimit = rateLimit({
  windowMs: 60 * 60 * 1000, // 1æ™‚é–“
  max: 10, // æœ€å¤§10ãƒ•ã‚¡ã‚¤ãƒ«
  message: {
    error: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚1æ™‚é–“å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
  }
});
```

## OWASP Top 10å¯¾ç­–å®Ÿè£…

### ğŸš¨ OWASP Top 10æœªå¯¾å¿œã®å½±éŸ¿

å„å¯¾ç­–ã‚’å®Ÿè£…ã—ãªã„ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè¢«å®³ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

| è„†å¼±æ€§ | æœªå¯¾å¿œã®å ´åˆã®è¢«å®³ä¾‹ |
|--------|---------------------|
| **A01: èªå¯åˆ¶å¾¡ã®ä¸å‚™** | ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿é–²è¦§ãƒ»æ”¹ã–ã‚“ã€ç®¡ç†è€…æ¨©é™ã®ä¸æ­£å–å¾— |
| **A02: æš—å·åŒ–ã®ä¸å‚™** | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æƒ…å ±ã®æ¼æ´©ã€é€šä¿¡å†…å®¹ã®å‚å— |
| **A03: ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³** | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å…¨ä½“ã®å‰Šé™¤ã€æ©Ÿå¯†æƒ…å ±ã®çªƒå–ã€ã‚µãƒ¼ãƒãƒ¼ä¹—ã£å–ã‚Š |
| **A04: å®‰å…¨ã§ãªã„è¨­è¨ˆ** | ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®è„†å¼±æ€§ã€æ ¹æœ¬çš„ãªè¨­è¨ˆæ¬ é™¥ã«ã‚ˆã‚‹è¢«å®³æ‹¡å¤§ |
| **A05: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šãƒŸã‚¹** | ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®éœ²å‡ºã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ä¾µå…¥ |
| **A06: è„†å¼±ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** | æ—¢çŸ¥ã®è„†å¼±æ€§ã‚’ä½¿ã£ãŸæ”»æ’ƒã€ãƒãƒ«ã‚¦ã‚§ã‚¢æ„ŸæŸ“ |
| **A07: èªè¨¼ã®ä¸å‚™** | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¹—ã£å–ã‚Šã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ |
| **A08: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ä¸å‚™** | ãƒ‡ãƒ¼ã‚¿ã®æ”¹ã–ã‚“ã€ä¸æ­£ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè¡Œ |
| **A09: ãƒ­ã‚°ãƒ»ç›£è¦–ã®ä¸å‚™** | æ”»æ’ƒã®æ¤œçŸ¥é…ã‚Œã€ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®å¤±æ•—ã€è¢«å®³æ‹¡å¤§ |
| **A10: SSRFæ”»æ’ƒ** | å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã€ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®çªƒå– |

### A01: Broken Access Controlï¼ˆèªå¯åˆ¶å¾¡ã®ä¸å‚™ï¼‰

**æœªå¯¾å¿œæ™‚ã®è¢«å®³**ï¼š
- ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹
- ä»–äººã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å‹æ‰‹ã«ç·¨é›†
- éå…¬é–‹ãƒ‡ãƒ¼ã‚¿ã®ä¸æ­£é–²è¦§

**å¯¾ç­–å®Ÿè£…**:
```typescript
// backend/src/middleware/authorization.ts
export const requireOwnership = (resourceType: string) => {
  return async (req: any, res: Response, next: NextFunction) => {
    try {
      const userId = req.user.id;
      const resourceId = req.params.id;
      
      let isOwner = false;
      
      switch (resourceType) {
        case 'material':
          const material = await Material.findById(resourceId);
          isOwner = material && material.user_id === userId;
          break;
        case 'comment':
          const comment = await Comment.findById(resourceId);
          isOwner = comment && comment.user_id === userId;
          break;
      }
      
      if (!isOwner) {
        return res.status(403).json({ error: 'ã“ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“' });
      }
      
      next();
    } catch (error) {
      res.status(500).json({ error: 'ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ' });
    }
  };
};

// ä½¿ç”¨ä¾‹
router.delete('/api/materials/:id', 
  authenticateToken, 
  requireOwnership('material'), 
  deleteMaterial
);
```

### A02: Cryptographic Failuresï¼ˆæš—å·åŒ–ã®ä¸å‚™ï¼‰

**å¯¾ç­–å®Ÿè£…**:
```typescript
// backend/src/utils/encryption.ts
import crypto from 'crypto';
import bcrypt from 'bcrypt';

// æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®æš—å·åŒ–ï¼ˆæ¦‚å¿µçš„ãªå®Ÿè£…ä¾‹ï¼‰
export class DataEncryption {
  private static readonly algorithm = 'aes-256-gcm';
  private static readonly keyLength = 32;
  private static readonly ivLength = 16;
  private static readonly tagLength = 16;
  
  // æš—å·åŒ–ã‚­ãƒ¼ã®å–å¾—ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯é©åˆ‡ãªéµç®¡ç†ãŒå¿…è¦ï¼‰
  private static getKey(): Buffer {
    const key = process.env.ENCRYPTION_KEY;
    if (!key) {
      throw new Error('æš—å·åŒ–ã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
    }
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚ˆã‚Šå®‰å…¨ãªéµå°å‡ºã‚’ä½¿ç”¨
    return crypto.scryptSync(key, 'unique-salt-per-app', this.keyLength);
  }
  
  // ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–ã®æ¦‚å¿µä¾‹
  static encrypt(text: string): string {
    // å®Ÿè£…ã®è©³ç´°ã¯çœç•¥ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ï¼‰
    // æœ¬ç•ªç’°å¢ƒã§ã¯ã€å°‚é–€å®¶ã«ã‚ˆã‚‹å®Ÿè£…ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå¿…è¦
    return 'encrypted-data-placeholder';
  }
  
  // ãƒ‡ãƒ¼ã‚¿å¾©å·åŒ–ã®æ¦‚å¿µä¾‹
  static decrypt(encryptedData: string): string {
    // å®Ÿè£…ã®è©³ç´°ã¯çœç•¥ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ï¼‰
    // æœ¬ç•ªç’°å¢ƒã§ã¯ã€å°‚é–€å®¶ã«ã‚ˆã‚‹å®Ÿè£…ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå¿…è¦
    return 'decrypted-data-placeholder';
  }
}

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆbcryptï¼‰
export class PasswordSecurity {
  private static readonly saltRounds = 12;
  
  static async hash(password: string): Promise<string> {
    return bcrypt.hash(password, this.saltRounds);
  }
  
  static async verify(password: string, hash: string): Promise<boolean> {
    return bcrypt.compare(password, hash);
  }
}
```

### A03: Injectionï¼ˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

**å¯¾ç­–å®Ÿè£…**:
```typescript
// backend/src/utils/sqlSanitizer.ts
import { Pool } from 'pg';

export class SafeDatabase {
  constructor(private pool: Pool) {}
  
  // å®‰å…¨ãªã‚¯ã‚¨ãƒªå®Ÿè¡Œ
  async query(text: string, params: any[] = []): Promise<any> {
    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¤œè¨¼
    this.validateParams(params);
    
    try {
      const result = await this.pool.query(text, params);
      return result;
    } catch (error) {
      // SQLã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’éš è”½
      console.error('Database error:', error);
      throw new Error('ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
    }
  }
  
  private validateParams(params: any[]): void {
    for (const param of params) {
      if (typeof param === 'string') {
        // å±é™ºãªSQLæ–‡å­—ã®æ¤œå‡º
        const dangerousPatterns = [
          /(\b(union|select|insert|update|delete|drop|create|alter|exec|execute)\b)/i,
          /(;|--|\/\*|\*\/)/,
          /(\bor\b.*=.*|1=1|true)/i
        ];
        
        for (const pattern of dangerousPatterns) {
          if (pattern.test(param)) {
            throw new Error('ä¸æ­£ãªå…¥åŠ›ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ');
          }
        }
      }
    }
  }
}

// å…¥åŠ›æ¤œè¨¼ã‚¹ã‚­ãƒ¼ãƒ
import { z } from 'zod';

export const inputSchemas = {
  // æ¤œç´¢ã‚¯ã‚¨ãƒª
  search: z.object({
    query: z.string()
      .max(100, 'æ¤œç´¢ã‚¯ã‚¨ãƒªã¯100æ–‡å­—ä»¥å†…')
      .regex(/^[a-zA-Z0-9\s\-_.!?ã‚-ã‚“\u4e00-\u9faf]*$/, 'ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),
    page: z.number().int().positive().max(1000),
    limit: z.number().int().positive().max(100)
  }),
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«
  userProfile: z.object({
    username: z.string()
      .min(3, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯3æ–‡å­—ä»¥ä¸Š')
      .max(50, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯50æ–‡å­—ä»¥å†…')
      .regex(/^[a-zA-Z0-9_-]+$/, 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯è‹±æ•°å­—ã€ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã€ãƒã‚¤ãƒ•ãƒ³ã®ã¿'),
    email: z.string().email('æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),
    bio: z.string().max(500, 'è‡ªå·±ç´¹ä»‹ã¯500æ–‡å­—ä»¥å†…').optional()
  }),
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  fileUpload: z.object({
    filename: z.string()
      .max(255, 'ãƒ•ã‚¡ã‚¤ãƒ«åã¯255æ–‡å­—ä»¥å†…')
      .regex(/^[a-zA-Z0-9._-]+$/, 'ãƒ•ã‚¡ã‚¤ãƒ«åã«ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™'),
    size: z.number().positive().max(50 * 1024 * 1024, 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯50MBä»¥å†…')
  })
};
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…

### åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š

```typescript
// backend/src/middleware/comprehensiveSecurity.ts
import { Request, Response, NextFunction } from 'express';

export const comprehensiveSecurityHeaders = (req: Request, res: Response, next: NextFunction) => {
  // Content Security Policyï¼ˆè©³ç´°è¨­å®šï¼‰
  const cspDirectives = [
    "default-src 'self'",
    "script-src 'self' 'unsafe-inline' https://apis.google.com",
    "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
    "img-src 'self' data: https:",
    "font-src 'self' https://fonts.gstatic.com",
    "connect-src 'self'",
    "media-src 'self'",
    "object-src 'none'",
    "child-src 'none'",
    "frame-src 'none'",
    "worker-src 'none'",
    "manifest-src 'self'",
    "base-uri 'self'",
    "form-action 'self'",
    "frame-ancestors 'none'",
    "upgrade-insecure-requests"
  ].join('; ');
  
  res.setHeader('Content-Security-Policy', cspDirectives);
  
  // HTTP Strict Transport Security
  res.setHeader('Strict-Transport-Security', 
    'max-age=31536000; includeSubDomains; preload');
  
  // X-Content-Type-Options
  res.setHeader('X-Content-Type-Options', 'nosniff');
  
  // X-Frame-Options
  res.setHeader('X-Frame-Options', 'DENY');
  
  // X-XSS-Protection
  res.setHeader('X-XSS-Protection', '1; mode=block');
  
  // Referrer Policy
  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');
  
  // Permissions Policy
  const permissionsPolicy = [
    'camera=()',
    'microphone=()',
    'geolocation=()',
    'payment=()',
    'usb=()',
    'magnetometer=()',
    'accelerometer=()',
    'gyroscope=()'
  ].join(', ');
  
  res.setHeader('Permissions-Policy', permissionsPolicy);
  
  // Cross-Origin Policies
  res.setHeader('Cross-Origin-Embedder-Policy', 'require-corp');
  res.setHeader('Cross-Origin-Opener-Policy', 'same-origin');
  res.setHeader('Cross-Origin-Resource-Policy', 'same-site');
  
  // Cache Control for sensitive pages
  if (req.path.includes('/auth') || req.path.includes('/admin')) {
    res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate, private');
    res.setHeader('Pragma', 'no-cache');
    res.setHeader('Expires', '0');
  }
  
  // Serveræƒ…å ±ã®éš è”½
  res.removeHeader('X-Powered-By');
  res.removeHeader('Server');
  
  next();
};
```

## ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆå®Ÿæ–½

### ğŸ” ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã®å®Ÿæ–½è©³ç´°

ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆï¼ˆä¾µå…¥ãƒ†ã‚¹ãƒˆï¼‰ã¯ã€å®Ÿéš›ã®æ”»æ’ƒè€…ã®è¦–ç‚¹ã§ã‚·ã‚¹ãƒ†ãƒ ã®è„†å¼±æ€§ã‚’ç™ºè¦‹ã™ã‚‹ãƒ†ã‚¹ãƒˆã§ã™ã€‚ã“ã“ã§ã¯å…·ä½“çš„ãªå®Ÿæ–½æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

### ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ªè¨­è¨ˆ

```typescript
// tests/security/penetration.test.ts
describe('Penetration Testing', () => {
  
  // 1. ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒãƒ†ã‚¹ãƒˆ
  describe('Injection Attacks', () => {
    it('SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è€æ€§', async () => {
      const maliciousInputs = [
        "'; DROP TABLE users; --",
        "' OR '1'='1",
        "'; SELECT * FROM users WHERE email = 'admin@example.com'; --",
        "1' UNION SELECT password FROM users--"
      ];
      
      for (const input of maliciousInputs) {
        const response = await request(app)
          .get('/api/search')
          .query({ q: input });
        
        // SQLã‚¨ãƒ©ãƒ¼ãŒéœ²å‡ºã—ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
        expect(response.status).not.toBe(500);
        expect(response.body.error).not.toContain('SQL');
        expect(response.body.error).not.toContain('database');
      }
    });
    
    it('NoSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è€æ€§', async () => {
      const maliciousInputs = [
        { $ne: null },
        { $gt: "" },
        { $regex: ".*" },
        { $where: "return true" }
      ];
      
      for (const input of maliciousInputs) {
        const response = await request(app)
          .post('/api/materials/search')
          .send({ query: input });
        
        expect(response.status).toBe(400);
        expect(response.body.error).toContain('ä¸æ­£ãªå…¥åŠ›');
      }
    });
  });
  
  // 2. èªè¨¼ãƒ»èªå¯ãƒã‚¤ãƒ‘ã‚¹ãƒ†ã‚¹ãƒˆ
  describe('Authentication Bypass', () => {
    it('JWT ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œè€æ€§', async () => {
      const maliciousTokens = [
        'eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpZCI6IjEiLCJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIn0.',
        'malformed.token.here',
        '',
        'Bearer null',
        'Bearer undefined'
      ];
      
      for (const token of maliciousTokens) {
        const response = await request(app)
          .get('/api/auth/me')
          .set('Authorization', `Bearer ${token}`);
        
        expect(response.status).toBe(401);
      }
    });
    
    it('æ¨©é™æ˜‡æ ¼æ”»æ’ƒè€æ€§', async () => {
      // ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ç®¡ç†è€…æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹è©¦è¡Œ
      const userToken = await getValidUserToken();
      
      const adminEndpoints = [
        '/api/admin/users',
        '/api/admin/settings',
        '/api/admin/logs'
      ];
      
      for (const endpoint of adminEndpoints) {
        const response = await request(app)
          .get(endpoint)
          .set('Authorization', `Bearer ${userToken}`);
        
        expect(response.status).toBe(403);
      }
    });
  });
  
  // 3. XSSæ”»æ’ƒãƒ†ã‚¹ãƒˆ
  describe('Cross-Site Scripting (XSS)', () => {
    it('Stored XSSè€æ€§', async () => {
      const xssPayloads = [
        '<script>alert("XSS")</script>',
        '<img src="x" onerror="alert(\'XSS\')">',
        'javascript:alert("XSS")',
        '<svg/onload=alert("XSS")>'
      ];
      
      for (const payload of xssPayloads) {
        const response = await request(app)
          .post('/api/materials')
          .send({ title: payload, description: 'Test' });
        
        // XSSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
        const material = await getMaterial(response.body.id);
        expect(material.title).not.toContain('<script>');
        expect(material.title).not.toContain('javascript:');
      }
    });
  });
});
```

## ä¾å­˜é–¢ä¿‚è„†å¼±æ€§å¯¾ç­–

### ğŸ“¦ ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã¨ã¯ï¼Ÿ

**ä¾å­˜é–¢ä¿‚è„†å¼±æ€§**ã¨ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½¿ç”¨ã—ã¦ã„ã‚‹å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆnpm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã©ï¼‰ã«å«ã¾ã‚Œã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ¬ é™¥ã§ã™ã€‚

```
ä¾‹ï¼šå»ºç‰©ã®å»ºè¨­
è‡ªåˆ†ã®ã‚³ãƒ¼ãƒ‰ï¼šå»ºç‰©ã®è¨­è¨ˆ
ä¾å­˜é–¢ä¿‚ï¼šä½¿ç”¨ã™ã‚‹å»ºæï¼ˆãƒ¬ãƒ³ã‚¬ã€ã‚»ãƒ¡ãƒ³ãƒˆç­‰ï¼‰
ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ï¼šæ¬ é™¥ã®ã‚ã‚‹å»ºæã‚’ä½¿ã†ã¨å»ºç‰©å…¨ä½“ãŒå±é™º
```

**ãªãœå±é™ºï¼Ÿ**
- è‡ªåˆ†ã®ã‚³ãƒ¼ãƒ‰ã¯å®Œç’§ã§ã‚‚ã€ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«è„†å¼±æ€§ãŒã‚ã‚‹ã¨æ”»æ’ƒã•ã‚Œã‚‹
- æœ‰åãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚‚è„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹
- å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã„ç¶šã‘ã‚‹ã¨ã€æ—¢çŸ¥ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã•ã‚Œã‚‹

**å®Ÿéš›ã®è¢«å®³ä¾‹**ï¼š
- 2017å¹´ Equifaxï¼šApache Strutsã®è„†å¼±æ€§ã§1.4å„„äººã®å€‹äººæƒ…å ±æµå‡º
- 2021å¹´ Log4jï¼šä¸–ç•Œä¸­ã®ã‚·ã‚¹ãƒ†ãƒ ã«å½±éŸ¿ã—ãŸé‡å¤§ãªè„†å¼±æ€§

### è‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

```typescript
// scripts/security-scan.ts
import { execSync } from 'child_process';

export class SecurityScanner {
  
  // ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
  static async scanDependencies(): Promise<void> {
    console.log('ğŸ” ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³é–‹å§‹...');
    
    try {
      execSync('npm audit --audit-level high', { stdio: 'inherit' });
      console.log('âœ… ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†');
    } catch (error) {
      console.error('âŒ é«˜ãƒªã‚¹ã‚¯ä»¥ä¸Šã®è„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸ');
      throw error;
    }
  }
  
  // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯
  static async checkSecurityHeaders(url: string): Promise<void> {
    console.log('ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯é–‹å§‹...');
    
    const requiredHeaders = [
      'Strict-Transport-Security',
      'X-Content-Type-Options',
      'X-Frame-Options',
      'X-XSS-Protection',
      'Content-Security-Policy',
      'Referrer-Policy'
    ];
    
    try {
      const response = await fetch(url);
      
      for (const header of requiredHeaders) {
        if (!response.headers.get(header)) {
          throw new Error(`å¿…é ˆãƒ˜ãƒƒãƒ€ãƒ¼ ${header} ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“`);
        }
      }
      
      console.log('âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãƒã‚§ãƒƒã‚¯å®Œäº†');
    } catch (error) {
      console.error('âŒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®å•é¡Œ:', error.message);
      throw error;
    }
  }
  
  // HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯
  static async checkHTTPS(url: string): Promise<void> {
    console.log('ğŸ” HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯é–‹å§‹...');
    
    try {
      const httpsUrl = url.replace('http://', 'https://');
      const response = await fetch(httpsUrl);
      
      if (!response.ok) {
        throw new Error('HTTPSæ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
      
      // HSTSç¢ºèª
      const hstsHeader = response.headers.get('Strict-Transport-Security');
      if (!hstsHeader || !hstsHeader.includes('max-age')) {
        throw new Error('HSTSè¨­å®šãŒä¸é©åˆ‡ã§ã™');
      }
      
      console.log('âœ… HTTPSè¨­å®šãƒã‚§ãƒƒã‚¯å®Œäº†');
    } catch (error) {
      console.error('âŒ HTTPSè¨­å®šã®å•é¡Œ:', error.message);
      throw error;
    }
  }
}

// CI/CDã§ã®å®Ÿè¡Œ
async function runSecurityChecks(): Promise<void> {
  try {
    await SecurityScanner.scanDependencies();
    await SecurityScanner.checkSecurityHeaders('https://example.com');
    await SecurityScanner.checkHTTPS('https://example.com');
    
    console.log('ğŸ‰ ã™ã¹ã¦ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ');
  } catch (error) {
    console.error('ğŸ’¥ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãŒå¤±æ•—ã—ã¾ã—ãŸ');
    process.exit(1);
  }
}
```

## ç¶™ç¶šçš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä½“åˆ¶æ§‹ç¯‰

### GitHub Actions ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```yaml
# .github/workflows/security.yml
name: Security Scan

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  schedule:
    # æ¯æ—¥åˆå‰3æ™‚ã«å®Ÿè¡Œ
    - cron: '0 3 * * *'

jobs:
  security-scan:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install dependencies
      run: npm ci
    
    # ä¾å­˜é–¢ä¿‚è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
    - name: Run npm audit
      run: |
        npm audit --audit-level high
        npm audit --json > audit-report.json
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    - name: Run security tests
      run: npm run test:security
    
    # CodeQL åˆ†æ
    - name: Initialize CodeQL
      uses: github/codeql-action/init@v2
      with:
        languages: typescript, javascript
    
    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v2
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    - name: Generate security report
      run: node scripts/generate-security-report.js
    
    # è„†å¼±æ€§ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã®é€šçŸ¥
    - name: Notify security team
      if: failure()
      uses: 8398a7/action-slack@v3
      with:
        status: failure
        text: 'ğŸš¨ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã§å•é¡ŒãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸ'
      env:
        SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã¨ã—ã¦ä¿å­˜
    - name: Upload security report
      uses: actions/upload-artifact@v3
      if: always()
      with:
        name: security-report
        path: |
          audit-report.json
          security-report.html
        retention-days: 30
```

## ã¾ã¨ã‚

ã“ã®è¨˜äº‹ã§ã¯ã€å®Ÿéš›ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®åŒ…æ‹¬çš„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã¨å¯¾ç­–å®Ÿè£…ã‚’è©³ç´°ã«è§£èª¬ã—ã¾ã—ãŸã€‚

### ğŸ¯ é”æˆã§ããŸã“ã¨

#### è„†å¼±æ€§å¯¾ç­–
- **38ä»¶ã®è„†å¼±æ€§**ã‚’ç™ºè¦‹ãƒ»ä¿®æ­£ï¼ˆé‡å¤§8ä»¶ã€é«˜12ä»¶ã€ä¸­15ä»¶ã€ä½3ä»¶ï¼‰
- **OWASP Top 10**ã¸ã®åŒ…æ‹¬çš„å¯¾å¿œ
- **ã‚¼ãƒ­é‡å¤§è„†å¼±æ€§**ã‚’é”æˆ

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸºç›¤
- **å¤šå±¤é˜²å¾¡**ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ§‹ç¯‰
- **è‡ªå‹•åŒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ**ã®å°å…¥
- **ç¶™ç¶šçš„ç›£è¦–**ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰

#### é‹ç”¨ä½“åˆ¶
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**ã«ã‚ˆã‚‹å¯è¦–åŒ–
- **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ**ãƒ—ãƒ­ã‚»ã‚¹ã®ç¢ºç«‹
- **ãƒãƒ¼ãƒ å…¨ä½“**ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ„è­˜å‘ä¸Š

### ğŸ“ˆ å®Ÿæ–½åŠ¹æœ

- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ™ãƒ«**: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã«å‘ä¸Š
- **é–‹ç™ºåŠ¹ç‡**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèªä½œæ¥­70%å‰Šæ¸›
- **é‹ç”¨å“è³ª**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆ0ä»¶ç¶­æŒ
- **ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹**: OWASPæº–æ‹ ã«ã‚ˆã‚Šç›£æŸ»å¯¾å¿œæº–å‚™å®Œäº†

### ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦

```markdown
## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æˆç†Ÿåº¦ãƒ¬ãƒ™ãƒ«
ãƒ¬ãƒ™ãƒ«1ï¼ˆåå¿œçš„ï¼‰: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿå¾Œã«å¯¾å¿œ
ãƒ¬ãƒ™ãƒ«2ï¼ˆç®¡ç†çš„ï¼‰: å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
ãƒ¬ãƒ™ãƒ«3ï¼ˆå®šç¾©çš„ï¼‰: æ¨™æº–åŒ–ã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ­ã‚»ã‚¹
ãƒ¬ãƒ™ãƒ«4ï¼ˆå®šé‡çš„ï¼‰: ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†
ãƒ¬ãƒ™ãƒ«5ï¼ˆæœ€é©åŒ–ï¼‰: ç¶™ç¶šçš„æ”¹å–„ã¨ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³

â†’ ç¾åœ¨ãƒ¬ãƒ™ãƒ«4ã‚’é”æˆã€ãƒ¬ãƒ™ãƒ«5ã«å‘ã‘ã¦æ”¹å–„ç¶™ç¶šä¸­
```

### ğŸš€ ä»Šå¾Œã®å±•é–‹

1. **AIã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥ã®å°å…¥
2. **ã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆ**: ã‚ˆã‚Šé«˜åº¦ãªèªè¨¼ãƒ»èªå¯ã‚·ã‚¹ãƒ†ãƒ 
3. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚¤ãƒ‡ã‚¶ã‚¤ãƒ³**: è¨­è¨ˆæ®µéšã‹ã‚‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çµ„ã¿è¾¼ã¿
4. **å›½éš›èªè¨¼**: ISO27001ã€SOC2ç­‰ã®å–å¾—æ¤œè¨

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯ä¸€åº¦ã§å®Œç’§ã«ã§ãã‚‹ã‚‚ã®ã§ã¯ãªãã€ç¶™ç¶šçš„ãªæ”¹å–„ãŒé‡è¦ã§ã™ã€‚

## å‚è€ƒãƒªãƒ³ã‚¯

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)
- [CWE Common Weakness Enumeration](https://cwe.mitre.org/)
- [CVSS Calculator](https://www.first.org/cvss/calculator/3.1)
- [Security Headers](https://securityheaders.com/)
- [Mozilla Security Guidelines](https://infosec.mozilla.org/guidelines/web_security)

---

*ã“ã®è¨˜äº‹ã¯å®Ÿéš›ã®å€‹äººé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»çµŒé¨“ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¾ã—ãŸã€‚*

*åˆå¿ƒè€…ã®æ–¹ã¸ï¼šã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯æ®µéšçš„ã«å­¦ç¿’ãƒ»å®Ÿè£…ã—ã¦ã„ãã“ã¨ãŒé‡è¦ã§ã™ã€‚ã¾ãšã¯åŸºæœ¬çš„ãªå¯¾ç­–ã‹ã‚‰å§‹ã‚ã¦ã€å¾ã€…ã«é«˜åº¦ãªå¯¾ç­–ã‚’å–ã‚Šå…¥ã‚Œã¦ã„ãã¾ã—ã‚‡ã†ã€‚*